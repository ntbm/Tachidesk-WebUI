{"version":3,"sources":["context/NavbarContext.tsx","context/DarkTheme.tsx","components/TemporaryDrawer.tsx","components/navbar/NavBar.tsx","util/localStorage.tsx","util/useLocalStorage.tsx","util/language.tsx","util/cloneObject.tsx","components/manga/ExtensionLangSelect.tsx","components/manga/SourceCard.tsx","util/client.tsx","screens/manga/MangaSources.tsx","components/anime/SourceCard.tsx","screens/anime/AnimeSources.tsx","util/ListItemLink.tsx","screens/Settings.tsx","screens/settings/About.tsx","screens/settings/Categories.tsx","screens/settings/Backup.tsx","components/SpinnerImage.tsx","components/manga/MangaCard.tsx","components/manga/MangaGrid.tsx","screens/manga/Library.tsx","screens/manga/SearchSingle.tsx","components/manga/ChapterCard.tsx","components/manga/CategorySelect.tsx","components/manga/MangaDetails.tsx","components/LoadingPlaceholder.tsx","components/Toast.tsx","screens/manga/Manga.tsx","components/anime/EpisodeCard.tsx","components/anime/AnimeDetails.tsx","screens/anime/Anime.tsx","components/manga/ExtensionCard.tsx","screens/manga/MangaExtensions.tsx","screens/manga/SourceMangas.tsx","components/anime/AnimeCard.tsx","components/anime/AnimeGrid.tsx","screens/anime/SourceAnimes.tsx","components/manga/reader/Page.tsx","components/manga/reader/pager/HorizontalPager.tsx","components/manga/reader/PageNumber.tsx","components/manga/reader/pager/PagedPager.tsx","components/manga/reader/DoublePage.tsx","components/manga/reader/pager/DoublePagedPager.tsx","components/manga/reader/pager/VerticalPager.tsx","components/navbar/ReaderNavBar.tsx","screens/manga/Reader.tsx","screens/anime/Player.tsx","components/anime/ExtensionCard.tsx","screens/anime/AnimeExtensions.tsx","screens/manga/DownloadQueue.tsx","App.tsx","index.tsx"],"names":["NavBarContext","React","createContext","title","setTitle","action","setAction","override","status","value","setOverride","DarkTheme","darkTheme","setDarkTheme","useStyles","makeStyles","list","width","TemporaryDrawer","drawerOpen","setDrawerOpen","classes","Drawer","open","anchor","onClose","className","role","onClick","onKeyDown","List","to","style","color","textDecoration","ListItem","button","ListItemIcon","ListItemText","primary","theme","root","flexGrow","menuButton","marginRight","spacing","NavBar","useState","useContext","AppBar","position","Toolbar","IconButton","edge","aria-label","disableRipple","Typography","variant","getItem","key","defaultValue","item","window","localStorage","JSON","parse","setItem","stringify","useLocalStorage","initialState","Function","storage","storedValue","setStoredValue","valueToStore","ISOLanguages","code","name","nativeName","langCodeToName","whereToCut","indexOf","length","proccessedCode","toLocaleLowerCase","substring","result","i","langSortCmp","a","b","aLang","bLang","cloneObject","obj","createStyles","paper","maxHeight","ExtensionLangSelect","props","shownLangs","setShownLangs","allLangs","mShownLangs","setMShownLangs","setOpen","Dialog","maxWidth","DialogTitle","DialogContent","dividers","padding","map","lang","ListItemSecondaryAction","Switch","checked","onChange","e","event","target","clone","splice","handleChange","DialogActions","Button","autoFocus","display","justifyContent","alignItems","bullet","margin","transform","fontSize","pos","marginBottom","icon","height","flex","SourceCard","source","id","iconUrl","supportsLatest","isConfigurable","serverAddress","Card","CardContent","Avatar","alt","src","flexDirection","component","gutterBottom","marginLeft","location","href","inferredPort","hostname","port","protocol","client","axios","create","baseURL","interceptors","request","use","config","data","FormData","Object","assign","headers","sourceToLangList","sources","forEach","push","sort","groupByLang","undefined","MangaSources","NavbarContext","setSources","fetched","setFetched","useEffect","get","then","response","entries","Fragment","AnimeSources","ListItemLink","Settings","setServerAddress","dialogOpen","setDialogOpen","dialogValue","setDialogValue","handleDialogCancel","secondary","DialogContentText","TextField","label","type","fullWidth","loading","About","about","setAbout","CircularProgress","thickness","buildType","version","revision","Date","buildTime","toUTCString","github","discord","Categories","categories","setCategories","categoryToEdit","setCategoryToEdit","dialogName","setDialogName","dialogDefault","setDialogDefault","useTheme","updateTriggerHolder","setUpdateTriggerHolder","triggerUpdate","onDragEnd","destination","from","category","formData","append","post","finally","Array","removed","categoryReorder","index","droppableId","provided","ref","innerRef","draggableId","toString","snapshot","ContainerProps","draggableProps","dragHandleProps","isDragging","draggableStyle","palette","background","default","handleEditDialogOpen","delete","deleteCategory","placeholder","Fab","bottom","right","FormControlLabel","control","Checkbox","patch","Backup","defaults","submitBackup","file","text","fileContent","dropHandler","preventDefault","fromEvent","files","dragOverHandler","document","addEventListener","input","getElementById","evt","removeEventListener","click","SpinnerImage","onImageLoad","imgRef","spinnerClassName","imgClassName","imageSrc","setImagsrc","img","Image","onload","defaultProps","wrapper","gradient","top","opacity","image","spinner","minHeight","MangaCard","forwardRef","manga","thumbnailUrl","Grid","xs","sm","md","lg","CardActionArea","MangaGrid","mapped","mangas","message","hasNextPage","lastPageNum","setLastPageNum","lastManga","useRef","scrollHandler","current","rect","getBoundingClientRect","y","innerHeight","it","idx","container","TabPanel","children","hidden","Library","toRender","tabs","setTabs","tabNum","setTabNum","Promise","all","libraryMangas","categoryTabs","isFetched","order","tab","tabsClone","tabDefines","Tab","tabBodies","scrollableTabs","innerWidth","Tabs","newTab","handleTabChange","indicatorColor","textColor","centered","scrollButtons","SearchSingle","sourceId","useParams","error","setError","setMangas","setMessage","searchTerm","setSearchTerm","setHasNextPage","textInput","createRef","processInput","mangaList","mangaGrid","inputRef","ChapterCard","chapter","triggerChaptersUpdate","downloadingString","dateStr","uploadDate","toISOString","slice","anchorEl","setAnchorEl","handleClose","sendChange","mangaId","readChapterColor","read","dark","bookmarked","chapterNumber","scanlator","currentTarget","keepMounted","Boolean","MenuItem","CategorySelect","categoryInfos","setCategoryInfos","tmpCategoryInfos","selected","categoryId","FormGroup","categoryInfo","getValueOrUnknown","val","MangaDetails","genre","inLibrary","setInLibrary","categoryDialogOpen","setCategoryDialogOpen","breakpoints","up","left","alignSelf","overflowY","leftRight","leftSide","borderRadius","minWidth","rightSide","fontWeight","buttons","paddingLeft","paddingRight","description","marginTop","textAlign","textJustify","flexWrap","border","handleButtonClick","author","artist","toLocaleUpperCase","url","split","g","LoadingPlaceholder","shouldRender","componentProps","createElement","Transition","Slide","direction","Toast","severity","Snackbar","autoHideDuration","TransitionComponent","elevation","makeToast","Math","floor","random","body","appendChild","ReactDOM","render","setTimeout","querySelector","unmountComponentAtNode","removeChild","removeToast","chapters","listStyle","baseWebsocketUrl","replace","initialQueue","queue","Manga","setManga","setChapters","fetchedChapters","setFetchedChapters","noChaptersFound","setNoChaptersFound","chapterUpdateTriggerer","setChapterUpdateTriggerer","setWsClient","setQueueState","wsc","WebSocket","onmessage","shouldUpdate","q","state","close","downloadingStringFor","rtn","downloaded","chapterIndex","progress","freshData","shouldFetchOnline","totalCount","itemContent","useWindowScroll","overscan","EpisodeCard","episode","triggerEpisodesUpdate","animeId","episodeNumber","AnimeDetails","Anime","episodes","setEpisodes","fetchedEpisodes","setFetchedEpisodes","noEpisodesFound","setNoEpisodesFound","episodeUpdateTriggerer","setEpisodeUpdateTriggerer","ExtensionCard","extension","versionName","installed","hasUpdate","obsolete","pkgName","notifyInstall","installedState","setInstalledState","langPress","toUpperCase","uninstall","reload","MangaExtensions","extensionsRaw","setExtensionsRaw","extensions","setExtensions","groupedExtension","apkName","groupExtensions","groupsToShow","SourceMangas","sourceType","popular","AnimeCard","CardMedia","AnimeGrid","SourceAnimes","imageStyle","settings","readerType","objectFit","pointerEvents","Page","setCurPage","loadingImage","backgroundColor","handleVerticalScroll","handleHorizontalScroll","HorizontalPager","pages","curPage","prevChapter","nextChapter","reader","overflowX","userSelect","selfRef","pagesRef","nextPage","scrollIntoView","inline","page","loadNextonEnding","prevPage","mouseXPos","dragScreen","scrollBy","pageX","dragControl","removeDragControl","clickControl","clientX","handleLoadNextonEnding","scrollX","scrollWidth","PageNumber","pageCount","pageNumber","showPageNumber","staticNav","PagedReader","goLeft","goRight","keyboardControl","DoublePage","image1src","image2src","DoublePagedPager","preload","pagesDisplayed","pageLoaded","fill","nextCurPage","imgElem","pagesToGoBack","retryDisplay","setInterval","setPagesToDisplay","clearInterval","onLoad","VerticalReader","scrollY","offsetHeight","initialPage","lastPageRead","defaultReaderSettings","continuesPageGap","ReaderNavBar","history","useHistory","setSettings","hideOpenButton","setHideOpenButton","prevScrollPos","setPrevScrollPos","settingsCollapseOpen","setSettingsCollapseOpen","AppMainContainer","AppRootElment","transition","flexShrink","navigation","gridTemplateColumns","gridTemplateAreas","gridColumnGap","textTransform","navigationChapters","settingsCollapsseHeader","openDrawerButton","setSettingValue","handleScroll","currentScrollPos","pageYOffset","abs","rootEl","mainContainer","classList","add","remove","in","timeout","appear","mountOnEnter","unmountOnExit","ContainerComponent","disableFocusRipple","Collapse","Select","gridArea","startIcon","chapterCount","endIcon","Zoom","Fade","initialChapter","Reader","setChapter","settingsClone","defualtSettings","shouldUpdateSettings","keys","keyOf","formDataRead","n","ReaderComponent","VerticalPager","PagedPager","getReaderComponent","video","initialEpisode","linkUrl","episodeCount","Player","episodeIndex","setEpisode","episodeLink","setEpisodeLink","controls","AnimeExtensions","DownloadQueue","queueState","toggleQueueStatus","App","navBarContext","darkThemeContext","useMemo","createMuiTheme","overrides","MuiCssBaseline","ThemeProvider","Provider","CssBaseline","Container","disableGutters","paddingTop","exact","path","match","params","StrictMode"],"mappings":"sSA2BeA,EATOC,IAAMC,cAA2B,CACnDC,MAAO,YACPC,SAAU,aACVC,OAAQ,wBACRC,UAAW,aACXC,SAAU,CAAEC,QAAQ,EAAOC,MAAO,yBAClCC,YAAa,eCLFC,EALGV,IAAMC,cAA2B,CAC/CU,WAAW,EACXC,aAAc,e,uICKZC,EAAYC,YAAW,CACzBC,KAAM,CACFC,MAAO,OAUA,SAASC,EAAT,GAAiE,IAAtCC,EAAqC,EAArCA,WAAYC,EAAyB,EAAzBA,cAC5CC,EAAUP,IAEhB,OACI,8BACI,cAACQ,EAAA,EAAD,CACIC,KAAMJ,EACNK,OAAO,OACPC,QAAS,kBAAML,GAAc,IAHjC,SAKI,qBACIM,UAAWL,EAAQL,KACnBW,KAAK,eACLC,QAAS,kBAAMR,GAAc,IAC7BS,UAAW,kBAAMT,GAAc,IAJnC,SAMI,eAACU,EAAA,EAAD,WACI,cAAC,IAAD,CAAMC,GAAG,WAAWC,MAAO,CAAEC,MAAO,UAAWC,eAAgB,QAA/D,SACI,eAACC,EAAA,EAAD,CAAUC,QAAM,EAAhB,UACI,cAACC,EAAA,EAAD,UACI,cAAC,IAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,cAJL,aAOzB,cAAC,IAAD,CAAMR,GAAG,oBAAoBC,MAAO,CAAEC,MAAO,UAAWC,eAAgB,QAAxE,SACI,eAACC,EAAA,EAAD,CAAUC,QAAM,EAAhB,UACI,cAACC,EAAA,EAAD,UACI,cAAC,IAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,iBAJL,gBAgBzB,cAAC,IAAD,CAAMR,GAAG,iBAAiBC,MAAO,CAAEC,MAAO,UAAWC,eAAgB,QAArE,SACI,eAACC,EAAA,EAAD,CAAUC,QAAM,EAAhB,UACI,cAACC,EAAA,EAAD,UACI,cAAC,IAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,cAJL,aAgBzB,cAAC,IAAD,CAAMR,GAAG,mBAAmBC,MAAO,CAAEC,MAAO,UAAWC,eAAgB,QAAvE,SACI,eAACC,EAAA,EAAD,CAAUC,QAAM,EAAhB,UACI,cAACC,EAAA,EAAD,UACI,cAAC,IAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,iBAJL,0BAOzB,cAAC,IAAD,CAAMR,GAAG,YAAYC,MAAO,CAAEC,MAAO,UAAWC,eAAgB,QAAhE,SACI,eAACC,EAAA,EAAD,CAAUC,QAAM,EAAhB,UACI,cAACC,EAAA,EAAD,UACI,cAAC,IAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,eAJL,uBCnFjD,IAAMzB,EAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFC,SAAU,GAEdC,WAAY,CACRC,YAAaJ,EAAMK,QAAQ,IAE/B1C,MAAO,CACHuC,SAAU,OAIH,SAASI,IACpB,IAAMzB,EAAUP,IAChB,EAAoCiC,oBAAS,GAA7C,mBAAO5B,EAAP,KAAmBC,EAAnB,KACA,EAAoC4B,qBAAWhD,GAAvCG,EAAR,EAAQA,MAAOE,EAAf,EAAeA,OAAQE,EAAvB,EAAuBA,SAEfK,EAAcoC,qBAAWrC,GAAzBC,UAER,OACI,qCACKL,EAASC,QAAUD,EAASE,OAC3BF,EAASC,QAEX,sBAAKkB,UAAWL,EAAQoB,KAAxB,UACI,cAACQ,EAAA,EAAD,CAAQC,SAAS,QAAQjB,MAAOrB,EAAY,UAAY,UAAxD,SACI,eAACuC,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CACIC,KAAK,QACL3B,UAAWL,EAAQsB,WACnBV,MAAM,UACNqB,aAAW,OACXC,eAAa,EACb3B,QAAS,kBAAMR,GAAc,IANjC,SAQI,cAAC,IAAD,MAEJ,cAACoC,EAAA,EAAD,CAAYC,QAAQ,KAAK/B,UAAWL,EAAQlB,MAA5C,SACKA,IAEJE,OAGT,cAACa,EAAD,CAAiBC,WAAYA,EAAYC,cAAeA,UC/BzD,OAAEsC,QAvBjB,SAAoBC,EAAaC,GAC7B,IACI,IAAMC,EAAOC,OAAOC,aAAaL,QAAQC,GAEzC,GAAa,OAATE,EACA,OAAOG,KAAKC,MAAMJ,GAGtBC,OAAOC,aAAaG,QAAQP,EAAKK,KAAKG,UAAUP,IAPpD,SAWA,OAAOA,GAWeM,QAR1B,SAAoBP,EAAalD,GAC7B,IACIqD,OAAOC,aAAaG,QAAQP,EAAKK,KAAKG,UAAU1D,IADpD,YCZW,SAAS2D,EAAmBT,EAAaC,GACpD,IAAMS,EAAeT,aAAwBU,SAAWV,IAAiBA,EACzE,EAAsCb,mBAAYwB,EAAQb,QAAQC,EAAKU,IAAvE,mBAAOG,EAAP,KAAoBC,EAApB,KASA,MAAO,CAACD,EAPU,SAAC/D,GAEf,IAAMiE,EAAejE,aAAiB6D,SAAW7D,EAAM+D,GAAe/D,EACtEgE,EAAeC,GACfH,EAAQL,QAAQP,EAAKe,K,uGCZhBC,GAAe,CACxB,CAAEC,KAAM,MAAOC,KAAM,MAAOC,WAAY,OACxC,CAAEF,KAAM,YAAaC,KAAM,YAAaC,WAAY,aACpD,CAAEF,KAAM,kBAAmBC,KAAM,kBAAmBC,WAAY,mBAGhE,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,WAC3C,CAAEF,KAAM,KAAMC,KAAM,qBAAsBC,WAAY,aACtD,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,WAC1C,CAAEF,KAAM,KAAMC,KAAM,qBAAsBC,WAAY,cACtD,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,eAC1C,CAAEF,KAAM,KAAMC,KAAM,aAAcC,WAAY,aAC9C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,YAC3C,CAAEF,KAAM,KAAMC,KAAM,aAAcC,WAAY,gBAC9C,CAAEF,KAAM,KAAMC,KAAM,aAAcC,WAAY,wBAC9C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,gBAC3C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,8CAC3C,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,8CAC1C,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,wCACzC,CAAEF,KAAM,KAAMC,KAAM,OAAQC,WAAY,sBACxC,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,gBAC3C,CAAEF,KAAM,KAAMC,KAAM,WAAYC,WAAY,sBAC5C,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,sBAC1C,CAAEF,KAAM,KAAMC,KAAM,OAAQC,WAAY,WACxC,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,YACzC,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,gEAC7C,CAAEF,KAAM,KAAMC,KAAM,WAAYC,WAAY,kBAC5C,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,0DAC7C,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,qBACzC,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,UAC1C,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,SAC7C,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,cACzC,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,kCAC3C,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,YACzC,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,wCAC7C,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,wCAC7C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,YAC3C,CAAEF,KAAM,KAAMC,KAAM,YAAaC,WAAY,UAC7C,CAAEF,KAAM,KAAMC,KAAM,WAAYC,WAAY,YAC5C,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,kCAC1C,CAAEF,KAAM,MAAOC,KAAM,WAAYC,WAAY,YAC7C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,SAC3C,CAAEF,KAAM,KAAMC,KAAM,UAAWC,WAAY,kCAC3C,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,WAC1C,CAAEF,KAAM,KAAMC,KAAM,QAASC,WAAY,oDACzC,CAAEF,KAAM,KAAMC,KAAM,SAAUC,WAAY,UAGvC,SAASC,GAAeH,GAM3B,IALA,IAAMI,GAAoC,IAAvBJ,EAAKK,QAAQ,KAAcL,EAAKK,QAAQ,KAAOL,EAAKM,OAEjEC,EAAiBP,EAAKQ,oBAAoBC,UAAU,EAAGL,GACzDM,EAAS,QAEJC,EAAI,EAAGA,EAAIZ,GAAaO,OAAQK,IACjCZ,GAAaY,GAAGX,OAASO,IAAgBG,EAASX,GAAaY,GAAGT,YAO1E,OAJ2B,IAAvBF,EAAKK,QAAQ,OACbK,EAAM,UAAMA,EAAN,aAAiBV,EAAKS,UAAUL,EAAa,GAA7C,MAGHM,EAUJ,IAAME,GAAc,SAACC,EAAWC,GAEnC,IAAMC,EAAQZ,GAAeU,GACvBG,EAAQb,GAAeW,GAE7B,MAAU,OAAND,GAAoB,EACd,OAANC,GACGC,EAAQC,EADQ,GACK,GC/EjB,SAASC,GAA8BC,GAClD,OAAO9B,KAAKC,MAAMD,KAAKG,UAAU2B,ICcrC,IAAMhF,GAAYC,aAAW,kBAAMgF,YAAa,CAC5CC,MAAO,CACHC,UAAW,IACXhF,MAAO,YAUA,SAASiF,GAAoBC,GACxC,IAAQC,EAAwCD,EAAxCC,WAAYC,EAA4BF,EAA5BE,cAAeC,EAAaH,EAAbG,SAEnC,EAAsCvD,mBAASqD,GAA/C,mBAAOG,EAAP,KAAoBC,EAApB,KACMnF,EAAUP,KAChB,EAAwBiC,oBAAkB,GAA1C,mBAAOxB,EAAP,KAAakF,EAAb,KAuBA,OACI,qCACI,cAACrD,EAAA,EAAD,CACIxB,QAAS,kBAAM6E,GAAQ,IACvBnD,aAAW,uBACXD,KAAK,MACLpB,MAAM,UAJV,SAMI,cAAC,KAAD,MAEJ,eAACyE,EAAA,EAAD,CACIrF,QAASA,EACTsF,SAAS,KACTpF,KAAMA,EAHV,UAKI,cAACqF,EAAA,EAAD,gCACA,cAACC,EAAA,EAAD,CAAeC,UAAQ,EAAC9E,MAAO,CAAE+E,QAAS,GAA1C,SACI,cAACjF,EAAA,EAAD,UACKwE,EAASU,KAAI,SAACC,GAAD,OACV,eAAC9E,EAAA,EAAD,WACI,cAACG,EAAA,EAAD,CAAcC,QAASwC,GAAekC,KAEtC,cAACC,GAAA,EAAD,UACI,cAACC,EAAA,EAAD,CACIC,SAAwC,IAA/Bb,EAAYtB,QAAQgC,GAC7BI,SAAU,SAACC,GAAD,OArCzB,SAACC,EAA4CN,GAG9D,GAFoBM,EAAMC,OAAlBJ,QAGJZ,EAAe,GAAD,mBAAKD,GAAL,CAAkBU,SAC7B,CACH,IAAMQ,EAAQ5B,GAAYU,GAC1BkB,EAAMC,OAAOD,EAAMxC,QAAQgC,GAAO,GAClCT,EAAeiB,IA6B8BE,CAAaL,EAAGL,UAN9BA,UAe3B,eAACW,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CAAQC,WAAS,EAAClG,QAxDb,WACjB6E,GAAQ,IAuD6CxE,MAAM,UAA/C,oBAGA,cAAC4F,EAAA,EAAD,CAAQjG,QAvDP,WACb6E,GAAQ,GACRJ,EAAcE,IAqDyBtE,MAAM,UAAjC,yB,kCCpFdnB,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QAQN,SAAS+F,GAAWxC,GAC/B,MAIIA,EAHAyC,OACIC,EAFR,EAEQA,GAAIhE,EAFZ,EAEYA,KAAMoC,EAFlB,EAEkBA,KAAM6B,EAFxB,EAEwBA,QAASC,EAFjC,EAEiCA,eAAgBC,EAFjD,EAEiDA,eAIjD,EAAwB5E,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAAUP,KAEhB,OACI,cAACoI,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,sBAAKT,MAAO,CAAE+F,QAAS,QAAvB,UACI,cAACqB,GAAA,EAAD,CACI3F,QAAQ,UACR/B,UAAWL,EAAQmH,KACnBa,IAAKxE,EACLyE,IAAKL,EAAgBH,IAEzB,sBAAK9G,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,cAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,SACK3E,IAEL,cAACrB,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,SACK1E,GAAekC,WAI5B,sBAAKjF,MAAO,CAAE+F,QAAS,QAAvB,UACKiB,GAAkB,cAACnB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,mBAAmCf,EAAnC,aAAvE,uBACnB,cAAChB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,mBAAmCf,EAAnC,aAAvE,oBACCE,GAAkB,cAAClB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,mBAAmCf,EAAnC,aAAvE,oBACnB,cAAChB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,mBAAmCf,EAAnC,cAAvE,4B,ICpEhBgB,G,qBAHJ,GAAqC/F,OAAO6F,SAApCG,GAAR,GAAQA,SAAUC,GAAlB,GAAkBA,KAAMC,GAAxB,GAAwBA,SAIDH,GAAV,SAATE,GAAkC,OAAgCA,GAEtE,IAAME,GAASC,KAAMC,OAAO,CAExBC,QAAS7F,EAAQb,QAAQ,gBAAhB,UAAoCsG,GAApC,aAAiDF,GAAjD,YAA6DD,OAG1EI,GAAOI,aAAaC,QAAQC,KAAI,SAACC,GAI7B,OAHIA,EAAOC,gBAAgBC,UACvBC,OAAOC,OAAOJ,EAAOK,QAAS,CAAE,eAAgB,wBAE7CL,KAGIP,UCbf,SAASa,GAAiBC,GACtB,IAAMzF,EAAmB,GAOzB,OALAyF,EAAQC,SAAQ,SAACpC,IACwB,IAAjCtD,EAAOL,QAAQ2D,EAAO3B,OAAgB3B,EAAO2F,KAAKrC,EAAO3B,SAGjE3B,EAAO4F,KAAK1F,IACLF,EAGX,SAAS6F,GAAYJ,GACjB,IAAMzF,EAAS,GAMf,OALAyF,EAAQC,SAAQ,SAACpC,QACewC,IAAxB9F,EAAOsD,EAAO3B,QAAuB3B,EAAOsD,EAAO3B,MAAQ,IAC/D3B,EAAOsD,EAAO3B,MAAMgE,KAAKrC,MAGtBtD,EAGI,SAAS+F,KACpB,MAAgCrI,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAElB,EAAoC8D,EAA0B,mBLkCvD,CAEH,OKpCJ,mBAAOgC,EAAP,KAAmBC,EAAnB,KAEA,EAA8BtD,mBAAoB,IAAlD,mBAAOgI,EAAP,KAAgBQ,EAAhB,KACA,EAA8BxI,oBAAkB,GAAhD,mBAAOyI,EAAP,KAAgBC,EAAhB,KAmBA,OAjBAC,qBAAU,WACNtL,EAAS,WACTE,EACI,cAAC4F,GAAD,CACIE,WAAYA,EACZC,cAAeA,EACfC,SAAUwE,GAAiBC,QAGpC,CAAC3E,EAAY2E,IAEhBW,qBAAU,WACNzB,GAAO0B,IAAI,uBACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAWc,EAAWd,GAAOgB,GAAW,QACpD,IAEoB,IAAnBV,EAAQ7F,OACJsG,EAAiB,kFACb,4CAGR,mCAEKb,OAAOmB,QAAQX,GAAYJ,IAAUG,MAAK,SAACzF,EAAGC,GAAJ,OAAUF,GAAYC,EAAE,GAAIC,EAAE,OAAKsB,KAAI,mCAAEC,EAAF,KAAQjG,EAAR,YAChD,IAA9BoF,EAAWnB,QAAQgC,IACf,eAAC,IAAM8E,SAAP,WACI,oBAAe/J,MAAO,CAAE0H,WAAY,IAApC,SAA2C3E,GAAekC,IAAjDA,GACPjG,EAAmBgG,KAAI,SAAC4B,GAAD,OACrB,cAACD,GAAD,CAEIC,OAAQA,GADHA,EAAOC,SAJH5B,QCrDzC,IAAMnG,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QAQN,SAAS+F,GAAWxC,GAC/B,MAIIA,EAHAyC,OACIC,EAFR,EAEQA,GAAIhE,EAFZ,EAEYA,KAAMoC,EAFlB,EAEkBA,KAAM6B,EAFxB,EAEwBA,QAASC,EAFjC,EAEiCA,eAIjC,EAAwB3E,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAAUP,KAEhB,OACI,cAACoI,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,sBAAKT,MAAO,CAAE+F,QAAS,QAAvB,UACI,cAACqB,GAAA,EAAD,CACI3F,QAAQ,UACR/B,UAAWL,EAAQmH,KACnBa,IAAKxE,EACLyE,IAAKL,EAAgBH,IAEzB,sBAAK9G,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,cAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,SACK3E,IAEL,cAACrB,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,SACK1E,GAAekC,WAI5B,sBAAKjF,MAAO,CAAE+F,QAAS,QAAvB,UACI,cAACF,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,yBAAyCf,EAAzC,aAAvE,oBACCE,GAAkB,cAAClB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,yBAAyCf,EAAzC,aAAvE,oBACnB,cAAChB,EAAA,EAAD,CAAQpE,QAAQ,WAAWzB,MAAO,CAAE0H,WAAY,IAAM9H,QAAS,WAAQkC,OAAO6F,SAASC,KAAhB,yBAAyCf,EAAzC,cAAvE,4BCjEpB,SAASiC,GAAiBC,GACtB,IAAMzF,EAAmB,GAOzB,OALAyF,EAAQC,SAAQ,SAACpC,IACwB,IAAjCtD,EAAOL,QAAQ2D,EAAO3B,OAAgB3B,EAAO2F,KAAKrC,EAAO3B,SAGjE3B,EAAO4F,KAAK1F,IACLF,EAGX,SAAS6F,GAAYJ,GACjB,IAAMzF,EAAS,GAMf,OALAyF,EAAQC,SAAQ,SAACpC,QACewC,IAAxB9F,EAAOsD,EAAO3B,QAAuB3B,EAAOsD,EAAO3B,MAAQ,IAC/D3B,EAAOsD,EAAO3B,MAAMgE,KAAKrC,MAGtBtD,EAGI,SAAS0G,KACpB,MAAgChJ,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAElB,EAAoC8D,EAA0B,mBPkCvD,CAEH,OOpCJ,mBAAOgC,EAAP,KAAmBC,EAAnB,KAEA,EAA8BtD,mBAAoB,IAAlD,mBAAOgI,EAAP,KAAgBQ,EAAhB,KACA,EAA8BxI,oBAAkB,GAAhD,mBAAOyI,EAAP,KAAgBC,EAAhB,KAmBA,OAjBAC,qBAAU,WACNtL,EAAS,WACTE,EACI,cAAC4F,GAAD,CACIE,WAAYA,EACZC,cAAeA,EACfC,SAAUwE,GAAiBC,QAGpC,CAAC3E,EAAY2E,IAEhBW,qBAAU,WACNzB,GAAO0B,IAAI,6BACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAWc,EAAWd,GAAOgB,GAAW,QACpD,IAEoB,IAAnBV,EAAQ7F,OACJsG,EAAiB,kFACb,4CAGR,mCAEKb,OAAOmB,QAAQX,GAAYJ,IAAUG,MAAK,SAACzF,EAAGC,GAAJ,OAAUF,GAAYC,EAAE,GAAIC,EAAE,OAAKsB,KAAI,mCAAEC,EAAF,KAAQjG,EAAR,YAChD,IAA9BoF,EAAWnB,QAAQgC,IACf,eAAC,IAAM8E,SAAP,WACI,oBAAe/J,MAAO,CAAE0H,WAAY,IAApC,SAA2C3E,GAAekC,IAAjDA,GACPjG,EAAmBgG,KAAI,SAAC4B,GAAD,OACrB,cAAC,GAAD,CAEIA,OAAQA,GADHA,EAAOC,SAJH5B,Q,8JC5D1B,SAASgF,GAAa9F,GAEjC,OAAO,cAAChE,EAAA,EAAD,cAAUC,QAAM,EAACoH,UAAU,KAAQrD,ICoB/B,SAAS+F,KACpB,MAAgClJ,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,YAAaE,EAAU,gCAAW,IAE7D,MAAoC0C,qBAAWrC,GAAvCC,EAAR,EAAQA,UAAWC,EAAnB,EAAmBA,aACnB,EAA0CuD,EAAwB,gBAAiB,IAAnF,mBAAO6E,EAAP,KAAsBkD,EAAtB,KACA,EAAoCpJ,oBAAS,GAA7C,mBAAOqJ,EAAP,KAAmBC,EAAnB,KACA,EAAsCtJ,mBAASkG,GAA/C,mBAAOqD,EAAP,KAAoBC,EAApB,KAOMC,EAAqB,WACvBH,GAAc,IAQlB,OACI,qCACI,eAACvK,EAAA,EAAD,CAAME,MAAO,CAAE+E,QAAS,GAAxB,UACI,eAACkF,GAAD,CAAcrC,KAAK,uBAAnB,UACI,cAACvH,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,kBAE1B,eAAC0J,GAAD,CAAcrC,KAAK,mBAAnB,UACI,cAACvH,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,cAE1B,eAACJ,EAAA,EAAD,WACI,cAACE,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,eACtB,cAAC2E,GAAA,EAAD,UACI,cAACC,EAAA,EAAD,CACI9D,KAAK,MACL+D,QAASxG,EACTyG,SAAU,kBAAMxG,GAAcD,WAI1C,eAACuB,EAAA,EAAD,WACI,cAACE,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,iBAAiBkK,UAAWxD,IAClD,cAAC/B,GAAA,EAAD,UACI,cAAC9D,EAAA,EAAD,CACIxB,QAAS,WAhD7B2K,EAAetD,GACfoD,GAAc,IA8CE,SAKI,cAAC,KAAD,WAIZ,eAACJ,GAAD,CAAcrC,KAAK,kBAAnB,UACI,cAACvH,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CAAcC,QAAQ,gBAI9B,eAACmE,EAAA,EAAD,CAAQnF,KAAM6K,EAAY3K,QAAS+K,EAAnC,UACI,eAAC3F,EAAA,EAAD,WACI,cAAC6F,GAAA,EAAD,uCAGA,cAACC,GAAA,EAAD,CACI7E,WAAS,EACTK,OAAO,QACPU,GAAG,OACH+D,MAAM,gBACNC,KAAK,OACLC,WAAS,EACTrM,MAAO6L,EACPjF,SAAU,SAACC,GAAD,OAAOiF,EAAejF,EAAEE,OAAO/G,aAGjD,eAACmH,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CAAQjG,QAAS4K,EAAoBvK,MAAM,UAA3C,oBAGA,cAAC4F,EAAA,EAAD,CAAQjG,QA5EG,WACvByK,GAAc,GACdF,EAAiBG,IA0EgCrK,MAAM,UAA3C,0B,cCrHdnB,GAAYC,YAAW,CACzBgM,QAAS,CACL9L,MAAO,QACP,QAAS,CACLkH,OAAQ,YACRJ,QAAS,YAKN,SAASiF,KACpB,MAAgChK,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UACZe,EAAUP,KAEhB,EAA0BiC,qBAA1B,mBAAOkK,EAAP,KAAcC,EAAd,KAYA,GAVAxB,qBAAU,WAAQtL,EAAS,SAAUE,EAAU,gCAAW,IAE1DoL,qBAAU,WACNzB,GAAO0B,IAAI,iBACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHyC,EAASzC,QAElB,SAEWW,IAAV6B,EACA,OACI,qBAAKvL,UAAWL,EAAQ0L,QAAxB,SACI,cAACI,GAAA,EAAD,CAAkBC,UAAW,MAYzC,OACI,eAACtL,EAAA,EAAD,WACI,cAACK,EAAA,EAAD,UACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,SAASkK,UAAS,UAAKQ,EAAMpI,KAAX,YAAmBoI,EAAMI,eAErE,cAAClL,EAAA,EAAD,UACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,iBAAiBkK,UAZvB,WAApBQ,EAAMI,UAA8B,GAAN,OAAUJ,EAAMK,SAC5C,GAAN,OAAUL,EAAMK,QAAhB,YAA2BL,EAAMM,cAa7B,cAACpL,EAAA,EAAD,UACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,aAAakK,UAXvB,IAAIe,KAAuB,IAAlBP,EAAMQ,WAAkBC,kBAajD,cAACzB,GAAD,CAAcrC,KAAMqD,EAAMU,OAA1B,SACI,cAACrL,EAAA,EAAD,CAAcC,QAAQ,SAASkK,UAAWQ,EAAMU,WAEpD,cAAC1B,GAAD,CAAcrC,KAAMqD,EAAMW,QAA1B,SACI,cAACtL,EAAA,EAAD,CAAcC,QAAQ,UAAUkK,UAAWQ,EAAMW,e,kHChBlD,SAASC,KACpB,MAAgC7K,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,cAAeE,EAAU,gCAAW,IAE/D,MAAoCyC,mBAAsB,IAA1D,mBAAO+K,EAAP,KAAmBC,EAAnB,KACA,EAA4ChL,oBAAkB,GAA9D,mBAAOiL,EAAP,KAAuBC,EAAvB,KACA,EAAoClL,oBAAkB,GAAtD,mBAAOqJ,EAAP,KAAmBC,EAAnB,KACA,EAAoCtJ,mBAAiB,IAArD,mBAAOmL,EAAP,KAAmBC,EAAnB,KACA,EAA0CpL,oBAAkB,GAA5D,mBAAOqL,EAAP,KAAsBC,EAAtB,KACM7L,EAAQ8L,eAEd,EAAsDvL,mBAAiB,GAAvE,mBAAOwL,EAAP,KAA4BC,EAA5B,KACMC,EAAgB,kBAAMD,EAAuBD,EAAsB,IAEzE7C,qBAAU,WACDU,GACDnC,GAAO0B,IAAI,qBACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAAUsD,EAActD,QAEvC,CAAC8D,IAEJ,IA+CM/B,EAAqB,WACvBH,GAAc,IA0BlB,OACI,qCACI,cAAC,KAAD,CAAiBqC,UA5DP,SAACpJ,GAEVA,EAAOqJ,aAIZZ,EAtBoB,SAAC/M,EAAmB4N,EAAc7M,GACtD,IAAM8M,EAAW7N,EAAK4N,GAEhBE,EAAW,IAAIpE,SACrBoE,EAASC,OAAO,OAAhB,UAA2BH,EAAO,IAClCE,EAASC,OAAO,KAAhB,UAAyBhN,EAAK,IAC9BkI,GAAO+E,KAAP,2BAAgCH,EAAShG,GAAzC,YAAuDiG,GAClDG,SAAQ,kBAAMR,OAGnB,IAAMnJ,EAAS4J,MAAMN,KAAK5N,GAC1B,EAAkBsE,EAAOoC,OAAOkH,EAAM,GAA/BO,EAAP,oBAEA,OADA7J,EAAOoC,OAAO3F,EAAI,EAAGoN,GACd7J,EASO8J,CACVtB,EACAxI,EAAOsD,OAAOyG,MACd/J,EAAOqJ,YAAYU,SAmDnB,SACI,cAAC,KAAD,CAAWC,YAAY,YAAvB,SACK,SAACC,GAAD,OACG,eAACzN,EAAA,EAAD,CAAM0N,IAAKD,EAASE,SAApB,UACK3B,EAAW9G,KAAI,SAACnD,EAAMwL,GAAP,OACZ,cAAC,KAAD,CAEIK,YAAa7L,EAAKgF,GAAG8G,WACrBN,MAAOA,EAHX,SAKK,SAACE,EAAUK,GAAX,OACG,eAACzN,EAAA,EAAD,wCACI0N,eAAgB,CAAEL,IAAKD,EAASE,WAC5BF,EAASO,gBACTP,EAASQ,iBAHjB,IAII/N,OA3HtBgO,EA4H0BJ,EAASI,WA3HrDC,EA4H4CV,EAASO,eAAe9N,MA5HNkO,EA6HlB1N,EAAM0N,QA9HjC,aAAC,gBAGfD,GAECD,GAAc,CACdG,WAA6B,SAAjBD,EAAQrD,KAAkB,UAAY,sBA0Hd2C,IAAKD,EAASE,SATlB,UAWI,cAACpN,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CACIC,QAASsB,EAAKgB,OAElB,cAACzB,EAAA,EAAD,CACIxB,QAAS,YAjExB,SAACyN,GAC1BlB,EAAcL,EAAWuB,GAAOxK,MAChCwJ,EAAiBP,EAAWuB,GAAOe,SACnCnC,EAAkBoB,GAClBhD,GAAc,GA8D8BgE,CAAqBhB,IAF7B,SAKI,cAAC,KAAD,MAEJ,cAACjM,EAAA,EAAD,CACIxB,QAAS,YA5C9B,SAACyN,GACpB,IAAMR,EAAWf,EAAWuB,GAC5BpF,GAAOqG,OAAP,2BAAkCzB,EAAShG,KACtCoG,SAAQ,kBAAMR,OA0CyB8B,CAAelB,IAFvB,SAKI,cAAC,KAAD,UApJ3B,IAACW,EAClBC,EAA8DC,IAiHzBrM,EAAKgF,OAwCjB0G,EAASiB,oBAK1B,cAACC,GAAA,EAAD,CACIxO,MAAM,UACNqB,aAAW,MACXtB,MAAO,CACHkB,SAAU,WACVwN,OAAQlO,EAAMK,QAAQ,GACtB8N,MAAOnO,EAAMK,QAAQ,IAEzBjB,QApGa,WALrBuM,EAAc,IACdE,GAAiB,GACjBJ,GAAmB,GAKnB5B,GAAc,IA0FV,SAUI,cAAC,KAAD,MAEJ,eAAC3F,EAAA,EAAD,CAAQnF,KAAM6K,EAAY3K,QAAS+K,EAAnC,UACI,cAAC5F,EAAA,EAAD,CAAaiC,GAAG,oBAAhB,UACyB,IAApBmF,EAAwB,cAAgB,iBAE7C,eAACnH,EAAA,EAAD,WACI,cAAC8F,GAAA,EAAD,CACI7E,WAAS,EACTK,OAAO,QACPU,GAAG,OACH+D,MAAM,gBACNC,KAAK,OACLC,WAAS,EACTrM,MAAOyN,EACP7G,SAAU,SAACC,GAAD,OAAO6G,EAAc7G,EAAEE,OAAO/G,UAE5C,cAACmQ,GAAA,EAAD,CACIC,QACI,cAACC,GAAA,EAAD,CACI1J,QAASgH,EACT/G,SAAU,SAACC,GAAD,OAAO+G,EAAiB/G,EAAEE,OAAOJ,UAC3CnF,MAAM,YAGd2K,MAAM,yDAGd,eAAChF,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CAAQjG,QAAS4K,EAAoBvK,MAAM,UAA3C,oBAGA,cAAC4F,EAAA,EAAD,CAAQjG,QAtHG,WACvByK,GAAc,GAEd,IAAMyC,EAAW,IAAIpE,SAIrB,GAHAoE,EAASC,OAAO,OAAQb,GACxBY,EAASC,OAAO,UAAWX,EAAcuB,aAEjB,IAApB3B,EACA/D,GAAO+E,KAAK,oBAAqBF,GAC5BG,SAAQ,kBAAMR,WAChB,CACH,IAAMI,EAAWf,EAAWE,GAC5B/D,GAAO8G,MAAP,2BAAiClC,EAAShG,IAAMiG,GAC3CG,SAAQ,kBAAMR,SAyG0BxM,MAAM,UAA3C,6B,iEC9NL,SAAS+O,KACpB,MAAgChO,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,UAAWE,EAAU,gCAAW,IAE3D,IAAQ8J,EAAYH,GAAOgH,SAAnB7G,QAEF8G,EAAe,SAACC,GAClBA,EAAKC,OACAxF,MACG,SAACyF,GACGpH,GAAO+E,KAAK,+BACRqC,EAAa,CAAExG,QAAS,CAAE,eAAgB,0BAKxDyG,EAAW,yCAAG,WAAOhK,GAAP,gBAAA7B,EAAA,6DAChB6B,EAAEiK,iBADc,SAEIC,aAAUlK,GAFd,OAEVmK,EAFU,OAIhBP,EAAaO,EAAM,IAJH,2CAAH,sDAOXC,EAAkB,SAACpK,GACrBA,EAAEiK,kBAmBN,OAhBA7F,qBAAU,WACNiG,SAASC,iBAAiB,OAAQN,GAClCK,SAASC,iBAAiB,WAAYF,GAEtC,IAAMG,EAAQF,SAASG,eAAe,eAMtC,OALK,OAALD,QAAK,IAALA,KAAOD,iBAAiB,SAAxB,yCAAkC,WAAOG,GAAP,gBAAAtM,EAAA,sEACV+L,aAAUO,GADA,OACxBN,EADwB,OAE9BP,EAAaO,EAAM,IAFW,2CAAlC,uDAKO,WACHE,SAASK,oBAAoB,OAAQV,GACrCK,SAASK,oBAAoB,WAAYN,MAE9C,IAGC,eAAC5P,EAAA,EAAD,CAAME,MAAO,CAAE+E,QAAS,GAAxB,UACI,eAACkF,GAAD,CAAcrC,KAAI,UAAKQ,EAAL,qCAAlB,UACI,cAAC/H,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CACIC,QAAQ,uBACRkK,UAAU,mDAGlB,eAACtK,EAAA,EAAD,CAAUC,QAAM,EAACR,QAAS,kCAAM+P,SAASG,eAAe,sBAA9B,aAAM,EAAwCG,SAAxE,UACI,cAAC5P,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CACIC,QAAQ,wBACRkK,UAAU,0DAEd,uBACII,KAAK,OACLhI,KAAK,cACLgE,GAAG,cACH7G,MAAO,CAAE+F,QAAS,gB,4CC9DvB,SAASmK,GAAa/L,GACjC,IACImD,EACAnD,EADAmD,IAAKD,EACLlD,EADKkD,IAAK8I,EACVhM,EADUgM,YAAaC,EACvBjM,EADuBiM,OAAQC,EAC/BlM,EAD+BkM,iBAAkBC,EACjDnM,EADiDmM,aAErD,EAA+BvP,mBAAiB,IAAhD,mBAAOwP,EAAP,KAAiBC,EAAjB,KAgBA,OAdA9G,qBAAU,WACN,IAAM+G,EAAM,IAAIC,MAQhB,OAPAD,EAAInJ,IAAMA,EAEVmJ,EAAIE,OAAS,WACTH,EAAWlJ,GACA,OAAX6I,QAAW,IAAXA,QAGG,WACHM,EAAIE,OAAS,QAElB,CAACrJ,IAEoB,IAApBiJ,EAASrN,OAGL,aADA,CACA,OAAKxD,UAAW2Q,EAAhB,SACI,cAAClF,GAAA,EAAD,CAAkBC,UAAW,MAMrC,qBACI1L,UAAW4Q,EACX9C,IAAK4C,EACL9I,IAAKiJ,EACLlJ,IAAKA,IAKjB6I,GAAaU,aAAe,CACxBP,iBAAkB,GAClBC,aAAc,GACdH,YAAa,aACbC,YAAQhH,GChDZ,IAAMtK,GAAYC,YAAW,CACzB0B,KAAM,CACFgG,OAAQ,OACRxH,MAAO,OACP8G,QAAS,QAEb8K,QAAS,CACL3P,SAAU,WACVuF,OAAQ,QAEZqK,SAAU,CACN5P,SAAU,WACV6P,IAAK,EACL9R,MAAO,OACPwH,OAAQ,OACR0H,WAAY,mDACZ6C,QAAS,IAEb7S,MAAO,CACH+C,SAAU,WACVwN,OAAQ,EACR3J,QAAS,QACT9E,MAAO,SAEXgR,MAAO,CACHxK,OAAQ,OACRxH,MAAO,QAGXiS,QAAS,CACLC,UAAW,QACXpM,QAAS,4BAsCFqM,GA/BGnT,IAAMoT,YAAW,SAAClN,EAAeqJ,GAC/C,MAIIrJ,EAHAmN,MACIzK,EAFR,EAEQA,GAAI1I,EAFZ,EAEYA,MAAOoT,EAFnB,EAEmBA,aAGblS,EAAUP,KAChB,EAAwBsD,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEA,OACI,cAACuK,GAAA,EAAD,CAAM3P,MAAI,EAAC4P,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAApC,SACI,cAAC,IAAD,CAAM7R,GAAE,iBAAY8G,EAAZ,KAAR,SACI,cAACK,GAAA,EAAD,CAAMxH,UAAWL,EAAQoB,KAAM+M,IAAKA,EAApC,SACI,cAACqE,GAAA,EAAD,UACI,sBAAKnS,UAAWL,EAAQwR,QAAxB,UACI,cAACX,GAAD,CACI7I,IAAKlJ,EACLmJ,IAAKL,EAAgBsK,EACrBlB,iBAAkBhR,EAAQ6R,QAC1BZ,aAAcjR,EAAQ4R,QAE1B,qBAAKvR,UAAWL,EAAQyR,WACxB,cAACtP,EAAA,EAAD,CAAY9B,UAAWL,EAAQlB,MAAOsD,QAAQ,KAAK+F,UAAU,KAA7D,SAAmErJ,kBC1DhF,SAAS2T,GAAU3N,GAC9B,IAGI4N,EAFAC,EACA7N,EADA6N,OAAQC,EACR9N,EADQ8N,QAASC,EACjB/N,EADiB+N,YAAaC,EAC9BhO,EAD8BgO,YAAaC,EAC3CjO,EAD2CiO,eAGzCC,EAAYC,mBAEZC,EAAgB,WAClB,GAAIF,EAAUG,QAAS,CACnB,IAAMC,EAAOJ,EAAUG,QAAQE,yBACzBD,EAAKE,EAAIF,EAAKhM,QAAU3E,OAAO8Q,YAAc,GAAMV,GACrDE,EAAeD,EAAc,KAsBzC,OAlBAzI,qBAAU,WAEN,OADA5H,OAAO8N,iBAAiB,SAAU2C,GAAe,GAC1C,WACHzQ,OAAOkO,oBAAoB,SAAUuC,GAAe,MAEzD,CAACL,EAAaF,IAGbD,EADkB,IAAlBC,EAAO9O,OACE,6BAAK+O,IAELD,EAAOhN,KAAI,SAAC6N,EAAIC,GACrB,OAAIA,IAAQd,EAAO9O,OAAS,EACjB,cAAC,GAAD,CAAWoO,MAAOuB,EAAIrF,IAAK6E,IAE/B,cAAC,GAAD,CAAWf,MAAOuB,OAK7B,cAACrB,GAAA,EAAD,CAAMuB,WAAS,EAAClS,QAAS,EAAGb,MAAO,CAAEmG,OAAQ,EAAGlH,MAAO,OAAQ8F,QAAS,OAAxE,SACKgN,IC5Bb,SAASiB,GAAS7O,GACd,IACI8O,EACA9O,EADA8O,SAAUxU,EACV0F,EADU1F,MAAO4O,EACjBlJ,EADiBkJ,MAGrB,OACI,qBACI1N,KAAK,WACLuT,OAAQzU,IAAU4O,EAClBxG,GAAE,0BAAqBwG,GAH3B,SAKK5O,IAAU4O,GAAS4F,IAKjB,SAASE,KACpB,MAAgCnS,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,WAAYE,EAAU,gCAAW,IAE5D,IAiEI8U,EAjEJ,EAAwBrS,mBAA2B,IAAnD,mBAAOsS,EAAP,KAAaC,EAAb,KACA,EAA4BvS,mBAAiB,GAA7C,mBAAOwS,EAAP,KAAeC,EAAf,KAIA,EAAsCzS,mBAAiB,GAAvD,mBAAOoR,EAAP,KAAoBC,EAApB,KA6DA,GAvDA1I,qBAAU,WACN+J,QAAQC,IAA2B,CAC/BzL,GAAO0B,IAAI,mBAAmBC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC1DR,GAAO0B,IAAI,oBAAoBC,MAAK,SAACC,GAAD,OAAcA,EAASpB,UAE1DmB,MACG,YAAkC,IAAD,mBAA/B+J,EAA+B,KACvBC,EADuB,KACG5O,KAAI,SAAC6H,GAAD,MAAe,CAC/CA,WACAmF,OAAQ,GACR6B,WAAW,MAGXF,EAAczQ,OAAS,GAA6B,IAAxB0Q,EAAa1Q,OAWzCoQ,EAAQ,CAVmB,CACvBzG,SAAU,CACNhK,KAAM,UACNuL,SAAS,EACT0F,MAAO,EACPjN,IAAK,GAETmL,OAAQ2B,EACRE,WAAW,IAER,mBACqBD,MAG5BN,EAAQM,GACRJ,EAAU,SAI3B,IAIH9J,qBAAU,WACN2J,EAAKrK,SAAQ,SAAC+K,EAAK1G,GACX0G,EAAIlH,SAASiH,QAAUP,GAAWQ,EAAIF,WAEtC5L,GAAO0B,IAAP,2BAA+BoK,EAAIlH,SAAShG,KACvC+C,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACH,IAAMuL,EAAYnQ,GAAYwP,GAC9BW,EAAU3G,GAAO2E,OAASvJ,EAC1BuL,EAAU3G,GAAOwG,WAAY,EAE7BP,EAAQU,WAIzB,CAACT,IAGAF,EAAKnQ,OAAS,EAAG,CAEjB,IAAM+Q,EAAaZ,EAAKrO,KAAI,SAAC+O,GAAD,OAAU,cAACG,GAAA,EAAD,CAAKtJ,MAAOmJ,EAAIlH,SAAShK,KAAMpE,MAAOsV,EAAIlH,SAASiH,WAEnFK,EAAYd,EAAKrO,KAAI,SAAC+O,GAAD,OACvB,cAACf,GAAD,CAAUvU,MAAO8U,EAAQlG,MAAO0G,EAAIlH,SAASiH,MAA7C,SACI,cAAChC,GAAD,CACIE,OAAQ+B,EAAI/B,OACZE,aAAa,EACbC,YAAaA,EACbC,eAAgBA,EAChBH,QAAS8B,EAAIF,UAAY,oBAAsB,oBAMrDO,EAAiBtS,OAAOuS,WAA2B,IAAdhB,EAAKnQ,OAChDkQ,EACI,qCACI,cAACkB,GAAA,EAAD,CACI7V,MAAO8U,EACPlO,SAAU,SAACC,EAAGiP,GAAJ,OAjFF,SAACA,GACrBf,EAAUe,GAgF2BC,CAAgBD,IACzCE,eAAe,UACfC,UAAU,UACVC,UAAWP,EACX3S,QAAS2S,EAAiB,aAAe,YACzCQ,cAAc,KAPlB,SASKX,IAEJE,SAGN,CACH,IAAMnC,EAAyB,IAAhBqB,EAAKnQ,OAAemQ,EAAK,GAAGrB,OAAS,GACpDoB,EACI,cAACtB,GAAD,CACIE,OAAQA,EACRE,aAAa,EACbC,YAAaA,EACbC,eAAgBA,EAChBH,QAASoB,EAAKnQ,OAAS,EAAI,wBAAqBkG,IAK5D,OAAOgK,EDpGXtB,GAAUlB,aAAe,CACrBqB,QAAS,cE5Cb,IAAMnT,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFkK,UAAW,CACPxE,OAAQ3F,EAAMK,QAAQ,GACtB5B,MAAO,aAKJ,SAAS4V,KACpB,MAAgC7T,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,UAAWE,EAAU,gCAAW,IAE3D,IAAQwW,EAAaC,cAAbD,SACFzV,EAAUP,KAChB,EAA0BiC,oBAAkB,GAA5C,mBAAOiU,EAAP,KAAcC,EAAd,KACA,EAA4BlU,mBAAuB,IAAnD,mBAAOiR,EAAP,KAAekD,EAAf,KACA,EAA8BnU,mBAAiB,IAA/C,mBAAOkR,EAAP,KAAgBkD,EAAhB,KACA,EAAoCpU,mBAAiB,IAArD,mBAAOqU,EAAP,KAAmBC,EAAnB,KACA,EAAsCtU,oBAAkB,GAAxD,mBAAOmR,EAAP,KAAoBoD,EAApB,KACA,EAAsCvU,mBAAiB,GAAvD,mBAAOoR,EAAP,KAAoBC,EAApB,KAEMmD,EAAYtX,IAAMuX,YAQxB,SAASC,IACL,GAAIF,EAAU/C,QAAS,CACnB,IAAQ/T,EAAU8W,EAAU/C,QAApB/T,MACM,KAAVA,GACAwW,GAAS,GACTE,EAAW,8BAEXF,GAAS,GACTI,EAAc5W,GACdyW,EAAU,IACVC,EAAW,gBAhBvBzL,qBAAU,WACNzB,GAAO0B,IAAP,yBAA6BmL,IACxBlL,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAA4BrK,EAAS,WAAD,OAAYqK,EAAK5F,YAChE,IAiBH6G,qBAAU,WACF0L,EAAWlS,OAAS,GACpB+E,GAAO0B,IAAP,yBAA6BmL,EAA7B,mBAAgDM,EAAhD,YAA8DjD,IACzDvI,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACH0M,EAAW,IACP1M,EAAKiN,UAAUxS,OAAS,GACxBgS,EAAU,GAAD,mBACFlD,GADE,YAEFvJ,EAAKiN,UAAU1Q,KAAI,SAAC6N,GAAD,MAAS,CAC3B1U,MAAO0U,EAAG1U,MAAOoT,aAAcsB,EAAGtB,aAAc1K,GAAIgM,EAAGhM,UAE/DyO,EAAe7M,EAAKyJ,cAEpBiD,EAAW,uCAI5B,CAACC,IAEJ,IAAMO,EACF,cAAC7D,GAAD,CACIE,OAAQA,EACRC,QAASA,EACTC,YAAaA,EACbC,YAAaA,EACbC,eAAgBA,IAIxB,OACI,qCACI,sBAAK1S,UAAWL,EAAQoB,KAAxB,UACI,cAACkK,GAAA,EAAD,CACIiL,SAAUL,EACVP,MAAOA,EACPnO,GAAG,iBACH+D,MAAM,gBACN/K,UAAW,SAACyF,GAAD,MAAiB,UAAVA,EAAE3D,KAAmB8T,OAE3C,cAAC5P,EAAA,EAAD,CAAQpE,QAAQ,YAAYxB,MAAM,UAAUL,QAAS,kBAAM6V,KAA3D,uBAIHE,K,kFCrFP7W,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QAUN,SAASiV,GAAY1R,GAChC,IAAM9E,EAAUP,KACV0B,EAAQ8L,eACNwJ,EAAsD3R,EAAtD2R,QAASC,EAA6C5R,EAA7C4R,sBAAuBC,EAAsB7R,EAAtB6R,kBAElCC,EAAUH,EAAQI,YAAc,IAAI1K,KAAKsK,EAAQI,YAAYC,cAAcC,MAAM,EAAG,IAE1F,EAAgCnY,IAAM8C,SAA6B,MAAnE,mBAAOsV,EAAP,KAAiBC,EAAjB,KAMMC,EAAc,WAChBD,EAAY,OAGVE,EAAa,SAAC7U,EAAalD,GAC7B8X,IAEA,IAAMzJ,EAAW,IAAIpE,SACrBoE,EAASC,OAAOpL,EAAKlD,GACrBwJ,GAAO8G,MAAP,wBAA8B+G,EAAQW,QAAtC,oBAAyDX,EAAQzI,OAASP,GACrElD,MAAK,kBAAMmM,QAQdW,EAA0C,SAAvBlW,EAAM0N,QAAQrD,KAAkB,UAAY,UACrE,OACI,mCACI,6BACI,cAAC3D,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,cAAC,IAAD,CACIV,GAAE,iBAAY+V,EAAQW,QAApB,oBAAuCX,EAAQzI,OACjDrN,MAAO,CACHE,eAAgB,OAChBD,MAAO6V,EAAQa,KAAOD,EAAmBlW,EAAM0N,QAAQkB,KAAK7O,SAJpE,SAOI,qBAAKP,MAAO,CAAE+F,QAAS,QAAvB,SACI,sBAAK/F,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,eAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,UACI,sBAAMxH,MAAO,CAAEC,MAAOO,EAAM0N,QAAQ3N,QAAQqW,MAA5C,SACKd,EAAQe,YAAc,cAAC,KAAD,MAE1Bf,EAAQjT,KACRiT,EAAQgB,cAAgB,GAAxB,aAAmChB,EAAQgB,kBAEhD,eAACtV,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,UACKqO,EAAQiB,UACRjB,EAAQiB,WAAa,IACrBd,EACAD,YAMjB,cAAC5U,EAAA,EAAD,CAAYE,aAAW,OAAO1B,QAtD9B,SAAC2F,GACjB+Q,EAAY/Q,EAAMyR,gBAqDF,SACI,cAAC,KAAD,MAEJ,eAAC,KAAD,CACIX,SAAUA,EACVY,aAAW,EACX1X,KAAM2X,QAAQb,GACd5W,QAAS8W,EAJb,UAMkC,IAA7BP,EAAkB9S,QAChB,cAACiU,GAAA,EAAD,CAAUvX,QA/Cb,WACpBqI,GAAO0B,IAAP,2BAA+BmM,EAAQW,QAAvC,oBAA0DX,EAAQzI,QAClEkJ,KA6CuB,sBACH,eAACY,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,cAAeV,EAAQe,aAA3D,UACKf,EAAQe,YAAc,mBACrBf,EAAQe,YAAc,cAE5B,eAACM,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,QAASV,EAAQa,OAArD,oBAEK,IACAb,EAAQa,MAAQ,UACfb,EAAQa,MAAQ,UAEtB,cAACQ,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,gBAAgB,IAApD,+C,0ECrHtB1X,GAAYC,aAAW,kBAAMgF,YAAa,CAC5CC,MAAO,CACHC,UAAW,IACXhF,MAAO,YAeA,SAASmY,GAAejT,GACnC,IAAM9E,EAAUP,KACRS,EAA2B4E,EAA3B5E,KAAMkF,EAAqBN,EAArBM,QAASgS,EAAYtS,EAAZsS,QACvB,EAA0C1V,mBAA0B,IAApE,mBAAOsW,EAAP,KAAsBC,EAAtB,KAEA,EAAsDvW,mBAAS,GAA/D,mBAAOwL,EAAP,KAA4BC,EAA5B,KAGA9C,qBAAU,WACN,IAAI6N,EAAoC,GACxCtP,GAAO0B,IAAI,qBACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACH8O,EAAmB9O,EAAKzD,KAAI,SAAC6H,GAAD,MAAe,CAAEA,WAAU2K,UAAU,SAEpE5N,MAAK,WACF3B,GAAO0B,IAAP,wBAA4B8M,EAA5B,eACK7M,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHA,EAAKO,SAAQ,SAAC6D,GACV0K,EAAiB1K,EAASiH,MAAQ,GAAG0D,UAAW,KAEpDF,EAAiBC,WAGlC,CAAChL,EAAqBhN,IAEzB,IAQMoG,EAAe,SAACJ,EAA4CkS,IAC1ClS,EAAMC,OAAlBJ,QAEiB6C,GAAO0B,IAAM1B,GAAOqG,QACtC,iBAAD,OAAkBmI,EAAlB,qBAAsCgB,IACvC7N,MAAK,kBAlCc4C,EAAuBD,EAAsB,OAqCzE,OACI,eAAC7H,EAAA,EAAD,CACIrF,QAASA,EACTsF,SAAS,KACTpF,KAAMA,EAHV,UAKI,cAACqF,EAAA,EAAD,6BACA,cAACC,EAAA,EAAD,CAAeC,UAAQ,EAAvB,SACI,eAAC4S,GAAA,EAAD,WAC8B,IAAzBL,EAAcnU,QAEP,wDAEI,uBAFJ,yCAMPmU,EAAcrS,KAAI,SAAC2S,GAAD,OACf,cAAC/I,GAAA,EAAD,CACIC,QACI,cAACC,GAAA,EAAD,CACI1J,QAASuS,EAAaH,SACtBnS,SAAU,SAACC,GAAD,OAAOK,EAAaL,EAAGqS,EAAa9K,SAAShG,KACvD5G,MAAM,YAGd2K,MAAO+M,EAAa9K,SAAShK,eAM7C,eAAC+C,EAAA,EAAD,WACI,cAACC,EAAA,EAAD,CAAQC,WAAS,EAAClG,QAjDT,WACjB6E,GAAQ,IAgDyCxE,MAAM,UAA/C,oBAGA,cAAC4F,EAAA,EAAD,CAAQjG,QAhDH,WACb6E,GAAQ,IA+C2BxE,MAAM,UAAjC,sBCahB,SAAS2X,GAAkBC,GACvB,OAAOA,GAAO,UAGH,SAASC,GAAa3T,GACjC,IAAQ7F,EAAc0C,qBAAWsI,GAAzBhL,UAEAgT,EAAUnN,EAAVmN,MACW,MAAfA,EAAMyG,QACNzG,EAAMyG,MAAQ,IAElB,MAAkChX,mBAC9BuQ,EAAM0G,UAAY,aAAe,kBADrC,mBAAOA,EAAP,KAAkBC,EAAlB,KAIA,EAAoDlX,oBAAkB,GAAtE,mBAAOmX,EAAP,KAA2BC,EAA3B,KAEAzO,qBAAU,WAEFpL,EADc,eAAd0Z,EAEI,qCACI,cAAC5W,EAAA,EAAD,CACIxB,QAAS,kBAAMuY,GAAsB,IACrC7W,aAAW,uBACXD,KAAK,MACLpB,MAAM,UAJV,SAMI,cAAC,KAAD,MAEJ,cAACmX,GAAD,CACI7X,KAAM2Y,EACNzT,QAAS0T,EACT1B,QAASnF,EAAMzK,QAKZ,gCACpB,CAACmR,EAAWE,IAEf,IA/CmBtR,EA+CnB,EAAwBxE,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAvJQ,SAAC2Y,GAAD,OAAuBjZ,aAAW,SAACyB,GAAD,YAAmB,CACnEC,KAAK,cACDxB,MAAO,QACNuB,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BnX,SAAU,SACV6P,IAAK,OACLuH,KAAM,MACNrZ,MAAO,OACPwH,OAAQ,qBACR8R,UAAW,aACXC,UAAW,SAGnBzH,IAAK,CACDhM,QAAS,QAKb0T,UAAW,CACP1S,QAAS,QAEb2S,SAAU,CACN,QAAS,CACLC,aAAc,EACdhU,SAAU,OACViU,SAAU,OACVnS,OAAQ,QAEZ9B,SAAU,OAKdkU,UAAU,cACNnR,WAAY,GACZ/C,SAAU,OACV,SAAU,CACNmU,WAAY,QAEftY,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UAGlB0S,QAAS,CACLhT,QAAS,OACTC,eAAgB,eAChB,WAAY,CACR/F,MAAqB,eAAd+X,EAA6B,UAAY,WAEpD,SAAU,CACNjS,QAAS,QACTM,SAAU,UAEd,MAAO,CACHnG,eAAgB,OAChBD,MAAO,UACP,WAAY,CACRA,MAAO,aAInByO,QAAM,GACFsK,YAAa,OACbC,aAAc,QAFZ,eAGDzY,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UAJZ,eAOD7F,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UARZ,GAWN6S,YAAa,CACT,OAAQ,CACJC,UAAW,MACX5S,aAAc,GAElB,MAAO,CACH6S,UAAW,UACXC,YAAa,eAGrBtB,MAAO,CACHhS,QAAS,OACTuT,SAAU,OACV,OAAQ,CACJC,OAAQ,oBACRZ,aAAc,SACd/X,YAAa,MACbuY,UAAW,EACX5S,aAAc,OACdxB,QAAS,QACT9E,MAAO,gBA0DCnB,CAAUkZ,EAAVlZ,GAgBhB,SAAS0a,IACa,mBAAdxB,EAbJ/P,GAAO0B,IAAP,wBAA4B2H,EAAMzK,GAAlC,cAAiD+C,MAAK,WAClDqO,EAAa,iBAMjBhQ,GAAOqG,OAAP,wBAA+BgD,EAAMzK,GAArC,cAAoD+C,MAAK,WACrDqO,EAAa,qBAYrB,OACI,sBAAKvY,UAAWL,EAAQoB,KAAxB,UACI,sBAAKf,UAAWL,EAAQ0R,IAAxB,UACI,sBAAKrR,UAAWL,EAAQoZ,UAAxB,UACI,qBAAK/Y,UAAWL,EAAQqZ,SAAxB,SACI,qBAAKpR,IAAG,UAAKL,GAAL,OAAqBqK,EAAMC,cAAgBlK,IAAI,sBAE3D,sBAAK3H,UAAWL,EAAQwZ,UAAxB,UACI,6BACKvH,EAAMnT,QAEX,yCAEK,IACD,+BAAOyZ,GAAkBtG,EAAMmI,aAEnC,yCAEK,IACD,+BAAO7B,GAAkBtG,EAAMoI,aAEnC,yCAEK,IACApI,EAAM9S,UAEX,yCAEK,KArGNoI,EAsGoB0K,EAAM1K,OArGzB,OAAhBA,EAAO/D,KACD,GAAN,OAAU+D,EAAO/D,KAAjB,aAA0B+D,EAAO3B,KAAK0U,oBAAtC,KAEG/S,EAAOC,aAsGF,sBAAKnH,UAAWL,EAAQ0Z,QAAxB,UACI,8BACI,eAAC3X,EAAA,EAAD,CAAYxB,QAAS,kBAAM4Z,KAA3B,UACmB,eAAdxB,GAA8B,cAAC,KAAD,IAChB,eAAdA,GAA8B,cAAC,KAAD,IAC/B,+BAAOA,SAIf,mBAAGpQ,KAAM0J,EAAMsI,IAAKpU,OAAO,SAA3B,SACI,eAACpE,EAAA,EAAD,WACI,cAAC,KAAD,IACA,wDAKhB,sBAAK1B,UAAWL,EAAQqP,OAAxB,UACI,sBAAKhP,UAAWL,EAAQ6Z,YAAxB,UACI,uCACA,4BAAI5H,EAAM4H,iBAEd,qBAAKxZ,UAAWL,EAAQ0Y,MAAxB,SACKzG,EAAMyG,MAAM8B,MAAM,MAAM7U,KAAI,SAAC8U,GAAD,OAAO,6BAAaA,GAAJA,cC9OjE,IAAMhb,GAAYC,YAAW,CACzBgM,QAAS,CACL5E,OAAQ,YACRJ,QAAS,OACTC,eAAgB,YAWT,SAAS+T,GAAmB5V,GACvC,IACI8O,EACA9O,EADA8O,SAAU+G,EACV7V,EADU6V,aAAcxS,EACxBrD,EADwBqD,UAAWyS,EACnC9V,EADmC8V,eAEjC5a,EAAUP,KAIhB,GAFkBkb,aAAwB1X,SAAW0X,IAAiBA,EAEvD,CACX,GAAIxS,EACA,OAAOvJ,IAAMic,cAAc1S,EAAWyS,GAG1C,GAAIhH,EACA,OACI,mCACKA,IAMjB,OACI,qBAAKvT,UAAWL,EAAQ0L,QAAxB,SACI,cAACI,GAAA,EAAD,CAAkBC,UAAW,M,kCCjCzC,SAAS+O,GAAWhW,GAEhB,OAAO,cAACiW,GAAA,EAAD,6BAAWjW,GAAX,IAAkBkW,UAAU,QAQvC,SAASC,GAAMnW,GACX,IAAQ8N,EAAsB9N,EAAtB8N,QAASsI,EAAapW,EAAboW,SACjB,EAAwBtc,IAAM8C,UAAS,GAAvC,mBAAOxB,EAAP,KAAakF,EAAb,KAEM8R,EAAc,WAChB9R,GAAQ,IAGZ,OACI,cAAC+V,GAAA,EAAD,CACIjb,KAAMA,EACNE,QAAS8W,EACTkE,iBAAkB,IAClBC,oBAAqBP,GACrBlI,QAAQ,gBALZ,SAOI,cAAC,KAAD,CAAU0I,UAAW,EAAGlZ,QAAQ,SAAShC,QAAS8W,EAAagE,SAAUA,EAAzE,SACKtI,MAMF,SAAS2I,GAAU3I,EAAiBsI,GAC/C,IAAM1T,EAAKgU,KAAKC,MAAsB,IAAhBD,KAAKE,UACrBhI,EAAYpD,SAASuK,cAAc,OACzCnH,EAAUlM,GAAV,gBAAwBA,GAExB8I,SAASqL,KAAKC,YAAYlI,GAE1BmI,IAASC,OAAO,cAACb,GAAD,CAAOrI,QAASA,EAASsI,SAAUA,IAAcxH,GAEjEqI,YAAW,kBAhDf,SAAqBvU,GACjB,IAAMkM,EAAYpD,SAAS0L,cAAT,WAA2BxU,IAC7CqU,IAASI,uBAAuBvI,GAChCpD,SAASqL,KAAKO,YAAYxI,GA6CTyI,CAAYzI,EAAUlM,MAAK,MC3ChD,IAAM/H,GAAYC,aAAW,SAACyB,GAAD,MAAmB,CAC5CC,KAAK,gBACAD,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BtS,QAAS,SAIjB0V,SAAS,cACLC,UAAW,OACX3W,QAAS,EACToM,UAAW,SACV3Q,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BpZ,MAAO,OACPwH,OAAQ,qBACRN,OAAQ,IAIhB4E,QAAS,CACL5E,OAAQ,SACRJ,QAAS,OACTC,eAAgB,cAIlB2V,GAAmB3Z,KAAKC,MAAMH,OAAOC,aAAaL,QAAQ,kBAAmBka,QAAQ,OAAQ,MAC7FC,GAAe,CACjBrd,OAAQ,UACRsd,MAAO,IAGI,SAASC,KACpB,IAAM1c,EAAUP,KAERV,EAAa4C,qBAAWsI,GAAxBlL,SACRsL,qBAAU,WAAQtL,EAAS,WAAa,IAExC,IAAQyI,EAAOkO,cAAPlO,GAER,EAA0B9F,qBAA1B,mBAAOuQ,EAAP,KAAc0K,EAAd,KACA,EAAgCjb,mBAAqB,IAArD,mBAAO0a,EAAP,KAAiBQ,EAAjB,KACA,EAA8Clb,oBAAS,GAAvD,mBAAOmb,EAAP,KAAwBC,EAAxB,KACA,EAA8Cpb,oBAAS,GAAvD,mBAAOqb,EAAP,KAAwBC,EAAxB,KACA,EAA4Dtb,mBAAS,GAArE,mBAAOub,EAAP,KAA+BC,EAA/B,KAEA,EAAwBxb,qBAAfyb,EAAT,oBACA,EAAmCzb,mBAAiB8a,IAApD,mBAASC,EAAT,KAASA,MAASW,EAAlB,KAEA,SAAS1G,IACLwG,EAA0BD,EAAyB,GAGvD5S,qBAAU,WACN,IAAMgT,EAAM,IAAIC,UAAJ,UAAiBhB,GAAjB,sBAkBZ,OAjBAe,EAAIE,UAAY,SAACtX,GACb,IAAMmD,EAAOzG,KAAKC,MAAMqD,EAAEmD,MAC1BgU,EAAchU,GAEd,IAAIoU,GAAe,EACnBpU,EAAKqT,MAAM9S,SAAQ,SAAC8T,GACZA,EAAErG,WAAF,OAAcnF,QAAd,IAAcA,OAAd,EAAcA,EAAOzK,KAAkB,aAAZiW,EAAEC,QAC7BF,GAAe,MAGnBA,GACA9G,KAIRyG,EAAYE,GAEL,kBAAMA,EAAIM,WAClB,CAAClB,EAAM5Y,SAEV,IAAM+Z,EAAuB,SAACnH,GAC1B,IAAIoH,EAAM,GASV,OARIpH,EAAQqH,aACRD,EAAM,sBAEVpB,EAAM9S,SAAQ,SAAC8T,GACPhH,EAAQzI,QAAUyP,EAAEM,cAAgBtH,EAAQW,UAAYqG,EAAErG,UAC1DyG,EAAG,+BAAmC,IAAbJ,EAAEO,SAAxB,UAGJH,GA4BX,OAzBAxT,qBAAU,gBACQN,IAAVkI,GAAwBA,EAAMgM,WAC9BrV,GAAO0B,IAAP,wBAA4B9C,EAA5B,8BAAyDuC,IAAVkI,IAC1C1H,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHuT,EAASvT,GACTrK,EAASqK,EAAKtK,YAG3B,CAACmT,IAEJ5H,qBAAU,WACN,IAAM6T,EAAoBrB,GAA8C,IAA3BI,EAC7CrU,GAAO0B,IAAP,wBAA4B9C,EAA5B,iCAAuD0W,IAClD3T,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACiB,IAAhBA,EAAKvF,QAAgBgZ,IACrBtB,GAAU,oBAAqB,WAC/ByB,GAAmB,IAEvBJ,EAAYxT,MAEfmB,MAAK,kBAAMuS,GAAmB,QACpC,CAACV,EAASvY,OAAQgZ,EAAiBI,IAGlC,sBAAK5c,UAAWL,EAAQoB,KAAxB,UACI,cAACsZ,GAAD,CACIC,kBAAwB5Q,IAAVkI,EACd9J,UAAWsQ,GACXmC,eAAgB,CAAE3I,WAGtB,cAACyI,GAAD,CACIC,aAAcyB,EAASvY,OAAS,GAAKkZ,EADzC,SAGI,cAAC,KAAD,CACIpc,MAAO,CACHyG,OAAQ,YACR+R,UAAW1W,OAAOuS,WAAa,IAAM,UAAY,QAErD3U,UAAWL,EAAQoc,SACnB+B,WAAY/B,EAASvY,OACrBua,YAAa,SAACpQ,GAAD,OACT,cAACwI,GAAD,CACIC,QAAS2F,EAASpO,GAClB2I,kBAAmBiH,EAAqBxB,EAASpO,IACjD0I,sBAAuBA,KAG/B2H,gBAAiB5b,OAAOuS,WAAa,IACrCsJ,SAA+B,GAArB7b,OAAO8Q,mBCxIrC,IAAM9T,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QASN,SAASgd,GAAYzZ,GAChC,IAAM9E,EAAUP,KACV0B,EAAQ8L,eACNuR,EAAmC1Z,EAAnC0Z,QAASC,EAA0B3Z,EAA1B2Z,sBAEX7H,EAAU4H,EAAQ3H,YAAc,IAAI1K,KAAKqS,EAAQ3H,YAAYC,cAAcC,MAAM,EAAG,IAE1F,EAAgCnY,IAAM8C,SAA6B,MAAnE,mBAAOsV,EAAP,KAAiBC,EAAjB,KAMMC,EAAc,WAChBD,EAAY,OAGVE,EAAa,SAAC7U,EAAalD,GAC7B8X,IAEA,IAAMzJ,EAAW,IAAIpE,SACrBoE,EAASC,OAAOpL,EAAKlD,GACrBwJ,GAAO8G,MAAP,8BAAoC8O,EAAQE,QAA5C,oBAA+DF,EAAQxQ,OAASP,GAC3ElD,MAAK,kBAAMkU,QAGdpH,EAA0C,SAAvBlW,EAAM0N,QAAQrD,KAAkB,UAAY,UACrE,OACI,mCACI,6BACI,cAAC3D,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,cAAC,IAAD,CACIV,GAAE,iBAAY8d,EAAQE,QAApB,oBAAuCF,EAAQxQ,OACjDrN,MAAO,CACHE,eAAgB,OAChBD,MAAO4d,EAAQlH,KAAOD,EAAmBlW,EAAM0N,QAAQkB,KAAK7O,SAJpE,SAOI,qBAAKP,MAAO,CAAE+F,QAAS,QAAvB,SACI,sBAAK/F,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,eAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,UACI,sBAAMxH,MAAO,CAAEC,MAAOO,EAAM0N,QAAQ3N,QAAQqW,MAA5C,SACKiH,EAAQhH,YAAc,cAAC,KAAD,MAE1BgH,EAAQhb,KACRgb,EAAQG,cAAgB,GAAxB,aAAmCH,EAAQG,kBAEhD,eAACxc,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,UACKoW,EAAQ9G,UACR8G,EAAQ9G,WAAa,IACrBd,YAMjB,cAAC7U,EAAA,EAAD,CAAYE,aAAW,OAAO1B,QAhD9B,SAAC2F,GACjB+Q,EAAY/Q,EAAMyR,gBA+CF,SACI,cAAC,KAAD,MAEJ,eAAC,KAAD,CACIX,SAAUA,EACVY,aAAW,EACX1X,KAAM2X,QAAQb,GACd5W,QAAS8W,EAJb,UAOI,eAACY,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,cAAeqH,EAAQhH,aAA3D,UACKgH,EAAQhH,YAAc,mBACrBgH,EAAQhH,YAAc,cAE5B,eAACM,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,QAASqH,EAAQlH,OAArD,oBAEK,IACAkH,EAAQlH,MAAQ,UACfkH,EAAQlH,MAAQ,UAEtB,cAACQ,GAAA,EAAD,CAAUvX,QAAS,kBAAM4W,EAAW,gBAAgB,IAApD,+CCC5B,SAASoB,GAAkBC,GACvB,OAAOA,GAAO,UAGH,SAASoG,GAAa9Z,GACjC,IAAQ7F,EAAc0C,qBAAWsI,GAAzBhL,UAEAgT,EAAUnN,EAAVmN,MACW,MAAfA,EAAMyG,QACNzG,EAAMyG,MAAQ,IAElB,MAAkChX,mBAC9BuQ,EAAM0G,UAAY,aAAe,kBADrC,mBAAOA,EAAP,KAAkBC,EAAlB,KAIA,EAAoDlX,oBAAkB,GAAtE,mBAAOmX,EAAP,KAA2BC,EAA3B,KAEAzO,qBAAU,WAEFpL,EADc,eAAd0Z,EAEI,qCACI,cAAC5W,EAAA,EAAD,CACIxB,QAAS,kBAAMuY,GAAsB,IACrC7W,aAAW,uBACXD,KAAK,MACLpB,MAAM,UAJV,SAMI,cAAC,KAAD,MAEJ,cAACmX,GAAD,CACI7X,KAAM2Y,EACNzT,QAAS0T,EACT1B,QAASnF,EAAMzK,QAKZ,gCACpB,CAACmR,EAAWE,IAEf,IA/CmBtR,EA+CnB,EAAwBxE,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAvJQ,SAAC2Y,GAAD,OAAuBjZ,aAAW,SAACyB,GAAD,YAAmB,CACnEC,KAAK,cACDxB,MAAO,QACNuB,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BnX,SAAU,SACV6P,IAAK,OACLuH,KAAM,MACNrZ,MAAO,OACPwH,OAAQ,qBACR8R,UAAW,aACXC,UAAW,SAGnBzH,IAAK,CACDhM,QAAS,QAKb0T,UAAW,CACP1S,QAAS,QAEb2S,SAAU,CACN,QAAS,CACLC,aAAc,EACdhU,SAAU,OACViU,SAAU,OACVnS,OAAQ,QAEZ9B,SAAU,OAKdkU,UAAU,cACNnR,WAAY,GACZ/C,SAAU,OACV,SAAU,CACNmU,WAAY,QAEftY,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UAGlB0S,QAAS,CACLhT,QAAS,OACTC,eAAgB,eAChB,WAAY,CACR/F,MAAqB,eAAd+X,EAA6B,UAAY,WAEpD,SAAU,CACNjS,QAAS,QACTM,SAAU,UAEd,MAAO,CACHnG,eAAgB,OAChBD,MAAO,UACP,WAAY,CACRA,MAAO,aAInByO,QAAM,GACFsK,YAAa,OACbC,aAAc,QAFZ,eAGDzY,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UAJZ,eAOD7F,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BhS,SAAU,UARZ,GAWN6S,YAAa,CACT,OAAQ,CACJC,UAAW,MACX5S,aAAc,GAElB,MAAO,CACH6S,UAAW,UACXC,YAAa,eAGrBtB,MAAO,CACHhS,QAAS,OACTuT,SAAU,OACV,OAAQ,CACJC,OAAQ,oBACRZ,aAAc,SACd/X,YAAa,MACbuY,UAAW,EACX5S,aAAc,OACdxB,QAAS,QACT9E,MAAO,gBA0DCnB,CAAUkZ,EAAVlZ,GAgBhB,SAAS0a,IACa,mBAAdxB,EAbJ/P,GAAO0B,IAAP,8BAAkC2H,EAAMzK,GAAxC,cAAuD+C,MAAK,WACxDqO,EAAa,iBAMjBhQ,GAAOqG,OAAP,8BAAqCgD,EAAMzK,GAA3C,cAA0D+C,MAAK,WAC3DqO,EAAa,qBAYrB,OACI,sBAAKvY,UAAWL,EAAQoB,KAAxB,UACI,sBAAKf,UAAWL,EAAQ0R,IAAxB,UACI,sBAAKrR,UAAWL,EAAQoZ,UAAxB,UACI,qBAAK/Y,UAAWL,EAAQqZ,SAAxB,SACI,qBAAKpR,IAAG,UAAKL,GAAL,OAAqBqK,EAAMC,aAA3B,cAA6CsJ,KAAKE,UAAY1T,IAAI,sBAE9E,sBAAK3H,UAAWL,EAAQwZ,UAAxB,UACI,6BACKvH,EAAMnT,QAEX,yCAEK,IACD,+BAAOyZ,GAAkBtG,EAAMmI,aAEnC,yCAEK,IACD,+BAAO7B,GAAkBtG,EAAMoI,aAEnC,yCAEK,IACApI,EAAM9S,UAEX,yCAEK,KArGNoI,EAsGoB0K,EAAM1K,OArGzB,OAAhBA,EAAO/D,KACD,GAAN,OAAU+D,EAAO/D,KAAjB,aAA0B+D,EAAO3B,KAAK0U,oBAAtC,KAEG/S,EAAOC,aAsGF,sBAAKnH,UAAWL,EAAQ0Z,QAAxB,UACI,8BACI,eAAC3X,EAAA,EAAD,CAAYxB,QAAS,kBAAM4Z,KAA3B,UACmB,eAAdxB,GAA8B,cAAC,KAAD,IAChB,eAAdA,GAA8B,cAAC,KAAD,IAC/B,+BAAOA,SAIf,mBAAGpQ,KAAM0J,EAAMsI,IAAKpU,OAAO,SAA3B,SACI,eAACpE,EAAA,EAAD,WACI,cAAC,KAAD,IACA,wDAKhB,sBAAK1B,UAAWL,EAAQqP,OAAxB,UACI,sBAAKhP,UAAWL,EAAQ6Z,YAAxB,UACI,uCACA,4BAAI5H,EAAM4H,iBAEd,qBAAKxZ,UAAWL,EAAQ0Y,MAAxB,SACKzG,EAAMyG,MAAM8B,MAAM,MAAM7U,KAAI,SAAC8U,GAAD,OAAO,6BAAaA,GAAJA,cCzOjE,IAAMhb,GAAYC,aAAW,SAACyB,GAAD,MAAmB,CAC5CC,KAAK,gBACAD,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BtS,QAAS,SAIjB0V,SAAS,cACLC,UAAW,OACX3W,QAAS,EACToM,UAAW,SACV3Q,EAAM4X,YAAYC,GAAG,MAAQ,CAC1BpZ,MAAO,OACPwH,OAAQ,qBACRN,OAAQ,IAIhB4E,QAAS,CACL5E,OAAQ,SACRJ,QAAS,OACTC,eAAgB,cAIT,SAASkY,KACpB,IAAM7e,EAAUP,KAERV,EAAa4C,qBAAWsI,GAAxBlL,SACRsL,qBAAU,WAAQtL,EAAS,WAAa,IAExC,IAAQyI,EAAOkO,cAAPlO,GAER,EAA0B9F,qBAA1B,mBAAOuQ,EAAP,KAAc0K,EAAd,KACA,EAAgCjb,mBAAqB,IAArD,mBAAOod,EAAP,KAAiBC,EAAjB,KACA,EAA8Crd,oBAAS,GAAvD,mBAAOsd,EAAP,KAAwBC,EAAxB,KACA,EAA8Cvd,oBAAS,GAAvD,mBAAOwd,EAAP,KAAwBC,EAAxB,KACA,EAA4Dzd,mBAAS,GAArE,mBAAO0d,EAAP,KAA+BC,EAA/B,KAEA,SAASZ,IACLY,EAA0BD,EAAyB,GA4BvD,OAzBA/U,qBAAU,gBACQN,IAAVkI,GAAwBA,EAAMgM,WAC9BrV,GAAO0B,IAAP,8BAAkC9C,EAAlC,8BAA+DuC,IAAVkI,IAChD1H,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHuT,EAASvT,GACTrK,EAASqK,EAAKtK,YAG3B,CAACmT,IAEJ5H,qBAAU,WACN,IAAM6T,EAAoBc,GAA8C,IAA3BI,EAC7CxW,GAAO0B,IAAP,8BAAkC9C,EAAlC,iCAA6D0W,IACxD3T,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACiB,IAAhBA,EAAKvF,QAAgBmb,IACrBzD,GAAU,oBAAqB,WAC/B4D,GAAmB,IAEvBJ,EAAY3V,MAEfmB,MAAK,kBAAM0U,GAAmB,QACpC,CAACH,EAASjb,OAAQmb,EAAiBI,IAGlC,sBAAK/e,UAAWL,EAAQoB,KAAxB,UACI,cAACsZ,GAAD,CACIC,kBAAwB5Q,IAAVkI,EACd9J,UAAWyW,GACXhE,eAAgB,CAAE3I,WAGtB,cAACyI,GAAD,CACIC,aAAcmE,EAASjb,OAAS,GAAKqb,EADzC,SAGI,cAAC,KAAD,CACIve,MAAO,CACHyG,OAAQ,YACR+R,UAAW1W,OAAOuS,WAAa,IAAM,UAAY,QAErD3U,UAAWL,EAAQoc,SACnB+B,WAAYW,EAASjb,OACrBua,YAAa,SAACpQ,GAAD,OACT,cAACuQ,GAAD,CACIC,QAASM,EAAS9Q,GAClByQ,sBAAuBA,KAG/BJ,gBAAiB5b,OAAOuS,WAAa,IACrCsJ,SAA+B,GAArB7b,OAAO8Q,mBC9FrC,IAAM9T,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QASN,SAAS+d,GAAcxa,GAClC,MAKIA,EAJAya,UACI/b,EAFR,EAEQA,KAAMoC,EAFd,EAEcA,KAAM4Z,EAFpB,EAEoBA,YAAaC,EAFjC,EAEiCA,UAAWC,EAF5C,EAE4CA,UAAWC,EAFvD,EAEuDA,SAAUC,EAFjE,EAEiEA,QAASnY,EAF1E,EAE0EA,QAEtEoY,EACA/a,EADA+a,cAEJ,EAA4Cne,oBACxC,WACI,OAAIie,EAAmB,WACnBD,EAAoB,SAChBD,EAAY,YAAc,aAJ1C,mBAAOK,EAAP,KAAuBC,EAAvB,KAQA,EAAwBhd,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAAUP,KACVugB,EAAqB,QAATpa,EAAiB,MAAQA,EAAKqa,cAoBhD,SAASC,IACLH,EAAkB,gBAClBnX,GAAO0B,IAAP,sCAA0CsV,IACrCrV,MAAK,WAEFsV,OAIZ,SAAS1F,IACL,OAAQ2F,GACJ,IAAK,UA5BTC,EAAkB,cAClBnX,GAAO0B,IAAP,oCAAwCsV,IACnCrV,MAAK,WACFwV,EAAkB,aAClBF,OA0BA,MACJ,IAAK,SAtBTE,EAAkB,YAClBnX,GAAO0B,IAAP,mCAAuCsV,IAClCrV,MAAK,WACFwV,EAAkB,aAClBF,OAoBA,MACJ,IAAK,WACDK,IACAnE,YAAW,kBAAMtZ,OAAO6F,SAAS6X,WAAU,KAC3C,MACJ,IAAK,YACDD,KAOZ,OACI,cAACrY,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,sBAAKT,MAAO,CAAE+F,QAAS,QAAvB,UACI,cAACqB,GAAA,EAAD,CACI3F,QAAQ,UACR/B,UAAWL,EAAQmH,KACnBa,IAAKxE,EACLyE,IAAKL,EAAgBH,IAEzB,sBAAK9G,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,cAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,SACK3E,IAEL,eAACrB,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,UACK4X,EACA,IACAR,WAKb,cAAChZ,EAAA,EAAD,CACIpE,QAAQ,WACRzB,MAAO,CAAEC,MAA0B,aAAnBkf,EAAgC,MAAQ,WACxDvf,QAAS,kBAAM4Z,KAHnB,SAKK2F,SC/HrB,IAAM7a,GAAqB,GAiCZ,SAASmb,KACpB,MAAgCze,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClB,EAAoC8D,EAA0B,sBALxD,GAAN,mB5B4BO,CAEH,O4B9BJ,CAA2B,SAK3B,mBAAOgC,EAAP,KAAmBC,EAAnB,KAEAqF,qBAAU,WACNtL,EAAS,cACTE,EACI,cAAC4F,GAAD,CACIE,WAAYA,EACZC,cAAeA,EACfC,SAAUA,QAGnB,CAACF,IAEJ,MAA0CrD,mBAAuB,IAAjE,mBAAO2e,EAAP,KAAsBC,EAAtB,KACA,EAAoC5e,mBAAc,IAAlD,mBAAO6e,EAAP,KAAmBC,EAAnB,KAEA,EAAsD9e,mBAAS,GAA/D,mBAAOwL,EAAP,KAA4BC,EAA5B,KAgBA,GAbA9C,qBAAU,WACNzB,GAAO0B,IAAI,0BACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAAUkX,EAAiBlX,QACtC,CAAC8D,IAEJ7C,qBAAU,WACN,GAAIgW,EAAcxc,OAAS,EAAG,CAC1B,IAAM4c,EA5DlB,SAAyBF,GACrBtb,GAASpB,OAAS,EAClB,IAAMI,EAAS,CAAEwb,UAAW,GAAI,kBAAmB,IAsBnD,OArBAc,EAAW1W,MAAK,SAACzF,EAAGC,GAAJ,OAAYD,EAAEsc,QAAUrc,EAAEqc,QAAW,GAAK,KAE1DH,EAAW5W,SAAQ,SAAC4V,QACexV,IAA3B9F,EAAOsb,EAAU3Z,QACjB3B,EAAOsb,EAAU3Z,MAAQ,GACF,QAAnB2Z,EAAU3Z,MAAkBX,GAAS2E,KAAK2V,EAAU3Z,OAExD2Z,EAAUE,UACNF,EAAUG,UACVzb,EAAO,mBAAmB2F,KAAK2V,GAE/Btb,EAAOwb,UAAU7V,KAAK2V,GAG1Btb,EAAOsb,EAAU3Z,MAAMgE,KAAK2V,MAKpCta,GAAS4E,KAAK1F,IAEPF,EAoC0B0c,CAAgBN,GACzCG,EAAcC,MAEnB,CAACJ,IAEsC,IAAtC/W,OAAOmB,QAAQ8V,GAAY1c,OAC3B,OAAO,4CAEX,IAAM+c,EAAY,CAAI,kBAAmB,aAAvB,mBAAuC7b,IACzD,OACI,mCAEQuE,OAAOmB,QAAQ8V,GAAY5a,KAAI,mCAAEC,EAAF,KAAQjG,EAAR,YACO,IAAhCihB,EAAahd,QAAQgC,IAAiBjG,EAAYkE,OAAS,GAErD,eAAC,IAAM6G,SAAP,WACI,oBAAe/J,MAAO,CAAE0H,WAAY,IAApC,SACK3E,GAAekC,IADXA,GAGPjG,EAAsBgG,KAAI,SAAC6N,GAAD,OACxB,cAAC8L,GAAD,CAEIC,UAAW/L,EACXqM,cAAe,WAjCvB1S,EAAuBD,EAAsB,KA+BhCsG,EAAGkN,cANC9a,QC/ElC,SAASib,GAAa/b,GACjC,MAAgCnD,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,UAAWE,EAAU,gCAAW,IAE3D,IAAQwW,EAAaC,cAAbD,SACR,EAA4B/T,mBAAuB,IAAnD,mBAAOiR,EAAP,KAAekD,EAAf,KACA,EAAsCnU,oBAAkB,GAAxD,mBAAOmR,EAAP,KAAoBoD,EAApB,KACA,EAAsCvU,mBAAiB,GAAvD,mBAAOoR,EAAP,KAAoBC,EAApB,KAsBA,OApBA1I,qBAAU,WACNzB,GAAO0B,IAAP,yBAA6BmL,IACxBlL,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAA4BrK,EAASqK,EAAK5F,WACrD,IAEH6G,qBAAU,WACN,IAAMyW,EAAahc,EAAMic,QAAU,UAAY,SAC/CnY,GAAO0B,IAAP,yBAA6BmL,EAA7B,YAAyCqL,EAAzC,YAAuDhO,IAClDvI,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHyM,EAAU,GAAD,mBACFlD,GADE,YAEFvJ,EAAKiN,UAAU1Q,KAAI,SAAC6N,GAAD,MAAS,CAC3B1U,MAAO0U,EAAG1U,MAAOoT,aAAcsB,EAAGtB,aAAc1K,GAAIgM,EAAGhM,UAE/DyO,EAAe7M,EAAKyJ,kBAE7B,CAACC,IAGA,cAACL,GAAD,CACIE,OAAQA,EACRE,YAAaA,EACbC,YAAaA,EACbC,eAAgBA,I,cC9BtBtT,GAAYC,YAAW,CACzB0B,KAAM,CACFgG,OAAQ,OACRxH,MAAO,OACP8G,QAAS,QAEb8K,QAAS,CACL3P,SAAU,WACVuF,OAAQ,QAEZqK,SAAU,CACN5P,SAAU,WACV6P,IAAK,EACL9R,MAAO,OACPwH,OAAQ,OACR0H,WAAY,mDACZ6C,QAAS,IAEb7S,MAAO,CACH+C,SAAU,WACVwN,OAAQ,EACR3J,QAAS,QACT9E,MAAO,SAEXgR,MAAO,CACHxK,OAAQ,OACRxH,MAAO,UAuCAohB,GAhCGpiB,IAAMoT,YAAW,SAAClN,EAAeqJ,GAC/C,MAIIrJ,EAHAmN,MACIzK,EAFR,EAEQA,GAAI1I,EAFZ,EAEYA,MAAOoT,EAFnB,EAEmBA,aAGblS,EAAUP,KAChB,EAAwBsD,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEA,OACI,cAACuK,GAAA,EAAD,CAAM3P,MAAI,EAAC4P,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAApC,SACI,cAAC,IAAD,CAAM7R,GAAE,iBAAY8G,EAAZ,KAAR,SACI,cAACK,GAAA,EAAD,CAAMxH,UAAWL,EAAQoB,KAAM+M,IAAKA,EAApC,SACI,cAACqE,GAAA,EAAD,UACI,sBAAKnS,UAAWL,EAAQwR,QAAxB,UACI,cAACyP,GAAA,EAAD,CACI5gB,UAAWL,EAAQ4R,MACnBzJ,UAAU,MACVH,IAAKlJ,EACL8S,MAAOhK,EAAgBsK,EACvBpT,MAAOA,IAEX,qBAAKuB,UAAWL,EAAQyR,WACxB,cAACtP,EAAA,EAAD,CAAY9B,UAAWL,EAAQlB,MAAOsD,QAAQ,KAAK+F,UAAU,KAA7D,SAAmErJ,kBCtDhF,SAASoiB,GAAUpc,GAC9B,IAGI4N,EAFAC,EACA7N,EADA6N,OAAQC,EACR9N,EADQ8N,QAASC,EACjB/N,EADiB+N,YAAaC,EAC9BhO,EAD8BgO,YAAaC,EAC3CjO,EAD2CiO,eAGzCC,EAAYC,mBAEZC,EAAgB,WAClB,GAAIF,EAAUG,QAAS,CACnB,IAAMC,EAAOJ,EAAUG,QAAQE,yBACzBD,EAAKE,EAAIF,EAAKhM,QAAU3E,OAAO8Q,YAAc,GAAMV,GACrDE,EAAeD,EAAc,KAsBzC,OAlBAzI,qBAAU,WAEN,OADA5H,OAAO8N,iBAAiB,SAAU2C,GAAe,GAC1C,WACHzQ,OAAOkO,oBAAoB,SAAUuC,GAAe,MAEzD,CAACL,EAAaF,IAGbD,EADkB,IAAlBC,EAAO9O,OACE,6BAAK+O,IAELD,EAAOhN,KAAI,SAAC6N,EAAIC,GACrB,OAAIA,IAAQd,EAAO9O,OAAS,EACjB,cAAC,GAAD,CAAWoO,MAAOuB,EAAIrF,IAAK6E,IAE/B,cAAC,GAAD,CAAWf,MAAOuB,OAK7B,cAACrB,GAAA,EAAD,CAAMuB,WAAS,EAAClS,QAAS,EAAGb,MAAO,CAAEmG,OAAQ,EAAGlH,MAAO,OAAQ8F,QAAS,OAAxE,SACKgN,ICzCE,SAASyO,GAAarc,GACjC,MAAgCnD,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClBoL,qBAAU,WAAQtL,EAAS,UAAWE,EAAU,gCAAW,IAE3D,IAAQwW,EAAaC,cAAbD,SACR,EAA4B/T,mBAAuB,IAAnD,mBAAOiR,EAAP,KAAekD,EAAf,KACA,EAAsCnU,oBAAkB,GAAxD,mBAAOmR,EAAP,KAAoBoD,EAApB,KACA,EAAsCvU,mBAAiB,GAAvD,mBAAOoR,EAAP,KAAoBC,EAApB,KAsBA,OApBA1I,qBAAU,WACNzB,GAAO0B,IAAP,+BAAmCmL,IAC9BlL,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAA4BrK,EAASqK,EAAK5F,WACrD,IAEH6G,qBAAU,WACN,IAAMyW,EAAahc,EAAMic,QAAU,UAAY,SAC/CnY,GAAO0B,IAAP,+BAAmCmL,EAAnC,YAA+CqL,EAA/C,YAA6DhO,IACxDvI,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHyM,EAAU,GAAD,mBACFlD,GADE,YAEFvJ,EAAKiN,UAAU1Q,KAAI,SAAC6N,GAAD,MAAS,CAC3B1U,MAAO0U,EAAG1U,MAAOoT,aAAcsB,EAAGtB,aAAc1K,GAAIgM,EAAGhM,UAE/DyO,EAAe7M,EAAKyJ,kBAE7B,CAACC,IAGA,cAACoO,GAAD,CACIvO,OAAQA,EACRE,YAAaA,EACbC,YAAaA,EACbC,eAAgBA,ICnC5B,SAASqO,GAAWC,GAChB,MAA4B,cAAxBA,EAASC,YACc,cAAxBD,EAASC,YACe,2BAAxBD,EAASC,YACe,2BAAxBD,EAASC,WACD,CACH5a,QAAS,QACT2B,WAAY,MACZ9G,YAAa,MACb3B,MAAO,OACPkS,UAAW,OACX1K,OAAQ,OACRxC,UAAW,OACX2c,UAAW,UACXC,cAAe,QAIhB,CACH9a,QAAS,QACTQ,aAAsC,sBAAxBma,EAASC,WAAqC,OAAS,EACrE/H,SAAU,OACV3Z,MAAO,OACP0F,SAAU,QFwBlB4b,GAAU3P,aAAe,CACrBqB,QAAS,cErBb,IA+Ee6O,GAvDF7iB,IAAMoT,YAAW,SAAClN,EAAeqJ,GAC1C,IACIlG,EACAnD,EADAmD,IAAK+F,EACLlJ,EADKkJ,MAAO8C,EACZhM,EADYgM,YAAa4Q,EACzB5c,EADyB4c,WAAYL,EACrCvc,EADqCuc,SAGnCrhB,EA7BQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxDgM,QAAS,CACL5E,OAAQ,aACRM,OAAQ,QACRxH,MAAO,SAEX+hB,aAAc,CACVva,OAAQ,QACRxH,MAAO,OACP8F,QAAS,wBACTkc,gBAAiB,UACjB1a,aAAc,IAElB0K,MAAOwP,GAAWC,KAgBF5hB,CAAU4hB,EAAV5hB,GACVsR,EAASkC,iBAAyB,MAElC4O,EAAuB,WACzB,GAAI9Q,EAAOoC,QAAS,CAChB,IAAMC,EAAOrC,EAAOoC,QAAQE,wBACxBD,EAAKE,EAAI,GAAKF,EAAKE,EAAIF,EAAKhM,OAAS,GACrCsa,EAAW1T,KAKjB8T,EAAyB,WAC3B,GAAI/Q,EAAOoC,QAAS,CAChB,IAAMC,EAAOrC,EAAOoC,QAAQE,wBACxBD,EAAK6F,MAAQxW,OAAOuS,WAAa,GAAK5B,EAAK9D,MAAQ7M,OAAOuS,WAAa,GACvE0M,EAAW1T,KAoBvB,OAfA3D,qBAAU,WACN,OAAQgX,EAASC,YACb,IAAK,UACL,IAAK,oBAED,OADA7e,OAAO8N,iBAAiB,SAAUsR,GAC3B,kBAAMpf,OAAOkO,oBAAoB,SAAUkR,IACtD,IAAK,yBACL,IAAK,yBAED,OADApf,OAAO8N,iBAAiB,SAAUuR,GAC3B,kBAAMrf,OAAOkO,oBAAoB,SAAUmR,IACtD,QACI,OAAO,gBAEhB,CAACD,IAGA,qBAAK1T,IAAKA,EAAKxN,MAAO,CAAEmG,OAAQ,UAAhC,SACI,cAAC+J,GAAD,CACI5I,IAAKA,EACL6I,YAAaA,EACb9I,IAAG,gBAAWgG,GACd+C,OAAQA,EACRC,iBAAgB,UAAKhR,EAAQ4R,MAAb,YAAsB5R,EAAQ2hB,cAC9C1Q,aAAcjR,EAAQ4R,aCxFvB,SAASmQ,GAAgBjd,GACpC,IACIkd,EACAld,EADAkd,MAAOC,EACPnd,EADOmd,QAASZ,EAChBvc,EADgBuc,SAAUK,EAC1B5c,EAD0B4c,WAAYQ,EACtCpd,EADsCod,YAAaC,EACnDrd,EADmDqd,YAGjDniB,EAlBQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxD0iB,OAAQ,CACJ1b,QAAS,OACTwB,cAAwC,2BAAxBmZ,EAASC,WAA2C,MAAQ,cAC5E3a,eAAyC,2BAAxB0a,EAASC,WAA2C,aAAe,WACpFxa,OAAQ,SACRlH,MAAO,OACPwH,OAAQ,OACRib,UAAW,UACXC,WAAY,UASA7iB,CAAU4hB,EAAV5hB,GAEV8iB,EAAUtP,iBAAuB,MACjCuP,EAAWvP,iBAAyB,IAE1C,SAASwP,IAC4B,IAAD,EAA5BR,EAAUD,EAAMne,OAAS,GACzB,UAAA2e,EAASrP,QAAQ8O,EAAU,UAA3B,SAA+BS,eAAe,CAAEC,OAAQ,WACxDjB,GAAW,SAACkB,GAAD,OAAUA,EAAO,MACrBvB,EAASwB,kBAChBV,IAIR,SAASW,IACa,IAAD,EAAbb,EAAU,GACV,UAAAO,EAASrP,QAAQ8O,EAAU,UAA3B,SAA+BS,eAAe,CAAEC,OAAQ,WACxDjB,EAAWO,EAAU,IACF,IAAZA,GACPC,IAoBR,IAAMa,EAAY9P,iBAAe,GAEjC,SAAS+P,EAAW/c,GAChBxD,OAAOwgB,SAASF,EAAU5P,QAAUlN,EAAEid,MAAO,GAGjD,SAASC,EAAYld,GAAe,IAAD,EAC/B8c,EAAU5P,QAAUlN,EAAEid,MACtB,UAAAX,EAAQpP,eAAR,SAAiB5C,iBAAiB,YAAayS,GAGnD,SAASI,IAAqB,IAAD,EACzB,UAAAb,EAAQpP,eAAR,SAAiBxC,oBAAoB,YAAaqS,GAGtD,SAASK,EAAapd,GACdA,EAAEqd,SAA+B,IAApB7gB,OAAOuS,WAvBI,2BAAxBqM,EAASC,WACTmB,IAEAK,IAsBO7c,EAAEqd,SAA+B,IAApB7gB,OAAOuS,aAjCH,2BAAxBqM,EAASC,WACTwB,IAEAL,KAmCR,IAAMc,EAAyB,WACC,2BAAxBlC,EAASC,WACL7e,OAAO+gB,QAAU/gB,OAAOuS,YAAc1E,SAASqL,KAAK8H,aACpDtB,IAE2B,2BAAxBd,EAASC,YACZ7e,OAAO+gB,SAAW/gB,OAAOuS,YACzBmN,KA+BZ,OA1BA9X,qBAAU,WAAO,IAAD,EACZ,UAAAmY,EAASrP,QAAQ8O,UAAjB,SAA2BS,eAAe,CAAEC,OAAQ,aACrD,CAACtB,EAASC,aAEbjX,qBAAU,WAAO,IAAD,IAIZ,OAHA,UAAAkY,EAAQpP,eAAR,SAAiB5C,iBAAiB,YAAa4S,GAC/C,UAAAZ,EAAQpP,eAAR,SAAiB5C,iBAAiB,UAAW6S,GAEtC,WAAO,IAAD,IACT,UAAAb,EAAQpP,eAAR,SAAiBxC,oBAAoB,YAAawS,GAClD,UAAAZ,EAAQpP,eAAR,SAAiBxC,oBAAoB,UAAWyS,MAErD,CAACb,IAEJlY,qBAAU,WAAO,IAAD,EAMZ,OALIgX,EAASwB,kBACTvS,SAASC,iBAAiB,SAAUgT,GAExC,UAAAhB,EAAQpP,eAAR,SAAiB5C,iBAAiB,YAAa8S,GAExC,WAAO,IAAD,EACT/S,SAASK,oBAAoB,SAAU4S,GACvC,UAAAhB,EAAQpP,eAAR,SAAiBxC,oBAAoB,YAAa0S,MAEvD,CAACd,EAASN,IAGT,qBAAK9T,IAAKoU,EAASliB,UAAWL,EAAQoiB,OAAtC,SAEQJ,EAAMrc,KAAI,SAACid,GAAD,OACN,cAAC,GAAD,CAEI5U,MAAO4U,EAAK5U,MACZ/F,IAAK2a,EAAK3a,IACV6I,YAAa,aACb4Q,WAAYA,EACZL,SAAUA,EACVlT,IAAK,SAAClI,GAAuBuc,EAASrP,QAAQyP,EAAK5U,OAAS/H,IANvD2c,EAAK5U,YCzGnB,SAAS0V,GAAW5e,GAC/B,IAAQuc,EAAiCvc,EAAjCuc,SAAUY,EAAuBnd,EAAvBmd,QAAS0B,EAAc7e,EAAd6e,UACrB3jB,EArBQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxDkkB,WAAY,CACRld,QAAS2a,EAASwC,eAAiB,QAAU,OAC7ChiB,SAAU,QACVwN,OAAQ,OACRC,MAAO+R,EAASyC,UAAY,0BAA4B,yBACxDlkB,MAAO,OACPma,UAAW,SACX6H,gBAAiB,qBACjBtI,aAAc,UAYF7Z,CAAU4hB,EAAV5hB,GAEhB,OACI,qBAAKY,UAAWL,EAAQ4jB,WAAxB,mBACQ3B,EAAU,EADlB,cACyB0B,KCxBjC,IAAMlkB,GAAYC,YAAW,CACzB0iB,OAAQ,CACJ1b,QAAS,OACTwB,cAAe,MACfvB,eAAgB,SAChBG,OAAQ,SACRlH,MAAO,OACPwH,OAAQ,WAID,SAAS2c,GAAYjf,GAChC,IACIkd,EACAld,EADAkd,MAAOX,EACPvc,EADOuc,SAAUK,EACjB5c,EADiB4c,WAAYO,EAC7Bnd,EAD6Bmd,QAASE,EACtCrd,EADsCqd,YAAaD,EACnDpd,EADmDod,YAGjDliB,EAAUP,KAEV8iB,EAAUtP,iBAAuB,MAEvC,SAASwP,IACDR,EAAUD,EAAMne,OAAS,EACzB6d,EAAWO,EAAU,GACdZ,EAASwB,kBAChBV,IAIR,SAASW,IACDb,EAAU,EACVP,EAAWO,EAAU,GAErBC,IAIR,SAAS8B,IACuB,cAAxB3C,EAASC,WACTwB,IAC+B,cAAxBzB,EAASC,YAChBmB,IAIR,SAASwB,IACuB,cAAxB5C,EAASC,WACTmB,IAC+B,cAAxBpB,EAASC,YAChBwB,IAIR,SAASoB,EAAgBje,GACrB,OAAQA,EAAE1C,MACN,IAAK,QACD0C,EAAEiK,iBACFuS,IACA,MACJ,IAAK,aACDwB,IACA,MACJ,IAAK,YACDD,KAOZ,SAASX,EAAapd,GACdA,EAAEqd,QAAU7gB,OAAOuS,WAAa,EAChCiP,IAEAD,IAcR,OAVA3Z,qBAAU,WAAO,IAAD,EAIZ,OAHAiG,SAASC,iBAAiB,UAAW2T,GACrC,UAAA3B,EAAQpP,eAAR,SAAiB5C,iBAAiB,QAAS8S,GAEpC,WAAO,IAAD,EACT/S,SAASK,oBAAoB,UAAWuT,GACxC,UAAA3B,EAAQpP,eAAR,SAAiBxC,oBAAoB,QAAS0S,MAEnD,CAACd,EAASN,EAASZ,EAASC,aAG3B,qBAAKnT,IAAKoU,EAASliB,UAAWL,EAAQoiB,OAAtC,SACI,cAAC,GAAD,CAEIpU,MAAOiU,EACPnR,YAAa,aACb7I,IAAK+Z,EAAMC,GAASha,IACpByZ,WAAYA,EACZL,SAAUA,GALLY,KC3FrB,IAmDekC,GAvBIvlB,IAAMoT,YAAW,SAAClN,EAAeqJ,GAChD,IACIiW,EACAtf,EADAsf,UAAWC,EACXvf,EADWuf,UAAWrW,EACtBlJ,EADsBkJ,MAGpBhO,EAjCQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxDkS,MAAO,CACHlL,QAAS,QACTQ,aAAc,EACdtH,MAAO,OACPkS,UAAW,OACX1K,OAAQ,OACRxC,UAAW,OACX2c,UAAW,WAEfqB,KAAM,CACFlc,QAAS,OACTwB,cAAuC,cAAxBmZ,EAASC,WAA6B,MAAQ,cAC7D3a,eAAgB,SAChBG,OAAQ,SACRlH,MAAO,OACPwH,OAAQ,OACRib,UAAW,YAgBC5iB,CAFZqF,EAD6Buc,SAGjB5hB,GAEhB,OACI,sBAAK0O,IAAKA,EAAK9N,UAAWL,EAAQ4iB,KAAlC,UACI,qBACIviB,UAAWL,EAAQ4R,MACnB3J,IAAKmc,EACLpc,IAAG,gBAAWgG,KAElB,qBACI3N,UAAWL,EAAQ4R,MACnB3J,IAAKoc,EACLrc,IAAG,gBAAWgG,EAAQ,WC3BvB,SAASsW,GAAiBxf,GACrC,IACIkd,EACAld,EADAkd,MAAOX,EACPvc,EADOuc,SAAUK,EACjB5c,EADiB4c,WAAYO,EAC7Bnd,EAD6Bmd,QAASE,EACtCrd,EADsCqd,YAAaD,EACnDpd,EADmDod,YAGjDliB,EApBQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxD6kB,QAAS,CACL7d,QAAS,QAEb0b,OAAQ,CACJ1b,QAAS,OACTwB,cAAwC,cAAxBmZ,EAASC,WAA8B,MAAQ,cAC/D3a,eAAgB,SAChBG,OAAQ,SACRlH,MAAO,OACPwH,OAAQ,OACRib,UAAW,YASC5iB,CAAU4hB,EAAV5hB,GAEV8iB,EAAUtP,iBAAuB,MACjCuP,EAAWvP,iBAA2B,IAEtCuR,EAAiBvR,iBAAe,GAChCwR,EAAaxR,iBAAkBpF,MAAMmU,EAAMne,QAAQ6gB,MAAK,IAoE9D,SAASjC,IACL,GAAIR,EAAUD,EAAMne,OAAS,EAAG,CAC5B,IAAM8gB,EAAc1C,EAAUuC,EAAerR,QAC7CuO,EAAYiD,GAAe3C,EAAMne,OAAUme,EAAMne,OAAS,EAAI8gB,QACvDtD,EAASwB,kBAChBV,IAIR,SAASW,IACL,GAAIb,EAAU,EAAG,CACb,IAAM0C,EAAc1C,EA1B5B,WACI,IAAK,IAAI/d,EAAI,EAAGA,GAAK,EAAGA,IACpB,GAAI+d,EAAU/d,EAAI,GAAKse,EAASrP,QAAQ8O,EAAU/d,IAC1CugB,EAAWtR,QAAQ8O,EAAU/d,GAAI,CACjC,IAAM0gB,EAAUpC,EAASrP,QAAQ8O,EAAU/d,GAE3C,GADoB0gB,EAAQxd,OAASwd,EAAQhlB,MAC3B,EACd,OAAO,EAKvB,OAAO,EAc2BilB,GAC9BnD,EAAYiD,EAAc,EAAK,EAAIA,QAEnCzC,IAIR,SAAS8B,IACuB,cAAxB3C,EAASC,WACTwB,IAEAL,IAIR,SAASwB,IACuB,cAAxB5C,EAASC,WACTmB,IAEAK,IAIR,SAASoB,EAAgBje,GACrB,OAAQA,EAAE1C,MACN,IAAK,QACD0C,EAAEiK,iBACFuS,IACA,MACJ,IAAK,aACDwB,IACA,MACJ,IAAK,YACDD,KAOZ,SAASX,EAAapd,GACdA,EAAEqd,QAAU7gB,OAAOuS,WAAa,EAChCiP,IAEAD,IA+BR,OArBA3Z,qBAAU,WAAO,IAAD,EACNya,EAAeC,aAAY,cACT9C,IAAYD,EAAMne,OAAS,IAC3B4gB,EAAWtR,QAAQ8O,IAAYwC,EAAWtR,QAAQ8O,EAAU,IACzEwC,EAAWtR,QAAQ8O,OAvIlC,WAEI,GADAuC,EAAerR,QAAU,EACrB8O,EAAUD,EAAMne,QAAU2e,EAASrP,QAAQ8O,IACvCwC,EAAWtR,QAAQ8O,GAAU,CAC7BuC,EAAerR,QAAU,EACzB,IAAMyR,EAAUpC,EAASrP,QAAQ8O,GAEjC,GADoB2C,EAAQxd,OAASwd,EAAQhlB,MAC3B,EACd,OAIZ,GAAIqiB,EAAU,EAAID,EAAMne,QAAU2e,EAASrP,QAAQ8O,EAAU,IACrDwC,EAAWtR,QAAQ8O,EAAU,GAAI,CACjC,IAAM2C,EAAUpC,EAASrP,QAAQ8O,EAAU,GAE3C,GADoB2C,EAAQxd,OAASwd,EAAQhlB,MAC3B,EACd,OAEJ4kB,EAAerR,QAAU,GAqHzB6R,GA/GuB,IAA3BR,EAAerR,QACf0I,IAASC,OACL,cAAC,GAAD,CAEI9N,MAAOiU,EACPmC,UAAWpC,EAAMC,GAASha,IAC1Boc,UAAWrC,EAAMC,EAAU,GAAGha,IAC9BoZ,SAAUA,GAJLY,GAMT3R,SAASG,eAAe,YAG5BoL,IAASC,OACL,cAAC,GAAD,CAEI9N,MAAOiU,EACPha,IAAiC,IAA3Buc,EAAerR,QAAiB6O,EAAMC,GAASha,IAAM,GAC3D6I,YAAa,aACb4Q,WAAYA,EACZL,SAAUA,GALLY,GAOT3R,SAASG,eAAe,YA4FxBwU,cAAcH,MAEnB,IAKH,OAHAxU,SAASC,iBAAiB,UAAW2T,GACrC,UAAA3B,EAAQpP,eAAR,SAAiB5C,iBAAiB,QAAS8S,GAEpC,WAAO,IAAD,EACT4B,cAAcH,GACdxU,SAASK,oBAAoB,UAAWuT,GACxC,UAAA3B,EAAQpP,eAAR,SAAiBxC,oBAAoB,QAAS0S,MAEnD,CAACd,EAASN,EAASZ,EAASC,aAG3B,sBAAKnT,IAAKoU,EAAV,UACI,qBAAK/a,GAAG,UAAUnH,UAAWL,EAAQukB,QAArC,SAEQvC,EAAMrc,KAAI,SAACid,GAAD,OACN,qBACIzU,IAAK,SAAClI,GAAyBuc,EAASrP,QAAQyP,EAAK5U,OAAS/H,GAE9DgC,IAAK2a,EAAK3a,IACVid,QApCClX,EAoCuB4U,EAAK5U,MAnC1C,WACHyW,EAAWtR,QAAQnF,IAAS,IAmCZhG,IAAG,UAAK4a,EAAK5U,QALjB,UAEY4U,EAAK5U,QAlCrC,IAAyBA,OA0CjB,qBAAKxG,GAAG,UAAUnH,UAAWL,EAAQoiB,YCrMjD,IAAM3iB,GAAYC,YAAW,CACzB0iB,OAAQ,CACJ1b,QAAS,OACTwB,cAAe,SACfvB,eAAgB,SAChBG,OAAQ,SACRlH,MAAO,UAIA,SAASulB,GAAergB,GACnC,IACIkd,EACAld,EADAkd,MAAOX,EACPvc,EADOuc,SAAUK,EACjB5c,EADiB4c,WAAYO,EAC7Bnd,EAD6Bmd,QAASxL,EACtC3R,EADsC2R,QAAS0L,EAC/Crd,EAD+Cqd,YAAaD,EAC5Dpd,EAD4Dod,YAG1DliB,EAAUP,KAEV8iB,EAAUtP,iBAAuB,MACjCuP,EAAWvP,iBAAyB,IAM1C,SAASwP,IAC4B,IAAD,EAA5BR,EAAUD,EAAMne,OAAS,GACzB,UAAA2e,EAASrP,QAAQ8O,EAAU,UAA3B,SAA+BS,iBAC/BhB,GAAW,SAACkB,GAAD,OAAUA,EAAO,MACrBvB,EAASwB,kBAChBV,IAIR,SAASW,IACL,GAAIb,EAAU,EAAG,CACb,IAC4C,EAErC,EAHD7O,EAAOoP,EAASrP,QAAQ8O,GAAS5O,wBACvC,GAAID,EAAKE,EAAI,GAAKF,EAAKE,EAAIF,EAAKhM,OAAS,EACrC,UAAAob,EAASrP,QAAQ8O,UAAjB,SAA2BS,sBAE3B,UAAAF,EAASrP,QAAQ8O,EAAU,UAA3B,SAA+BS,iBAC/BhB,EAAWO,EAAU,QAEN,IAAZA,GACPC,IAIR,SAASgC,EAAgBje,GACrB,OAAQA,EAAE1C,MACN,IAAK,QACD0C,EAAEiK,iBACFuS,IACA,MACJ,IAAK,aACDA,IACA,MACJ,IAAK,YACDK,KAOZ,SAASO,EAAapd,GACdA,EAAEqd,QAAU7gB,OAAOuS,WAAa,EAChCyN,IAEAK,IAhDRzY,qBAAU,WACNmY,EAASrP,QAAUqP,EAASrP,QAAQ4D,MAAM,EAAGiL,EAAMne,UACpD,CAACme,EAAMne,SAkDV,IAAM0f,EAAyB,WACtB9gB,OAAO8Q,YAAc9Q,OAAO2iB,SAAY9U,SAASqL,KAAK0J,cACvDlD,KA2BR,OAvBA9X,qBAAU,WAAO,IAAD,EAKZ,OAJIgX,EAASwB,kBAAoBvS,SAASC,iBAAiB,SAAUgT,GACrEjT,SAASC,iBAAiB,UAAW2T,GAAiB,GACtD,UAAA3B,EAAQpP,eAAR,SAAiB5C,iBAAiB,QAAS8S,GAEpC,WAAO,IAAD,EACT/S,SAASK,oBAAoB,SAAU4S,GACvCjT,SAASK,oBAAoB,UAAWuT,GACxC,UAAA3B,EAAQpP,eAAR,SAAiBxC,oBAAoB,QAAS0S,MAEnD,CAACd,EAASN,IAEb5X,qBAAU,WAEN,IAAIib,EAAe7O,EAAqB8O,aACpCD,EAActD,EAAMne,OAAS,IAC7ByhB,EAActD,EAAMne,OAAS,GAE7ByhB,GAAe,GACf9C,EAASrP,QAAQmS,GAAa5C,mBAEnC,CAACF,EAASrP,QAAQtP,SAGjB,qBAAKsK,IAAKoU,EAASliB,UAAWL,EAAQoiB,OAAtC,SAEQJ,EAAMrc,KAAI,SAACid,GAAD,OACN,cAAC,GAAD,CAEI5U,MAAO4U,EAAK5U,MACZ/F,IAAK2a,EAAK3a,IACV6I,YAAa,aACb4Q,WAAYA,EACZL,SAAUA,EACVlT,IAAK,SAAClI,GAAuBuc,EAASrP,QAAQyP,EAAK5U,OAAS/H,IANvD2c,EAAK5U,Y,qJCoBrBwX,GAAwB,iBAAO,CACxC1B,WAAW,EACXD,gBAAgB,EAChB4B,kBAAkB,EAClB5C,kBAAkB,EAClBvB,WAAY,sBAWD,SAASoE,GAAa5gB,GACjC,IAAQhG,EAAU6C,qBAAWhD,GAArBG,MAEF6mB,EAAUC,cAGZvE,EACAvc,EADAuc,SAAUwE,EACV/gB,EADU+gB,YAAa5T,EACvBnN,EADuBmN,MAAOwE,EAC9B3R,EAD8B2R,QAASwL,EACvCnd,EADuCmd,QAG3C,EAAoCvgB,mBAAkB2f,EAASyC,WAA/D,mBAAOhkB,EAAP,KAAmBC,EAAnB,KACA,EAA4C2B,oBAAS,GAArD,mBAAOokB,EAAP,KAAuBC,EAAvB,KACA,EAA0CrkB,mBAAS,GAAnD,mBAAOskB,EAAP,KAAsBC,EAAtB,KACA,EAAwDvkB,oBAAS,GAAjE,mBAAOwkB,EAAP,KAA6BC,EAA7B,KAEMnmB,EAxIQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CAExD0mB,iBAAkB,CACd1f,QAAS,QAEb2f,cAAe,CACX3f,QAAS,QAGbtF,KAAM,CACFS,SAAUwf,EAASyC,UAAY,SAAW,QAC1CpS,IAAK,EACLuH,KAAM,EACNrZ,MAAO,QACPwH,OAAQ,QACR+R,UAAW,OACXyI,gBAAiB,UAEjB,WAAY,CACRA,gBAAiB,UACjBlb,QAAS,OACTE,WAAY,SACZkL,UAAW,OACX6H,YAAa,OACbC,aAAc,OAEd0M,WAAY,eAEZ,WAAY,CACRjlB,SAAU,EACVklB,WAAY,GAGhB,wBAAyB,CACrBhlB,YAAa,QAGjB,wBAAyB,CACrBA,YAAa,SAGjB,OAAQ,CACJyF,SAAU,UACV3F,SAAU,IAGlB,OAAQ,CACJyF,OAAQ,SACRM,OAAQ,MACR8S,OAAQ,IACR0H,gBAAiB,oBAIzB4E,WAAY,CACR1f,OAAQ,SAER,wBAAyB,CACrBiT,UAAW,SACXrT,QAAS,QACToT,UAAW,QAGf,wBAAyB,CACrBpT,QAAS,OACT+f,oBAAqB,UACrBC,kBAAmB,cACnBC,cAAe,MACf7f,OAAQ,SAER,MAAO,CACHzF,SAAU,EACVR,eAAgB,OAEhB,WAAY,CACRjB,MAAO,OACP8F,QAAS,UACTkhB,cAAe,WAM/BC,mBAAoB,GAEpBC,wBAAyB,CACrB,SAAU,CACNrN,WAAY,SAIpBsN,iBAAkB,CACdllB,SAAU,QACV6P,IAAK,GACLuH,KAAM,GACN7R,OAAQ,OACRxH,MAAO,OACP0Z,aAAc,EACdsI,gBAAiB,QAEjB,UAAW,CACPA,gBAAiB,YAmCTniB,CAAU4hB,EAAV5hB,GAEVunB,EAAkB,SAAC1kB,EAAalD,GAAd,OAA6BymB,EAAY,6BAAKxE,GAAN,mBAAiB/e,EAAMlD,MAEjF6nB,EAAe,WACjB,IAAMC,EAAmBzkB,OAAO0kB,YAE5B3L,KAAK4L,IAAIF,EAAmBlB,GAAiB,KAC7CD,EAAkBmB,EAAmBlB,GACrCC,EAAiBiB,KAoBzB,OAhBA7c,qBAAU,WACN5H,OAAO8N,iBAAiB,SAAU0W,GAElC,IAAMI,EAAS/W,SAAS0L,cAAc,SAChCsL,EAAgBhX,SAAS0L,cAAc,qBAK7C,OAHAqL,EAAOE,UAAUC,IAAIxnB,EAAQqmB,eAC7BiB,EAAcC,UAAUC,IAAIxnB,EAAQomB,kBAE7B,WACHiB,EAAOE,UAAUE,OAAOznB,EAAQqmB,eAChCiB,EAAcC,UAAUE,OAAOznB,EAAQomB,kBACvC3jB,OAAOkO,oBAAoB,SAAUsW,MAE1C,CAACA,IAGA,qCACI,cAAClM,GAAA,EAAD,CACIC,UAAU,QACV0M,GAAI5nB,EACJ6nB,QAAS,IACTC,QAAQ,EACRC,cAAY,EACZC,eAAa,EANjB,SAQI,sBAAKznB,UAAWL,EAAQoB,KAAxB,UACI,mCACI,cAACW,EAAA,EAAD,CACIC,KAAK,QACLpB,MAAM,UACNqB,aAAW,OACXC,eAAa,EACb3B,QAAS,kBAAMolB,EAAQ/b,KAAR,iBAAuBqI,EAAMzK,MALhD,SAOI,cAAC,KAAD,MAEJ,cAACrF,EAAA,EAAD,CAAYC,QAAQ,KAApB,SACKtD,KAEHuiB,EAASyC,WAEP,cAAC/hB,EAAA,EAAD,CACIC,KAAK,QACLpB,MAAM,UACNqB,aAAW,OACXC,eAAa,EACb3B,QAAS,kBAAMR,GAAc,IALjC,SAOI,cAAC,KAAD,SAIZ,eAACe,EAAA,EAAD,CAAUinB,mBAAmB,MAAM1nB,UAAWL,EAAQ8mB,wBAAtD,UACI,cAAC7lB,EAAA,EAAD,CAAcC,QAAQ,oBACtB,cAAC2E,GAAA,EAAD,UACI,eAAC9D,EAAA,EAAD,CACIC,KAAK,QACLpB,MAAM,UACNqB,aAAW,OACXC,eAAa,EACb8lB,oBAAkB,EAClBznB,QAAS,kBAAM4lB,GAAyBD,IAN5C,UAQKA,GAAwB,cAAC,KAAD,KACvBA,GAAwB,cAAC,KAAD,YAItC,cAAC+B,GAAA,EAAD,CAAUP,GAAIxB,EAAsByB,QAAQ,OAAOG,eAAa,EAAhE,SACI,eAACrnB,EAAA,EAAD,WACI,eAACK,EAAA,EAAD,WACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,sBACtB,cAAC2E,GAAA,EAAD,UACI,cAACC,EAAA,EAAD,CACI9D,KAAK,MACL+D,QAASsb,EAASyC,UAClB9d,SAAU,SAACC,GAAD,OAAO+gB,EAAgB,YAAa/gB,EAAEE,OAAOJ,iBAInE,eAACjF,EAAA,EAAD,WACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,qBACtB,cAAC2E,GAAA,EAAD,UACI,cAACC,EAAA,EAAD,CACI9D,KAAK,MACL+D,QAASsb,EAASwC,eAClB7d,SAAU,SAACC,GAAD,OAAO+gB,EAAgB,iBAAkB/gB,EAAEE,OAAOJ,iBAIxE,eAACjF,EAAA,EAAD,WACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,gCACtB,cAAC2E,GAAA,EAAD,UACI,cAACC,EAAA,EAAD,CACI9D,KAAK,MACL+D,QAASsb,EAASwB,iBAClB7c,SAAU,SAACC,GAAD,OAAO+gB,EAAgB,mBAAoB/gB,EAAEE,OAAOJ,iBAI1E,eAACjF,EAAA,EAAD,WACI,cAACG,EAAA,EAAD,CAAcC,QAAQ,gBACtB,eAACgnB,GAAA,EAAD,CACI9oB,MAAOiiB,EAASC,WAChBtb,SAAU,SAACC,GAAD,OAAO+gB,EAAgB,aAAc/gB,EAAEE,OAAO/G,QAF5D,UAII,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,YAAhB,+BAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,YAAhB,+BAQA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,YAAhB,+BAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,YAAhB,+BAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,UAAhB,qBAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,oBAAhB,gCAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,yBAAhB,8BAIA,cAAC0Y,GAAA,EAAD,CAAU1Y,MAAM,yBAAhB,yCAQhB,uBACA,sBAAKiB,UAAWL,EAAQwmB,WAAxB,UACI,qDAEK,IACAvE,EAAU,EACV,IAJL,KAMK,IACAxL,EAAQkN,aAEb,sBAAKtjB,UAAWL,EAAQ6mB,mBAAxB,UACKpQ,EAAQzI,MAAQ,GAEb,cAAC,IAAD,CACIrN,MAAO,CAAEwnB,SAAU,QACnBznB,GAAE,iBAAYuR,EAAMzK,GAAlB,oBAAgCiP,EAAQzI,MAAQ,GAFtD,SAII,eAACxH,EAAA,EAAD,CACIpE,QAAQ,WACRgmB,UAAW,cAAC,KAAD,IAFf,oBAKK,IACA3R,EAAQzI,MAAQ,OAI5ByI,EAAQzI,MAAQyI,EAAQ4R,cAErB,cAAC,IAAD,CACI1nB,MAAO,CAAEwnB,SAAU,QACnBznB,GAAE,iBAAYuR,EAAMzK,GAAlB,oBAAgCiP,EAAQzI,MAAQ,GAFtD,SAII,eAACxH,EAAA,EAAD,CACIpE,QAAQ,WACRkmB,QAAS,cAAC,KAAD,IAFb,oBAKK,IACA7R,EAAQzI,MAAQ,kBAQ7C,cAACua,GAAA,EAAD,CAAMb,IAAK5nB,EAAX,SACI,cAAC0oB,GAAA,EAAD,CAAMd,IAAK5B,EAAX,SACI,cAAC/jB,EAAA,EAAD,CACI1B,UAAWL,EAAQ+mB,iBACnB/kB,KAAK,QACLpB,MAAM,UACNqB,aAAW,OACXC,eAAa,EACb8lB,oBAAkB,EAClBznB,QAAS,kBAAMR,GAAc,IAPjC,SASI,cAAC,KAAD,aC5WxB,IAoCM0oB,GAAiB,iBAAO,CAAE9E,WAAY,EAAG3V,OAAQ,EAAGqa,aAAc,IAEzD,SAASK,KACpB,MAAgC3lB,EAAiC,iBAAkByiB,IAAnF,mBAAOnE,EAAP,KAAiBwE,EAAjB,KAEM7lB,EAzCQ,SAACqhB,GAAD,OAA+B3hB,YAAW,CACxD0B,KAAM,CACFxB,MAAOyhB,EAASyC,UAAY,sBAAwB,SAGxDpY,QAAS,CACL5E,OAAQ,eAmCIrH,CAAU4hB,EAAV5hB,GACVkmB,EAAUC,cAEhB,EAAwB7iB,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEA,EAAkC8N,cAA1BqI,EAAR,EAAQA,aAAc3G,EAAtB,EAAsBA,QACtB,EAA0B1V,mBAA8B,CAAE8F,IAAK4P,EAAStY,MAAO,GAAIoT,aAAc,KAAjG,mBAAOD,EAAP,KAAc0K,EAAd,KACA,EAA8Bjb,mBAZJ,CAAEiiB,WAAY,EAAG3V,OAAQ,EAAGqa,aAAc,IAYpE,mBAAO5R,EAAP,KAAgBkS,EAAhB,KACA,EAA8BjnB,mBAAiB,GAA/C,mBAAOugB,EAAP,KAAgBP,EAAhB,KACA,EAAkC/f,qBAAWsI,GAArC5K,EAAR,EAAQA,YAAaN,EAArB,EAAqBA,SAuErB,GArEAsL,qBAAU,WAEN,IAAMue,EAAgBpkB,GAAY6c,GAC5BwH,ED4D8B,CACxC/E,WAAW,EACXD,gBAAgB,EAChB4B,kBAAkB,EAClB5C,kBAAkB,EAClBvB,WAAY,qBChEJwH,GAAuB,EA2B3B,OA1BAxf,OAAOyf,KAAKF,GAAiBlf,SAAQ,SAACrH,GAClC,IAAM0mB,EAAQ1mB,OACUyH,IAApBsX,EAAS2H,KACTJ,EAAcI,GAASH,EAAgBG,GACvCF,GAAuB,MAG3BA,GAAwBjD,EAAY+C,GAGxCvpB,EACI,CACIF,QAAQ,EACRC,MACI,cAACsmB,GAAD,CACIrE,SAAUA,EACVwE,YAAaA,EACb5T,MAAOA,EACPwE,QAASA,EACTwL,QAASA,MAOlB,kBAAM5iB,EAAY,CAAEF,QAAQ,EAAOC,MAAO,6BAClD,CAAC6S,EAAOwE,EAAS4K,EAAUY,EAASlE,IAEvC1T,qBAAU,WACNtL,EAAS,UACT6J,GAAO0B,IAAP,wBAA4B8M,EAA5B,MACK7M,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHuT,EAASvT,GACTrK,EAASqK,EAAKtK,YAEvB,CAACif,IAEJ1T,qBAAU,WACNse,EAAWF,IACX7f,GAAO0B,IAAP,wBAA4B8M,EAA5B,oBAA+C2G,IAC1CxT,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHuf,EAAWvf,GACXsY,EAAWtY,EAAKmc,mBAEzB,CAACxH,IAEJ1T,qBAAU,WACN,IAAiB,IAAb4X,EAAgB,CAChB,IAAMxU,EAAW,IAAIpE,SACrBoE,EAASC,OAAO,eAAgBuU,EAAQ3T,YACxC1F,GAAO8G,MAAP,wBAA8BuC,EAAMzK,GAApC,oBAAkDiP,EAAQzI,OAASP,GAGvE,GAAIwU,IAAYxL,EAAQkN,UAAY,EAAG,CACnC,IAAMsF,EAAe,IAAI5f,SACzB4f,EAAavb,OAAO,OAAQ,QAC5B9E,GAAO8G,MAAP,wBAA8BuC,EAAMzK,GAApC,oBAAkDiP,EAAQzI,OAASib,MAExE,CAAChH,KAGuB,IAAvBxL,EAAQkN,UACR,OACI,qBAAKtjB,UAAWL,EAAQ0L,QAAxB,SACI,cAACI,GAAA,EAAD,CAAkBC,UAAW,MAKzC,IA9FWmd,EA+GLlH,GA/GKkH,EA+GSzS,EAAQkN,UA/GJ9V,MAAMN,KAAK,CAAE1J,OAAQqlB,IAAK,SAAC9pB,EAAOkD,GAAR,OAAgBA,MA+G3BqD,KAAI,SAACqI,GAAD,MAAY,CACnDA,QACA/F,IAAI,GAAD,OAAKL,EAAL,yBAAmCwP,EAAnC,oBAAsD2G,EAAtD,iBAA2E/P,OAG5Emb,EA7IiB,SAAC7H,GACxB,OAAQA,GACJ,IAAK,oBACL,IAAK,UACD,OAAO8H,GAEX,IAAK,iBACL,IAAK,YACL,IAAK,YACD,OAAOC,GAEX,IAAK,iBACL,IAAK,YACL,IAAK,YACD,OAAO/E,GAEX,IAAK,yBACL,IAAK,yBACD,OAAOvC,GACX,QACI,OAAOqH,IAyHSE,CAAmBjI,EAASC,YAEpD,OACI,sBAAKjhB,UAAWL,EAAQoB,KAAxB,UACI,cAACsiB,GAAD,CACIrC,SAAUA,EACVY,QAASA,EACT0B,UAAWlN,EAAQkN,YAEvB,cAACwF,EAAD,CACInH,MAAOA,EACP2B,UAAWlN,EAAQkN,UACnBjC,WAAYA,EACZO,QAASA,EACTZ,SAAUA,EACVpP,MAAOA,EACPwE,QAASA,EACT0L,YAvCQ,WAChB,GAAI1L,EAAQzI,MAAQyI,EAAQ4R,aAAc,CACtC,IAAM5a,EAAW,IAAIpE,SACrBoE,EAASC,OAAO,eAAhB,UAAmC+I,EAAQkN,UAAY,IACvDlW,EAASC,OAAO,OAAQ,QACxB9E,GAAO8G,MAAP,wBAA8BuC,EAAMzK,GAApC,oBAAkDiP,EAAQzI,OAASP,GAEnEkY,EAAQ/b,KAAR,iBAAuBqI,EAAMzK,GAA7B,oBAA2CiP,EAAQzI,MAAQ,MAiCvDkU,YA7BQ,WACZzL,EAAQzI,MAAQ,GAChB2X,EAAQ/b,KAAR,iBAAuBqI,EAAMzK,GAA7B,oBAA2CiP,EAAQzI,MAAQ,UCtJvE,IAAMvO,GAAYC,YAAW,CACzB0B,KAAM,CACFxB,MAAO,qBACPwH,OAAQ,sBAGZsE,QAAS,CACL5E,OAAQ,aAGZyiB,MAAO,CACHjkB,SAAU,OACVV,UAAW,UAIb4kB,GAAiB,iBAAO,CAAEC,QAAS,GAAIzb,OAAQ,EAAG0b,aAAc,IAEvD,SAASC,KACpB,IAAM3pB,EAAUP,KAEhB,EAAkCiW,cAA1BkU,EAAR,EAAQA,aAAclL,EAAtB,EAAsBA,QACtB,EAA8Bhd,mBANJ,CAAE+nB,QAAS,GAAIzb,OAAQ,EAAG0b,aAAc,IAMlE,mBAAOlL,EAAP,KAAgBqL,EAAhB,KACA,EAAsCnoB,qBAAtC,mBAAOooB,EAAP,KAAoBC,EAApB,KACQhrB,EAAa4C,qBAAWsI,GAAxBlL,SAsBR,OApBAsL,qBAAU,WACNtL,EAAS,UACT6J,GAAO0B,IAAP,8BAAkCoU,EAAlC,MACKnU,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHrK,EAASqK,EAAKtK,YAEvB,CAAC8qB,IAEJvf,qBAAU,WACNwf,EAAWL,IACX5gB,GAAO0B,IAAP,8BAAkCoU,EAAlC,oBAAqDkL,IAChDrf,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GACHygB,EAAWzgB,GACX2gB,EAAe3gB,EAAKqgB,cAE7B,CAACG,IAGoB,KAApBpL,EAAQiL,QAEJ,qBAAKppB,UAAWL,EAAQ0L,QAAxB,SACI,cAACI,GAAA,EAAD,CAAkBC,UAAW,MAMrC,qBAAK1L,UAAWL,EAAQoB,KAAxB,SAEI,uBAAOf,UAAWL,EAAQupB,MAAOS,UAAQ,EAAzC,SACI,wBAAQ/hB,IAAK6hB,QCvD7B,IAAMrqB,GAAYC,aAAW,SAACyB,GAAD,MAAY,CACrCC,KAAM,CACFsF,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZlB,QAAS,IAEbmB,OAAQ,CACJH,QAAS,eACTI,OAAQ,QACRC,UAAW,cAEfjI,MAAO,CACHkI,SAAU,IAEdC,IAAK,CACDC,aAAc,IAElBC,KAAM,CACFvH,MAAOuB,EAAMK,QAAQ,GACrB4F,OAAQjG,EAAMK,QAAQ,GACtB6F,KAAM,WACN9F,YAAa,QASN,SAAS+d,GAAcxa,GAClC,MAKIA,EAJAya,UACI/b,EAFR,EAEQA,KAAMoC,EAFd,EAEcA,KAAM4Z,EAFpB,EAEoBA,YAAaC,EAFjC,EAEiCA,UAAWC,EAF5C,EAE4CA,UAAWC,EAFvD,EAEuDA,SAAUC,EAFjE,EAEiEA,QAASnY,EAF1E,EAE0EA,QAEtEoY,EACA/a,EADA+a,cAEJ,EAA4Cne,oBACxC,WACI,OAAIie,EAAmB,WACnBD,EAAoB,SAChBD,EAAY,YAAc,aAJ1C,mBAAOK,EAAP,KAAuBC,EAAvB,KAQA,EAAwBhd,EAAwB,gBAAiB,IAA1D6E,EAAP,oBAEM5H,EAAUP,KACVugB,EAAqB,QAATpa,EAAiB,MAAQA,EAAKqa,cAoBhD,SAASC,IACLH,EAAkB,gBAClBnX,GAAO0B,IAAP,4CAAgDsV,IAC3CrV,MAAK,WAEFsV,OAIZ,SAAS1F,IACL,OAAQ2F,GACJ,IAAK,UA5BTC,EAAkB,cAClBnX,GAAO0B,IAAP,0CAA8CsV,IACzCrV,MAAK,WACFwV,EAAkB,aAClBF,OA0BA,MACJ,IAAK,SAtBTE,EAAkB,YAClBnX,GAAO0B,IAAP,yCAA6CsV,IACxCrV,MAAK,WACFwV,EAAkB,aAClBF,OAoBA,MACJ,IAAK,WACDK,IACAnE,YAAW,kBAAMtZ,OAAO6F,SAAS6X,WAAU,KAC3C,MACJ,IAAK,YACDD,KAOZ,OACI,cAACrY,GAAA,EAAD,UACI,eAACC,GAAA,EAAD,CAAazH,UAAWL,EAAQoB,KAAhC,UACI,sBAAKT,MAAO,CAAE+F,QAAS,QAAvB,UACI,cAACqB,GAAA,EAAD,CACI3F,QAAQ,UACR/B,UAAWL,EAAQmH,KACnBa,IAAKxE,EACLyE,IAAKL,EAAgBH,IAEzB,sBAAK9G,MAAO,CAAE+F,QAAS,OAAQwB,cAAe,UAA9C,UACI,cAAC/F,EAAA,EAAD,CAAYC,QAAQ,KAAK+F,UAAU,KAAnC,SACK3E,IAEL,eAACrB,EAAA,EAAD,CAAYC,QAAQ,UAAUsE,QAAQ,QAAQ0B,cAAY,EAA1D,UACK4X,EACA,IACAR,WAKb,cAAChZ,EAAA,EAAD,CACIpE,QAAQ,WACRzB,MAAO,CAAEC,MAA0B,aAAnBkf,EAAgC,MAAQ,WACxDvf,QAAS,kBAAM4Z,KAHnB,SAKK2F,SC/HrB,IAAM7a,GAAqB,GAiCZ,SAASglB,KACpB,MAAgCtoB,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAClB,EAAoC8D,EAA0B,sBALxD,GAAN,mB5C4BO,CAEH,O4C9BJ,CAA2B,SAK3B,mBAAOgC,EAAP,KAAmBC,EAAnB,KAEAqF,qBAAU,WACNtL,EAAS,cACTE,EACI,cAAC4F,GAAD,CACIE,WAAYA,EACZC,cAAeA,EACfC,SAAUA,QAGnB,CAACF,IAEJ,MAA0CrD,mBAAuB,IAAjE,mBAAO2e,EAAP,KAAsBC,EAAtB,KACA,EAAoC5e,mBAAc,IAAlD,mBAAO6e,EAAP,KAAmBC,EAAnB,KAEA,EAAsD9e,mBAAS,GAA/D,mBAAOwL,EAAP,KAA4BC,EAA5B,KAgBA,GAbA9C,qBAAU,WACNzB,GAAO0B,IAAI,gCACNC,MAAK,SAACC,GAAD,OAAcA,EAASpB,QAC5BmB,MAAK,SAACnB,GAAD,OAAUkX,EAAiBlX,QACtC,CAAC8D,IAEJ7C,qBAAU,WACN,GAAIgW,EAAcxc,OAAS,EAAG,CAC1B,IAAM4c,EA5DlB,SAAyBF,GACrBtb,GAASpB,OAAS,EAClB,IAAMI,EAAS,CAAEwb,UAAW,GAAI,kBAAmB,IAsBnD,OArBAc,EAAW1W,MAAK,SAACzF,EAAGC,GAAJ,OAAYD,EAAEsc,QAAUrc,EAAEqc,QAAW,GAAK,KAE1DH,EAAW5W,SAAQ,SAAC4V,QACexV,IAA3B9F,EAAOsb,EAAU3Z,QACjB3B,EAAOsb,EAAU3Z,MAAQ,GACF,QAAnB2Z,EAAU3Z,MAAkBX,GAAS2E,KAAK2V,EAAU3Z,OAExD2Z,EAAUE,UACNF,EAAUG,UACVzb,EAAO,mBAAmB2F,KAAK2V,GAE/Btb,EAAOwb,UAAU7V,KAAK2V,GAG1Btb,EAAOsb,EAAU3Z,MAAMgE,KAAK2V,MAKpCta,GAAS4E,KAAK1F,IAEPF,EAoC0B0c,CAAgBN,GACzCG,EAAcC,MAEnB,CAACJ,IAEsC,IAAtC/W,OAAOmB,QAAQ8V,GAAY1c,OAC3B,OAAO,4CAEX,IAAM+c,EAAY,CAAI,kBAAmB,aAAvB,mBAAuC7b,IACzD,OACI,mCAEQuE,OAAOmB,QAAQ8V,GAAY5a,KAAI,mCAAEC,EAAF,KAAQjG,EAAR,YACO,IAAhCihB,EAAahd,QAAQgC,IAAiBjG,EAAYkE,OAAS,GAErD,eAAC,IAAM6G,SAAP,WACI,oBAAe/J,MAAO,CAAE0H,WAAY,IAApC,SACK3E,GAAekC,IADXA,GAGPjG,EAAsBgG,KAAI,SAAC6N,GAAD,OACxB,cAAC,GAAD,CAEI+L,UAAW/L,EACXqM,cAAe,WAjCvB1S,EAAuBD,EAAsB,KA+BhCsG,EAAGkN,cANC9a,Q,8CCjE3C0W,GAAmB3Z,KAAKC,MAAMH,OAAOC,aAAaL,QAAQ,kBAAmBka,QAAQ,OAAQ,MAY7FC,GAAe,CACjBrd,OAAQ,UACRsd,MAAO,IAGI,SAASyN,KACpB,MAAwBxoB,qBAAfyb,EAAT,oBACA,EAAoCzb,mBAAiB8a,IAArD,mBAAO2N,EAAP,KAAmB/M,EAAnB,KACQX,EAAkB0N,EAAlB1N,MAAOtd,EAAWgrB,EAAXhrB,OAETgC,EAAQ8L,eAEd,EAAgCtL,qBAAWsI,GAAnClL,EAAR,EAAQA,SAAUE,EAAlB,EAAkBA,UAEZmrB,EAAoB,WACP,YAAXjrB,EACAyJ,GAAO0B,IAAI,2BAEX1B,GAAO0B,IAAI,2BAInBD,qBAAU,WACNtL,EAAS,kBAETE,GAAU,WACN,MAAe,YAAXE,EAEI,cAAC4C,EAAA,EAAD,CAAYxB,QAAS6pB,EAArB,SACI,cAAC,KAAD,MAKR,cAACroB,EAAA,EAAD,CAAYxB,QAAS6pB,EAArB,SACI,cAAC,KAAD,WAIb,CAACjrB,IAEJkL,qBAAU,WACN,IAAMgT,EAAM,IAAIC,UAAJ,UAAiBhB,GAAjB,sBACZe,EAAIE,UAAY,SAACtX,GACbmX,EAAcza,KAAKC,MAAMqD,EAAEmD,QAG/B+T,EAAYE,KACb,IAMH,OACI,mCACI,cAAC,KAAD,CAAiBhQ,UALP,SAACpJ,KAKX,SACI,cAAC,KAAD,CAAWgK,YAAY,YAAvB,SACK,SAACC,GAAD,OACG,eAACzN,EAAA,EAAD,CAAM0N,IAAKD,EAASE,SAApB,UACKqO,EAAM9W,KAAI,SAACnD,EAAMwL,GAAP,OACP,cAAC,KAAD,CAEIK,YAAW,UAAK7L,EAAK4U,QAAV,YAAqB5U,EAAKub,cACrC/P,MAAOA,EAHX,SAKK,SAACE,EAAUK,GAAX,OACG,eAACzN,EAAA,EAAD,wCACI0N,eAAgB,CAAEL,IAAKD,EAASE,WAC5BF,EAASO,gBACTP,EAASQ,iBAHjB,IAII/N,OAjFtBgO,EAkF0BJ,EAASI,WAjFrDC,EAkF4CV,EAASO,eAAe9N,MAlFNkO,EAmFlB1N,EAAM0N,QApFjC,aAAC,gBAGfD,GAECD,GAAc,CACdG,WAA6B,SAAjBD,EAAQrD,KAAkB,UAAY,sBAgFd2C,IAAKD,EAASE,SATlB,UAWI,cAACpN,EAAA,EAAD,UACI,cAAC,KAAD,MAEJ,cAACC,EAAA,EAAD,CACIC,QACI,UAAGsB,EAAKiU,QAAQjT,KAAhB,mBACuB,IAAhBhB,EAAKwb,SADZ,2BAEgBxb,EAAKkb,aA/FpD,IAAC/O,EAClBC,EAA8DC,IAsElC,UACYrM,EAAK4U,QADjB,YAC4B5U,EAAKub,kBA4CpC7P,EAASiB,sBC3GvB,SAASkb,KACpB,MAA0B3oB,mBAAiB,aAA3C,mBAAO5C,EAAP,KAAcC,EAAd,KACA,EAA4B2C,mBAAc,yBAA1C,mBAAO1C,EAAP,KAAeC,EAAf,KACA,EAAgCyC,mBAA0B,CAAEvC,QAAQ,EAAOC,MAAO,0BAAlF,mBAAOF,EAAP,KAAiBG,EAAjB,KAEA,EAAkC0D,EAAyB,aAAa,GAAxE,mBAAOxD,EAAP,KAAkBC,EAAlB,KAEM8qB,EAAgB,CAClBxrB,QAAOC,WAAUC,SAAQC,YAAWC,WAAUG,eAE5CkrB,EAAmB,CAAEhrB,YAAWC,gBAEhC2B,EAAQvC,IAAM4rB,SAChB,kBAAMC,YAAe,CACjB5b,QAAS,CACLrD,KAAMjM,EAAY,OAAS,SAE/BmrB,UAAW,CACPC,eAAgB,CACZ,UAAW,CACP,uBAAwB,CACpB/qB,MAAO,OACPkP,WAAYvP,EAAY,OAAS,WAGrC,6BAA8B,CAC1BuP,WAAYvP,EAAY,OAAS,OACjC+Z,aAAc,cAMlC,CAAC/Z,IAGL,OACI,cAAC,IAAD,UACI,cAACqrB,EAAA,EAAD,CAAezpB,MAAOA,EAAtB,SACI,eAAC8I,EAAc4gB,SAAf,CAAwBzrB,MAAOkrB,EAA/B,UACI,cAACQ,EAAA,EAAD,IACA,cAACrpB,EAAD,IACA,cAACspB,EAAA,EAAD,CACIvjB,GAAG,mBACHlC,UAAU,EACV0lB,gBAAc,EACdrqB,MAAO,CAAEsqB,WAAY,QAJzB,SAMI,eAAC,IAAD,WAEI,cAAC,IAAD,CACIC,OAAK,EACLC,KAAK,IACLrP,OAAQ,kBACJ,cAAC,IAAD,CAAUpb,GAAG,gBAIrB,cAAC,IAAD,CAAOyqB,KAAK,kBAAZ,SACI,cAACxf,GAAD,MAEJ,cAAC,IAAD,CAAOwf,KAAK,uBAAZ,SACI,cAAC3e,GAAD,MAEJ,cAAC,IAAD,CAAO2e,KAAK,mBAAZ,SACI,cAAC,GAAD,MAEJ,cAAC,IAAD,CAAOA,KAAK,YAAZ,SACI,cAAC,EAAUN,SAAX,CAAoBzrB,MAAOmrB,EAA3B,SACI,cAAC,GAAD,QAMR,cAAC,IAAD,CAAOY,KAAK,6BAAZ,SACI,cAAC3V,GAAD,MAEJ,cAAC,IAAD,CAAO2V,KAAK,oBAAZ,SACI,cAAC/K,GAAD,MAEJ,cAAC,IAAD,CAAO+K,KAAK,8BAAZ,SACI,cAACtK,GAAD,CAAcE,SAAO,MAEzB,cAAC,IAAD,CAAOoK,KAAK,6BAAZ,SACI,cAACtK,GAAD,CAAcE,SAAS,MAE3B,cAAC,IAAD,CAAOoK,KAAK,iBAAZ,SACI,cAACnhB,GAAD,MAEJ,cAAC,IAAD,CAAOmhB,KAAK,mBAAZ,SACI,cAACjB,GAAD,MAEJ,cAAC,IAAD,CAAOiB,KAAK,sCAAZ,SACI,+BAEJ,cAAC,IAAD,CAAOA,KAAK,aAAZ,SACI,cAACzO,GAAD,MAEJ,cAAC,IAAD,CAAOyO,KAAK,WAAZ,SACI,cAACrX,GAAD,MAIJ,cAAC,IAAD,CAAOqX,KAAK,oBAAZ,SACI,cAAClB,GAAD,MAEJ,cAAC,IAAD,CAAOkB,KAAK,oCAAZ,SACI,cAAChK,GAAD,CAAcJ,SAAO,MAEzB,cAAC,IAAD,CAAOoK,KAAK,mCAAZ,SACI,cAACtK,GAAD,CAAcE,SAAS,MAE3B,cAAC,IAAD,CAAOoK,KAAK,iBAAZ,SACI,cAACxgB,GAAD,MAEJ,cAAC,IAAD,CAAOwgB,KAAK,wCAAZ,SACI,cAACxB,GAAD,MAEJ,cAAC,IAAD,CAAOwB,KAAK,aAAZ,SACI,cAACtM,GAAD,WAIZ,cAAC,IAAD,UACI,cAAC,IAAD,CACIsM,KAAK,wCAELrP,OAAQ,SAAChX,GAAD,OAAe,cAAC4jB,GAAD,GAAa5jB,EAAMsmB,MAAMC,OAAOtN,0B,cCxJnFlC,IAASC,OACL,cAAC,IAAMwP,WAAP,UACI,cAACjB,GAAD,MAEJ/Z,SAASG,eAAe,W","file":"static/js/main.b0d47073.chunk.js","sourcesContent":["/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    title: string\n    setTitle: React.Dispatch<React.SetStateAction<string>>\n    action: any\n    setAction: React.Dispatch<React.SetStateAction<any>>\n    override: INavbarOverride\n    setOverride: React.Dispatch<React.SetStateAction<INavbarOverride>>\n};\n\nconst NavBarContext = React.createContext<ContextType>({\n    title: 'Tachidesk',\n    setTitle: ():void => {},\n    action: <div />,\n    setAction: ():void => {},\n    override: { status: false, value: <div /> },\n    setOverride: ():void => {},\n});\n\nexport default NavBarContext;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\n\ntype ContextType = {\n    darkTheme: boolean\n    setDarkTheme: React.Dispatch<React.SetStateAction<boolean>>\n};\n\nconst DarkTheme = React.createContext<ContextType>({\n    darkTheme: true,\n    setDarkTheme: ():void => {},\n});\n\nexport default DarkTheme;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport CollectionsBookmarkIcon from '@material-ui/icons/CollectionsBookmark';\nimport ExploreIcon from '@material-ui/icons/Explore';\nimport ExtensionIcon from '@material-ui/icons/Extension';\nimport GetAppIcon from '@material-ui/icons/GetApp';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { Link } from 'react-router-dom';\n\nconst useStyles = makeStyles({\n    list: {\n        width: 250,\n    },\n});\n\ninterface IProps {\n    drawerOpen: boolean\n\n    setDrawerOpen: React.Dispatch<React.SetStateAction<boolean>>\n}\n\nexport default function TemporaryDrawer({ drawerOpen, setDrawerOpen }: IProps) {\n    const classes = useStyles();\n\n    return (\n        <div>\n            <Drawer\n                open={drawerOpen}\n                anchor=\"left\"\n                onClose={() => setDrawerOpen(false)}\n            >\n                <div\n                    className={classes.list}\n                    role=\"presentation\"\n                    onClick={() => setDrawerOpen(false)}\n                    onKeyDown={() => setDrawerOpen(false)}\n                >\n                    <List>\n                        <Link to=\"/library\" style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Library\">\n                                <ListItemIcon>\n                                    <CollectionsBookmarkIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Library\" />\n                            </ListItem>\n                        </Link>\n                        <Link to=\"/manga/extensions\" style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Extensions\">\n                                <ListItemIcon>\n                                    <ExtensionIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Extensions\" />\n                            </ListItem>\n                        </Link>\n                        {/* <Link to=\"/anime/extensions\"\n                        style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Extensions\">\n                                <ListItemIcon>\n                                    <ExtensionIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Anime Extensions\" />\n                            </ListItem>\n                        </Link> */}\n                        <Link to=\"/manga/sources\" style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Sources\">\n                                <ListItemIcon>\n                                    <ExploreIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Sources\" />\n                            </ListItem>\n                        </Link>\n                        {/* <Link to=\"/anime/sources\"\n                        style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Sources\">\n                                <ListItemIcon>\n                                    <ExploreIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Anime Sources\" />\n                            </ListItem>\n                        </Link> */}\n                        <Link to=\"/manga/downloads\" style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"Manga Download Queue\">\n                                <ListItemIcon>\n                                    <GetAppIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Downloadsz\" />\n                            </ListItem>\n                        </Link>\n                        <Link to=\"/settings\" style={{ color: 'inherit', textDecoration: 'none' }}>\n                            <ListItem button key=\"settings\">\n                                <ListItemIcon>\n                                    <SettingsIcon />\n                                </ListItemIcon>\n                                <ListItemText primary=\"Settings\" />\n                            </ListItem>\n                        </Link>\n                    </List>\n                </div>\n            </Drawer>\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport NavBarContext from '../../context/NavbarContext';\nimport DarkTheme from '../../context/DarkTheme';\nimport TemporaryDrawer from '../TemporaryDrawer';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        flexGrow: 1,\n    },\n    menuButton: {\n        marginRight: theme.spacing(2),\n    },\n    title: {\n        flexGrow: 1,\n    },\n}));\n\nexport default function NavBar() {\n    const classes = useStyles();\n    const [drawerOpen, setDrawerOpen] = useState(false);\n    const { title, action, override } = useContext(NavBarContext);\n\n    const { darkTheme } = useContext(DarkTheme);\n\n    return (\n        <>\n            {override.status && override.value}\n            {!override.status\n        && (\n            <div className={classes.root}>\n                <AppBar position=\"fixed\" color={darkTheme ? 'default' : 'primary'}>\n                    <Toolbar>\n                        <IconButton\n                            edge=\"start\"\n                            className={classes.menuButton}\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            onClick={() => setDrawerOpen(true)}\n                        >\n                            <MenuIcon />\n                        </IconButton>\n                        <Typography variant=\"h6\" className={classes.title}>\n                            {title}\n                        </Typography>\n                        {action}\n                    </Toolbar>\n                </AppBar>\n                <TemporaryDrawer drawerOpen={drawerOpen} setDrawerOpen={setDrawerOpen} />\n            </div>\n        )}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nfunction getItem<T>(key: string, defaultValue: T) : T {\n    try {\n        const item = window.localStorage.getItem(key);\n\n        if (item !== null) {\n            return JSON.parse(item);\n        }\n\n        window.localStorage.setItem(key, JSON.stringify(defaultValue));\n\n        /* eslint-disable no-empty */\n    } finally { }\n    return defaultValue;\n}\n\nfunction setItem<T>(key: string, value: T): void {\n    try {\n        window.localStorage.setItem(key, JSON.stringify(value));\n\n        // eslint-disable-next-line no-empty\n    } finally { }\n}\n\nexport default { getItem, setItem };\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, Dispatch, SetStateAction } from 'react';\nimport storage from './localStorage';\n\n// eslint-disable-next-line max-len\nexport default function useLocalStorage<T>(key: string, defaultValue: T | (() => T)) : [T, Dispatch<SetStateAction<T>>] {\n    const initialState = defaultValue instanceof Function ? defaultValue() : defaultValue;\n    const [storedValue, setStoredValue] = useState<T>(storage.getItem(key, initialState));\n\n    const setValue = ((value: T | ((prevState: T) => T)) => {\n        // Allow value to be a function so we have same API as useState\n        const valueToStore = value instanceof Function ? value(storedValue) : value;\n        setStoredValue(valueToStore);\n        storage.setItem(key, valueToStore);\n    }) as React.Dispatch<React.SetStateAction<T>>;\n\n    return [storedValue, setValue];\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport const ISOLanguages = [\n    { code: 'all', name: 'All', nativeName: 'All' },\n    { code: 'installed', name: 'Installed', nativeName: 'Installed' },\n    { code: 'updates pending', name: 'Updates pending', nativeName: 'Updates pending' },\n\n    // full list: https://github.com/meikidd/iso-639-1/blob/master/src/data.js\n    { code: 'en', name: 'English', nativeName: 'English' },\n    { code: 'ca', name: 'Catalan; Valencian', nativeName: 'Català' },\n    { code: 'de', name: 'German', nativeName: 'Deutsch' },\n    { code: 'es', name: 'Spanish; Castilian', nativeName: 'Español' },\n    { code: 'fr', name: 'French', nativeName: 'Français' },\n    { code: 'id', name: 'Indonesian', nativeName: 'Indonesia' },\n    { code: 'it', name: 'Italian', nativeName: 'Italiano' },\n    { code: 'pt', name: 'Portuguese', nativeName: 'Português' },\n    { code: 'vi', name: 'Vietnamese', nativeName: 'Tiếng Việt' },\n    { code: 'tr', name: 'Turkish', nativeName: 'Türkçe' },\n    { code: 'ru', name: 'Russian', nativeName: 'русский' },\n    { code: 'ar', name: 'Arabic', nativeName: 'العربية' },\n    { code: 'hi', name: 'Hindi', nativeName: 'हिन्दी' },\n    { code: 'th', name: 'Thai', nativeName: 'ไทย' },\n    { code: 'zh', name: 'Chinese', nativeName: '中文' },\n    { code: 'ja', name: 'Japanese', nativeName: '日本語' },\n    { code: 'ko', name: 'Korean', nativeName: '한국어' },\n    { code: 'zu', name: 'Zulu', nativeName: 'isiZulu' },\n    { code: 'xh', name: 'Xhosa', nativeName: 'isiXhosa' },\n    { code: 'uk', name: 'Ukrainian', nativeName: 'Українська' },\n    { code: 'ro', name: 'Romanian', nativeName: 'Română' },\n    { code: 'bg', name: 'Bulgarian', nativeName: 'български' },\n    { code: 'cs', name: 'Czech', nativeName: 'čeština' },\n    { code: 'pl', name: 'Polish', nativeName: 'polski' },\n    { code: 'no', name: 'Norwegian', nativeName: 'Norsk' },\n    { code: 'nl', name: 'Dutch', nativeName: 'Nederlands' },\n    { code: 'my', name: 'Burmese', nativeName: 'ဗမာစာ' },\n    { code: 'ms', name: 'Malay', nativeName: 'Malaysia' },\n    { code: 'mn', name: 'Mongolian', nativeName: 'Монгол' },\n    { code: 'ml', name: 'Malayalam', nativeName: 'മലയാളം' },\n    { code: 'ku', name: 'Kurdish', nativeName: 'Kurdî' },\n    { code: 'hu', name: 'Hungarian', nativeName: 'Magyar' },\n    { code: 'hr', name: 'Croatian', nativeName: 'Hrvatski' },\n    { code: 'he', name: 'Hebrew', nativeName: 'עברית' },\n    { code: 'fil', name: 'Filipino', nativeName: 'Filipino' },\n    { code: 'fi', name: 'Finnish', nativeName: 'suomi' },\n    { code: 'fa', name: 'Persian', nativeName: 'فارسی' },\n    { code: 'eu', name: 'Basque', nativeName: 'euskara' },\n    { code: 'el', name: 'Greek', nativeName: 'Ελληνικά' },\n    { code: 'da', name: 'Danish', nativeName: 'dansk' },\n];\n\nexport function langCodeToName(code: string): string {\n    const whereToCut = code.indexOf('-') !== -1 ? code.indexOf('-') : code.length;\n\n    const proccessedCode = code.toLocaleLowerCase().substring(0, whereToCut);\n    let result = 'Error';\n\n    for (let i = 0; i < ISOLanguages.length; i++) {\n        if (ISOLanguages[i].code === proccessedCode) result = ISOLanguages[i].nativeName;\n    }\n\n    if (code.indexOf('-') !== -1) {\n        result = `${result} (${code.substring(whereToCut + 1)})`;\n    }\n\n    return result;\n}\n\nexport function defualtLangs() {\n    return [\n        // todo: infer this from the browser\n        'en',\n    ];\n}\n\nexport const langSortCmp = (a: string, b: string) => {\n    // puts english first for convience\n    const aLang = langCodeToName(a);\n    const bLang = langCodeToName(b);\n\n    if (a === 'en') return -1;\n    if (b === 'en') return 1;\n    return aLang > bLang ? 1 : -1;\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nexport default function cloneObject<T extends object>(obj: T) {\n    return JSON.parse(JSON.stringify(obj)) as T;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Dialog from '@material-ui/core/Dialog';\nimport Switch from '@material-ui/core/Switch';\nimport IconButton from '@material-ui/core/IconButton';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport { List, ListItemSecondaryAction, ListItemText } from '@material-ui/core';\nimport ListItem from '@material-ui/core/ListItem';\nimport { langCodeToName } from 'util/language';\nimport cloneObject from 'util/cloneObject';\n\nconst useStyles = makeStyles(() => createStyles({\n    paper: {\n        maxHeight: 435,\n        width: '80%',\n    },\n}));\n\ninterface IProps {\n    shownLangs: string[]\n    setShownLangs: (arg0: string[]) => void\n    allLangs: string[]\n}\n\nexport default function ExtensionLangSelect(props: IProps) {\n    const { shownLangs, setShownLangs, allLangs } = props;\n    // hold a copy and only sate state on parent when OK pressed, improves performance\n    const [mShownLangs, setMShownLangs] = useState(shownLangs);\n    const classes = useStyles();\n    const [open, setOpen] = useState<boolean>(false);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n        setShownLangs(mShownLangs);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, lang: string) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        if (checked) {\n            setMShownLangs([...mShownLangs, lang]);\n        } else {\n            const clone = cloneObject(mShownLangs);\n            clone.splice(clone.indexOf(lang), 1);\n            setMShownLangs(clone);\n        }\n    };\n\n    return (\n        <>\n            <IconButton\n                onClick={() => setOpen(true)}\n                aria-label=\"display more actions\"\n                edge=\"end\"\n                color=\"inherit\"\n            >\n                <FilterListIcon />\n            </IconButton>\n            <Dialog\n                classes={classes}\n                maxWidth=\"xs\"\n                open={open}\n            >\n                <DialogTitle>Enabled Languages</DialogTitle>\n                <DialogContent dividers style={{ padding: 0 }}>\n                    <List>\n                        {allLangs.map((lang) => (\n                            <ListItem key={lang}>\n                                <ListItemText primary={langCodeToName(lang)} />\n\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        checked={mShownLangs.indexOf(lang) !== -1}\n                                        onChange={(e) => handleChange(e, lang)}\n                                    />\n                                </ListItemSecondaryAction>\n\n                            </ListItem>\n                        ))}\n                    </List>\n\n                </DialogContent>\n                <DialogActions>\n                    <Button autoFocus onClick={handleCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleOk} color=\"primary\">\n                        Ok\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { langCodeToName } from 'util/language';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps {\n    source: ISource\n}\n\nexport default function SourceCard(props: IProps) {\n    const {\n        source: {\n            id, name, lang, iconUrl, supportsLatest, isConfigurable,\n        },\n    } = props;\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles();\n\n    return (\n        <Card>\n            <CardContent className={classes.root}>\n                <div style={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        className={classes.icon}\n                        alt={name}\n                        src={serverAddress + iconUrl}\n                    />\n                    <div style={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langCodeToName(lang)}\n                        </Typography>\n                    </div>\n                </div>\n                <div style={{ display: 'flex' }}>\n                    {isConfigurable && <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/sources/${id}/latest/`; }}>Configure</Button>}\n                    <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/sources/${id}/search/`; }}>Search</Button>\n                    {supportsLatest && <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/sources/${id}/latest/`; }}>Latest</Button>}\n                    <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/sources/${id}/popular/`; }}>Browse</Button>\n                </div>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport axios from 'axios';\nimport storage from './localStorage';\n\nconst { hostname, port, protocol } = window.location;\n\n// if port is 3000 it's probably running from webpack devlopment server\nlet inferredPort;\nif (port === '3000') { inferredPort = '4567'; } else { inferredPort = port; }\n\nconst client = axios.create({\n    // baseURL must not have traling slash\n    baseURL: storage.getItem('serverBaseURL', `${protocol}//${hostname}:${inferredPort}`),\n});\n\nclient.interceptors.request.use((config) => {\n    if (config.data instanceof FormData) {\n        Object.assign(config.headers, { 'Content-Type': 'multipart/form-data' });\n    }\n    return config;\n});\n\nexport default client;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport ExtensionLangSelect from 'components/manga/ExtensionLangSelect';\nimport SourceCard from 'components/manga/SourceCard';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport { defualtLangs, langCodeToName, langSortCmp } from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) { result.push(source.lang); }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nfunction groupByLang(sources: ISource[]) {\n    const result = {} as any;\n    sources.forEach((source) => {\n        if (result[source.lang] === undefined) { result[source.lang] = [] as ISource[]; }\n        result[source.lang].push(source);\n    });\n\n    return result;\n}\n\nexport default function MangaSources() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', defualtLangs());\n\n    const [sources, setSources] = useState<ISource[]>([]);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <ExtensionLangSelect\n                shownLangs={shownLangs}\n                setShownLangs={setShownLangs}\n                allLangs={sourceToLangList(sources)}\n            />,\n        );\n    }, [shownLangs, sources]);\n\n    useEffect(() => {\n        client.get('/api/v1/source/list')\n            .then((response) => response.data)\n            .then((data) => { setSources(data); setFetched(true); });\n    }, []);\n\n    if (sources.length === 0) {\n        if (fetched) return (<h3>No sources found. Install Some Extensions first.</h3>);\n        return (<h3>loading...</h3>);\n    }\n    return (\n        <>\n            {/* eslint-disable-next-line max-len */}\n            {Object.entries(groupByLang(sources)).sort((a, b) => langSortCmp(a[0], b[0])).map(([lang, list]) => (\n                shownLangs.indexOf(lang) !== -1 && (\n                    <React.Fragment key={lang}>\n                        <h1 key={lang} style={{ marginLeft: 25 }}>{langCodeToName(lang)}</h1>\n                        {(list as ISource[]).map((source) => (\n                            <SourceCard\n                                key={source.id}\n                                source={source}\n                            />\n                        ))}\n                    </React.Fragment>\n                )\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport useLocalStorage from 'util/useLocalStorage';\nimport { langCodeToName } from 'util/language';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps {\n    source: ISource\n}\n\nexport default function SourceCard(props: IProps) {\n    const {\n        source: {\n            id, name, lang, iconUrl, supportsLatest,\n        },\n    } = props;\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles();\n\n    return (\n        <Card>\n            <CardContent className={classes.root}>\n                <div style={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        className={classes.icon}\n                        alt={name}\n                        src={serverAddress + iconUrl}\n                    />\n                    <div style={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langCodeToName(lang)}\n                        </Typography>\n                    </div>\n                </div>\n                <div style={{ display: 'flex' }}>\n                    <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/anime/sources/${id}/search/`; }}>Search</Button>\n                    {supportsLatest && <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/anime/sources/${id}/latest/`; }}>Latest</Button>}\n                    <Button variant=\"outlined\" style={{ marginLeft: 20 }} onClick={() => { window.location.href = `/anime/sources/${id}/popular/`; }}>Browse</Button>\n                </div>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport ExtensionLangSelect from 'components/manga/ExtensionLangSelect';\nimport SourceCard from 'components/anime/SourceCard';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport { defualtLangs, langCodeToName, langSortCmp } from 'util/language';\nimport useLocalStorage from 'util/useLocalStorage';\n\nfunction sourceToLangList(sources: ISource[]) {\n    const result: string[] = [];\n\n    sources.forEach((source) => {\n        if (result.indexOf(source.lang) === -1) { result.push(source.lang); }\n    });\n\n    result.sort(langSortCmp);\n    return result;\n}\n\nfunction groupByLang(sources: ISource[]) {\n    const result = {} as any;\n    sources.forEach((source) => {\n        if (result[source.lang] === undefined) { result[source.lang] = [] as ISource[]; }\n        result[source.lang].push(source);\n    });\n\n    return result;\n}\n\nexport default function AnimeSources() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownSourceLangs', defualtLangs());\n\n    const [sources, setSources] = useState<ISource[]>([]);\n    const [fetched, setFetched] = useState<boolean>(false);\n\n    useEffect(() => {\n        setTitle('Sources');\n        setAction(\n            <ExtensionLangSelect\n                shownLangs={shownLangs}\n                setShownLangs={setShownLangs}\n                allLangs={sourceToLangList(sources)}\n            />,\n        );\n    }, [shownLangs, sources]);\n\n    useEffect(() => {\n        client.get('/api/v1/anime/source/list')\n            .then((response) => response.data)\n            .then((data) => { setSources(data); setFetched(true); });\n    }, []);\n\n    if (sources.length === 0) {\n        if (fetched) return (<h3>No sources found. Install Some Extensions first.</h3>);\n        return (<h3>loading...</h3>);\n    }\n    return (\n        <>\n            {/* eslint-disable-next-line max-len */}\n            {Object.entries(groupByLang(sources)).sort((a, b) => langSortCmp(a[0], b[0])).map(([lang, list]) => (\n                shownLangs.indexOf(lang) !== -1 && (\n                    <React.Fragment key={lang}>\n                        <h1 key={lang} style={{ marginLeft: 25 }}>{langCodeToName(lang)}</h1>\n                        {(list as ISource[]).map((source) => (\n                            <SourceCard\n                                key={source.id}\n                                source={source}\n                            />\n                        ))}\n                    </React.Fragment>\n                )\n            ))}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ListItem, { ListItemProps } from '@material-ui/core/ListItem';\n\nexport default function ListItemLink(props: ListItemProps<'a', { button?: true }>) {\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <ListItem button component=\"a\" {...props} />;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport List from '@material-ui/core/List';\nimport ListAltIcon from '@material-ui/icons/ListAlt';\nimport BackupIcon from '@material-ui/icons/Backup';\nimport Brightness6Icon from '@material-ui/icons/Brightness6';\nimport DnsIcon from '@material-ui/icons/Dns';\nimport EditIcon from '@material-ui/icons/Edit';\nimport InfoIcon from '@material-ui/icons/Info';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Switch from '@material-ui/core/Switch';\nimport Button from '@material-ui/core/Button';\nimport IconButton from '@material-ui/core/IconButton';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport TextField from '@material-ui/core/TextField';\nimport NavbarContext from '../context/NavbarContext';\nimport DarkTheme from '../context/DarkTheme';\nimport useLocalStorage from '../util/useLocalStorage';\nimport ListItemLink from '../util/ListItemLink';\n\nexport default function Settings() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Settings'); setAction(<></>); }, []);\n\n    const { darkTheme, setDarkTheme } = useContext(DarkTheme);\n    const [serverAddress, setServerAddress] = useLocalStorage<String>('serverBaseURL', '');\n    const [dialogOpen, setDialogOpen] = useState(false);\n    const [dialogValue, setDialogValue] = useState(serverAddress);\n\n    const handleDialogOpen = () => {\n        setDialogValue(serverAddress);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n        setServerAddress(dialogValue);\n    };\n\n    return (\n        <>\n            <List style={{ padding: 0 }}>\n                <ListItemLink href=\"/settings/categories\">\n                    <ListItemIcon>\n                        <ListAltIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Categories\" />\n                </ListItemLink>\n                <ListItemLink href=\"/settings/backup\">\n                    <ListItemIcon>\n                        <BackupIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Backup\" />\n                </ListItemLink>\n                <ListItem>\n                    <ListItemIcon>\n                        <Brightness6Icon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Dark Theme\" />\n                    <ListItemSecondaryAction>\n                        <Switch\n                            edge=\"end\"\n                            checked={darkTheme}\n                            onChange={() => setDarkTheme(!darkTheme)}\n                        />\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItem>\n                    <ListItemIcon>\n                        <DnsIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Server Address\" secondary={serverAddress} />\n                    <ListItemSecondaryAction>\n                        <IconButton\n                            onClick={() => {\n                                handleDialogOpen();\n                            }}\n                        >\n                            <EditIcon />\n                        </IconButton>\n                    </ListItemSecondaryAction>\n                </ListItem>\n                <ListItemLink href=\"/settings/about\">\n                    <ListItemIcon>\n                        <InfoIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"About\" />\n                </ListItemLink>\n            </List>\n\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogContent>\n                    <DialogContentText>\n                        Enter new category name.\n                    </DialogContentText>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Category Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogValue}\n                        onChange={(e) => setDialogValue(e.target.value)}\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Set\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n    );\n}\n","import React, { useContext, useEffect, useState } from 'react';\nimport { CircularProgress, makeStyles } from '@material-ui/core';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport client from '../../util/client';\nimport ListItemLink from '../../util/ListItemLink';\nimport NavbarContext from '../../context/NavbarContext';\n\nconst useStyles = makeStyles({\n    loading: {\n        width: '100vw',\n        '& div': {\n            margin: '50px auto',\n            display: 'block',\n        },\n    },\n});\n\nexport default function About() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const classes = useStyles();\n\n    const [about, setAbout] = useState<IAbout>();\n\n    useEffect(() => { setTitle('About'); setAction(<></>); }, []);\n\n    useEffect(() => {\n        client.get('/api/v1/about')\n            .then((response) => response.data)\n            .then((data:IAbout) => {\n                setAbout(data);\n            });\n    }, []);\n\n    if (about === undefined) {\n        return (\n            <div className={classes.loading}>\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    const version = () => {\n        if (about.buildType === 'Stable') return `${about.version}`;\n        return `${about.version}-${about.revision}`;\n    };\n\n    const buildTime = () => new Date(about.buildTime * 1000).toUTCString();\n\n    return (\n        <List>\n            <ListItem>\n                <ListItemText primary=\"Server\" secondary={`${about.name} ${about.buildType}`} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Server version\" secondary={version()} />\n            </ListItem>\n            <ListItem>\n                <ListItemText primary=\"Build time\" secondary={buildTime()} />\n            </ListItem>\n            <ListItemLink href={about.github}>\n                <ListItemText primary=\"Github\" secondary={about.github} />\n            </ListItemLink>\n            <ListItemLink href={about.discord}>\n                <ListItemText primary=\"Discord\" secondary={about.discord} />\n            </ListItemLink>\n        </List>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable react/jsx-props-no-spreading */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport {\n    List,\n    ListItem,\n    ListItemText,\n    ListItemIcon,\n    IconButton,\n} from '@material-ui/core';\nimport {\n    DragDropContext, Droppable, Draggable, DropResult, DraggingStyle, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport DragHandleIcon from '@material-ui/icons/DragHandle';\nimport EditIcon from '@material-ui/icons/Edit';\nimport { useTheme } from '@material-ui/core/styles';\nimport Fab from '@material-ui/core/Fab';\nimport AddIcon from '@material-ui/icons/Add';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport { Palette } from '@material-ui/core/styles/createPalette';\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.type === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nexport default function Categories() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Categories'); setAction(<></>); }, []);\n\n    const [categories, setCategories] = useState<ICategory[]>([]);\n    const [categoryToEdit, setCategoryToEdit] = useState<number>(-1); // -1 means new category\n    const [dialogOpen, setDialogOpen] = useState<boolean>(false);\n    const [dialogName, setDialogName] = useState<string>('');\n    const [dialogDefault, setDialogDefault] = useState<boolean>(false);\n    const theme = useTheme();\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState<number>(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        if (!dialogOpen) {\n            client.get('/api/v1/category/')\n                .then((response) => response.data)\n                .then((data) => setCategories(data));\n        }\n    }, [updateTriggerHolder]);\n\n    const categoryReorder = (list: ICategory[], from: number, to: number) => {\n        const category = list[from];\n\n        const formData = new FormData();\n        formData.append('from', `${from + 1}`);\n        formData.append('to', `${to + 1}`);\n        client.post(`/api/v1/category/${category.id}/reorder`, formData)\n            .finally(() => triggerUpdate());\n\n        // also move it in local state to avoid jarring moving behviour...\n        const result = Array.from(list);\n        const [removed] = result.splice(from, 1);\n        result.splice(to, 0, removed);\n        return result;\n    };\n\n    const onDragEnd = (result: DropResult) => {\n        // dropped outside the list?\n        if (!result.destination) {\n            return;\n        }\n\n        setCategories(categoryReorder(\n            categories,\n            result.source.index,\n            result.destination.index,\n        ));\n    };\n\n    const resetDialog = () => {\n        setDialogName('');\n        setDialogDefault(false);\n        setCategoryToEdit(-1);\n    };\n\n    const handleDialogOpen = () => {\n        resetDialog();\n        setDialogOpen(true);\n    };\n\n    const handleEditDialogOpen = (index:number) => {\n        setDialogName(categories[index].name);\n        setDialogDefault(categories[index].default);\n        setCategoryToEdit(index);\n        setDialogOpen(true);\n    };\n\n    const handleDialogCancel = () => {\n        setDialogOpen(false);\n    };\n\n    const handleDialogSubmit = () => {\n        setDialogOpen(false);\n\n        const formData = new FormData();\n        formData.append('name', dialogName);\n        formData.append('default', dialogDefault.toString());\n\n        if (categoryToEdit === -1) {\n            client.post('/api/v1/category/', formData)\n                .finally(() => triggerUpdate());\n        } else {\n            const category = categories[categoryToEdit];\n            client.patch(`/api/v1/category/${category.id}`, formData)\n                .finally(() => triggerUpdate());\n        }\n    };\n\n    const deleteCategory = (index:number) => {\n        const category = categories[index];\n        client.delete(`/api/v1/category/${category.id}`)\n            .finally(() => triggerUpdate());\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {categories.map((item, index) => (\n                                <Draggable\n                                    key={item.id}\n                                    draggableId={item.id.toString()}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <ListItemText\n                                                primary={item.name}\n                                            />\n                                            <IconButton\n                                                onClick={() => {\n                                                    handleEditDialogOpen(index);\n                                                }}\n                                            >\n                                                <EditIcon />\n                                            </IconButton>\n                                            <IconButton\n                                                onClick={() => {\n                                                    deleteCategory(index);\n                                                }}\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton>\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n            <Fab\n                color=\"primary\"\n                aria-label=\"add\"\n                style={{\n                    position: 'absolute',\n                    bottom: theme.spacing(2),\n                    right: theme.spacing(2),\n                }}\n                onClick={handleDialogOpen}\n            >\n                <AddIcon />\n            </Fab>\n            <Dialog open={dialogOpen} onClose={handleDialogCancel}>\n                <DialogTitle id=\"form-dialog-title\">\n                    {categoryToEdit === -1 ? 'New Catalog' : 'Edit Catalog'}\n                </DialogTitle>\n                <DialogContent>\n                    <TextField\n                        autoFocus\n                        margin=\"dense\"\n                        id=\"name\"\n                        label=\"Category Name\"\n                        type=\"text\"\n                        fullWidth\n                        value={dialogName}\n                        onChange={(e) => setDialogName(e.target.value)}\n                    />\n                    <FormControlLabel\n                        control={(\n                            <Checkbox\n                                checked={dialogDefault}\n                                onChange={(e) => setDialogDefault(e.target.checked)}\n                                color=\"default\"\n                            />\n                        )}\n                        label=\"Default category when adding new manga to library\"\n                    />\n                </DialogContent>\n                <DialogActions>\n                    <Button onClick={handleDialogCancel} color=\"primary\">\n                        Cancel\n                    </Button>\n                    <Button onClick={handleDialogSubmit} color=\"primary\">\n                        Submit\n                    </Button>\n                </DialogActions>\n            </Dialog>\n        </>\n\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect } from 'react';\nimport { ListItemIcon } from '@material-ui/core';\nimport List from '@material-ui/core/List';\nimport InboxIcon from '@material-ui/icons/Inbox';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { fromEvent } from 'file-selector';\nimport ListItemLink from '../../util/ListItemLink';\nimport NavbarContext from '../../context/NavbarContext';\nimport client from '../../util/client';\n\nexport default function Backup() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Backup'); setAction(<></>); }, []);\n\n    const { baseURL } = client.defaults;\n\n    const submitBackup = (file: File) => {\n        file.text()\n            .then(\n                (fileContent: string) => {\n                    client.post('/api/v1/backup/legacy/import',\n                        fileContent, { headers: { 'Content-Type': 'application/json' } });\n                },\n            );\n    };\n\n    const dropHandler = async (e: Event) => {\n        e.preventDefault();\n        const files = await fromEvent(e);\n\n        submitBackup(files[0] as File);\n    };\n\n    const dragOverHandler = (e: Event) => {\n        e.preventDefault();\n    };\n\n    useEffect(() => {\n        document.addEventListener('drop', dropHandler);\n        document.addEventListener('dragover', dragOverHandler);\n\n        const input = document.getElementById('backup-file');\n        input?.addEventListener('change', async (evt) => {\n            const files = await fromEvent(evt);\n            submitBackup(files[0] as File);\n        });\n\n        return () => {\n            document.removeEventListener('drop', dropHandler);\n            document.removeEventListener('dragover', dragOverHandler);\n        };\n    }, []);\n\n    return (\n        <List style={{ padding: 0 }}>\n            <ListItemLink href={`${baseURL}/api/v1/backup/legacy/export/file`}>\n                <ListItemIcon>\n                    <InboxIcon />\n                </ListItemIcon>\n                <ListItemText\n                    primary=\"Create Legacy Backup\"\n                    secondary=\"Backup library as a Tachiyomi legacy backup\"\n                />\n            </ListItemLink>\n            <ListItem button onClick={() => document.getElementById('backup-file')?.click()}>\n                <ListItemIcon>\n                    <InboxIcon />\n                </ListItemIcon>\n                <ListItemText\n                    primary=\"Restore Legacy Backup\"\n                    secondary=\"You can also drop the backup file anywhere to restore\"\n                />\n                <input\n                    type=\"file\"\n                    name=\"backup.json\"\n                    id=\"backup-file\"\n                    style={{ display: 'none' }}\n                />\n            </ListItem>\n        </List>\n\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState } from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\ninterface IProps {\n    src: string\n    alt: string\n\n    imgRef?: React.RefObject<HTMLImageElement>\n\n    spinnerClassName?: string\n    imgClassName?: string\n\n    onImageLoad?: () => void\n}\n\nexport default function SpinnerImage(props: IProps) {\n    const {\n        src, alt, onImageLoad, imgRef, spinnerClassName, imgClassName,\n    } = props;\n    const [imageSrc, setImagsrc] = useState<string>('');\n\n    useEffect(() => {\n        const img = new Image();\n        img.src = src;\n\n        img.onload = () => {\n            setImagsrc(src);\n            onImageLoad?.();\n        };\n\n        return () => {\n            img.onload = null;\n        };\n    }, [src]);\n\n    if (imageSrc.length === 0) {\n        return (\n            // <div className={`${classes.image} ${classes.loadingImage}`}>\n            <div className={spinnerClassName}>\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    return (\n        <img\n            className={imgClassName}\n            ref={imgRef}\n            src={imageSrc}\n            alt={alt}\n        />\n    );\n}\n\nSpinnerImage.defaultProps = {\n    spinnerClassName: '',\n    imgClassName: '',\n    onImageLoad: () => {},\n    imgRef: undefined,\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\nimport { Grid } from '@material-ui/core';\nimport useLocalStorage from 'util/useLocalStorage';\nimport SpinnerImage from 'components/SpinnerImage';\n\nconst useStyles = makeStyles({\n    root: {\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n    },\n    wrapper: {\n        position: 'relative',\n        height: '100%',\n    },\n    gradient: {\n        position: 'absolute',\n        top: 0,\n        width: '100%',\n        height: '100%',\n        background: 'linear-gradient(to bottom, transparent, #000000)',\n        opacity: 0.5,\n    },\n    title: {\n        position: 'absolute',\n        bottom: 0,\n        padding: '0.5em',\n        color: 'white',\n    },\n    image: {\n        height: '100%',\n        width: '100%',\n    },\n\n    spinner: {\n        minHeight: '400px',\n        padding: '180px calc(50% - 20px)',\n    },\n});\n\ninterface IProps {\n    manga: IMangaCard\n}\nconst MangaCard = React.forwardRef((props: IProps, ref) => {\n    const {\n        manga: {\n            id, title, thumbnailUrl,\n        },\n    } = props;\n    const classes = useStyles();\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    return (\n        <Grid item xs={6} sm={4} md={3} lg={2}>\n            <Link to={`/manga/${id}/`}>\n                <Card className={classes.root} ref={ref}>\n                    <CardActionArea>\n                        <div className={classes.wrapper}>\n                            <SpinnerImage\n                                alt={title}\n                                src={serverAddress + thumbnailUrl}\n                                spinnerClassName={classes.spinner}\n                                imgClassName={classes.image}\n                            />\n                            <div className={classes.gradient} />\n                            <Typography className={classes.title} variant=\"h5\" component=\"h2\">{title}</Typography>\n                        </div>\n                    </CardActionArea>\n                </Card>\n            </Link>\n        </Grid>\n    );\n});\n\nexport default MangaCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport MangaCard from './MangaCard';\n\ninterface IProps{\n    mangas: IMangaCard[]\n    message?: string\n    hasNextPage: boolean\n    lastPageNum: number\n    setLastPageNum: (lastPageNum: number) => void\n}\n\nexport default function MangaGrid(props: IProps) {\n    const {\n        mangas, message, hasNextPage, lastPageNum, setLastPageNum,\n    } = props;\n    let mapped;\n    const lastManga = useRef<HTMLInputElement>();\n\n    const scrollHandler = () => {\n        if (lastManga.current) {\n            const rect = lastManga.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, mangas]);\n\n    if (mangas.length === 0) {\n        mapped = <h3>{message}</h3>;\n    } else {\n        mapped = mangas.map((it, idx) => {\n            if (idx === mangas.length - 1) {\n                return <MangaCard manga={it} ref={lastManga} />;\n            }\n            return <MangaCard manga={it} />;\n        });\n    }\n\n    return (\n        <Grid container spacing={1} style={{ margin: 0, width: '100%', padding: '5px' }}>\n            {mapped}\n        </Grid>\n    );\n}\n\nMangaGrid.defaultProps = {\n    message: 'loading...',\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { Tab, Tabs } from '@material-ui/core';\nimport React, { useContext, useEffect, useState } from 'react';\nimport MangaGrid from 'components/manga/MangaGrid';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport cloneObject from 'util/cloneObject';\n\ninterface IMangaCategory {\n    category: ICategory\n    mangas: IManga[]\n    isFetched: boolean\n}\n\ninterface TabPanelProps {\n    children: React.ReactNode;\n    index: any;\n    value: any;\n}\n\nfunction TabPanel(props: TabPanelProps) {\n    const {\n        children, value, index,\n    } = props;\n\n    return (\n        <div\n            role=\"tabpanel\"\n            hidden={value !== index}\n            id={`simple-tabpanel-${index}`}\n        >\n            {value === index && children}\n        </div>\n    );\n}\n\nexport default function Library() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Library'); setAction(<></>); }, []);\n\n    const [tabs, setTabs] = useState<IMangaCategory[]>([]);\n    const [tabNum, setTabNum] = useState<number>(0);\n\n    // a hack so MangaGrid doesn't stop working. I won't change it in case\n    // if I do manga pagination for library..\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const handleTabChange = (newTab: number) => {\n        setTabNum(newTab);\n    };\n\n    useEffect(() => {\n        Promise.all<IManga[], ICategory[]>([\n            client.get('/api/v1/library').then((response) => response.data),\n            client.get('/api/v1/category').then((response) => response.data),\n        ])\n            .then(\n                ([libraryMangas, categories]) => {\n                    const categoryTabs = categories.map((category) => ({\n                        category,\n                        mangas: [] as IManga[],\n                        isFetched: false,\n                    }));\n\n                    if (libraryMangas.length > 0 || categoryTabs.length === 0) {\n                        const defaultCategoryTab = {\n                            category: {\n                                name: 'Default',\n                                default: true,\n                                order: 0,\n                                id: -1,\n                            },\n                            mangas: libraryMangas,\n                            isFetched: true,\n                        };\n                        setTabs(\n                            [defaultCategoryTab, ...categoryTabs],\n                        );\n                    } else {\n                        setTabs(categoryTabs);\n                        setTabNum(1);\n                    }\n                },\n            );\n    }, []);\n\n    // console.log(client.defaults.baseURL);\n    // fetch the current tab\n    useEffect(() => {\n        tabs.forEach((tab, index) => {\n            if (tab.category.order === tabNum && !tab.isFetched) {\n                // eslint-disable-next-line @typescript-eslint/no-shadow\n                client.get(`/api/v1/category/${tab.category.id}`)\n                    .then((response) => response.data)\n                    .then((data: IManga[]) => {\n                        const tabsClone = cloneObject(tabs);\n                        tabsClone[index].mangas = data;\n                        tabsClone[index].isFetched = true;\n\n                        setTabs(tabsClone); // clone the object\n                    });\n            }\n        });\n    }, [tabNum]);\n\n    let toRender;\n    if (tabs.length > 1) {\n        // eslint-disable-next-line max-len\n        const tabDefines = tabs.map((tab) => (<Tab label={tab.category.name} value={tab.category.order} />));\n\n        const tabBodies = tabs.map((tab) => (\n            <TabPanel value={tabNum} index={tab.category.order}>\n                <MangaGrid\n                    mangas={tab.mangas}\n                    hasNextPage={false}\n                    lastPageNum={lastPageNum}\n                    setLastPageNum={setLastPageNum}\n                    message={tab.isFetched ? 'Category is Empty' : 'Loading...'}\n                />\n            </TabPanel>\n        ));\n\n        // Visual Hack: 160px is min-width for viewport width of >600\n        const scrollableTabs = window.innerWidth < tabs.length * 160;\n        toRender = (\n            <>\n                <Tabs\n                    value={tabNum}\n                    onChange={(e, newTab) => handleTabChange(newTab)}\n                    indicatorColor=\"primary\"\n                    textColor=\"primary\"\n                    centered={!scrollableTabs}\n                    variant={scrollableTabs ? 'scrollable' : 'fullWidth'}\n                    scrollButtons=\"on\"\n                >\n                    {tabDefines}\n                </Tabs>\n                {tabBodies}\n            </>\n        );\n    } else {\n        const mangas = tabs.length === 1 ? tabs[0].mangas : [];\n        toRender = (\n            <MangaGrid\n                mangas={mangas}\n                hasNextPage={false}\n                lastPageNum={lastPageNum}\n                setLastPageNum={setLastPageNum}\n                message={tabs.length > 0 ? 'Library is Empty' : undefined}\n            />\n        );\n    }\n\n    return toRender;\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport { useParams } from 'react-router-dom';\nimport MangaGrid from 'components/manga/MangaGrid';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        TextField: {\n            margin: theme.spacing(1),\n            width: '25ch',\n        },\n    },\n}));\n\nexport default function SearchSingle() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Search'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const classes = useStyles();\n    const [error, setError] = useState<boolean>(false);\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [message, setMessage] = useState<string>('');\n    const [searchTerm, setSearchTerm] = useState<string>('');\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    const textInput = React.createRef<HTMLInputElement>();\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: { name: string }) => setTitle(`Search: ${data.name}`));\n    }, []);\n\n    function processInput() {\n        if (textInput.current) {\n            const { value } = textInput.current;\n            if (value === '') {\n                setError(true);\n                setMessage('Type something to search');\n            } else {\n                setError(false);\n                setSearchTerm(value);\n                setMangas([]);\n                setMessage('loading...');\n            }\n        }\n    }\n\n    useEffect(() => {\n        if (searchTerm.length > 0) {\n            client.get(`/api/v1/source/${sourceId}/search/${searchTerm}/${lastPageNum}`)\n                .then((response) => response.data)\n                .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                    setMessage('');\n                    if (data.mangaList.length > 0) {\n                        setMangas([\n                            ...mangas,\n                            ...data.mangaList.map((it) => ({\n                                title: it.title, thumbnailUrl: it.thumbnailUrl, id: it.id,\n                            }))]);\n                        setHasNextPage(data.hasNextPage);\n                    } else {\n                        setMessage('search query returned nothing.');\n                    }\n                });\n        }\n    }, [searchTerm]);\n\n    const mangaGrid = (\n        <MangaGrid\n            mangas={mangas}\n            message={message}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n        />\n    );\n\n    return (\n        <>\n            <div className={classes.root}>\n                <TextField\n                    inputRef={textInput}\n                    error={error}\n                    id=\"standard-basic\"\n                    label=\"Search text..\"\n                    onKeyDown={(e) => e.key === 'Enter' && processInput()}\n                />\n                <Button variant=\"contained\" color=\"primary\" onClick={() => processInput()}>\n                    Search\n                </Button>\n            </div>\n            {mangaGrid}\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport BookmarkIcon from '@material-ui/icons/Bookmark';\nimport client from 'util/client';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps{\n    chapter: IChapter\n    triggerChaptersUpdate: () => void\n    downloadingString: string\n}\n\nexport default function ChapterCard(props: IProps) {\n    const classes = useStyles();\n    const theme = useTheme();\n    const { chapter, triggerChaptersUpdate, downloadingString } = props;\n\n    const dateStr = chapter.uploadDate && new Date(chapter.uploadDate).toISOString().slice(0, 10);\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const sendChange = (key: string, value: any) => {\n        handleClose();\n\n        const formData = new FormData();\n        formData.append(key, value);\n        client.patch(`/api/v1/manga/${chapter.mangaId}/chapter/${chapter.index}`, formData)\n            .then(() => triggerChaptersUpdate());\n    };\n\n    const downloadChapter = () => {\n        client.get(`/api/v1/download/${chapter.mangaId}/chapter/${chapter.index}`);\n        handleClose();\n    };\n\n    const readChapterColor = theme.palette.type === 'dark' ? '#acacac' : '#b0b0b0';\n    return (\n        <>\n            <li>\n                <Card>\n                    <CardContent className={classes.root}>\n                        <Link\n                            to={`/manga/${chapter.mangaId}/chapter/${chapter.index}`}\n                            style={{\n                                textDecoration: 'none',\n                                color: chapter.read ? readChapterColor : theme.palette.text.primary,\n                            }}\n                        >\n                            <div style={{ display: 'flex' }}>\n                                <div style={{ display: 'flex', flexDirection: 'column' }}>\n                                    <Typography variant=\"h5\" component=\"h2\">\n                                        <span style={{ color: theme.palette.primary.dark }}>\n                                            {chapter.bookmarked && <BookmarkIcon />}\n                                        </span>\n                                        {chapter.name}\n                                        {chapter.chapterNumber > 0 && ` : ${chapter.chapterNumber}`}\n                                    </Typography>\n                                    <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                        {chapter.scanlator}\n                                        {chapter.scanlator && ' '}\n                                        {dateStr}\n                                        {downloadingString}\n                                    </Typography>\n                                </div>\n                            </div>\n                        </Link>\n\n                        <IconButton aria-label=\"more\" onClick={handleClick}>\n                            <MoreVertIcon />\n                        </IconButton>\n                        <Menu\n                            anchorEl={anchorEl}\n                            keepMounted\n                            open={Boolean(anchorEl)}\n                            onClose={handleClose}\n                        >\n                            {downloadingString.length === 0\n                            && <MenuItem onClick={downloadChapter}>Download</MenuItem> }\n                            <MenuItem onClick={() => sendChange('bookmarked', !chapter.bookmarked)}>\n                                {chapter.bookmarked && 'Remove bookmark'}\n                                {!chapter.bookmarked && 'Bookmark'}\n                            </MenuItem>\n                            <MenuItem onClick={() => sendChange('read', !chapter.read)}>\n                                Mark as\n                                {' '}\n                                {chapter.read && 'unread'}\n                                {!chapter.read && 'read'}\n                            </MenuItem>\n                            <MenuItem onClick={() => sendChange('markPrevRead', true)}>\n                                Mark previous as Read\n                            </MenuItem>\n                        </Menu>\n                    </CardContent>\n                </Card>\n            </li>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState } from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Button from '@material-ui/core/Button';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport Dialog from '@material-ui/core/Dialog';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport client from 'util/client';\n\nconst useStyles = makeStyles(() => createStyles({\n    paper: {\n        maxHeight: 435,\n        width: '80%',\n    },\n}));\n\ninterface IProps {\n    open: boolean\n    setOpen: (value: boolean) => void\n    mangaId: number\n}\n\ninterface ICategoryInfo {\n    category: ICategory\n    selected: boolean\n}\n\nexport default function CategorySelect(props: IProps) {\n    const classes = useStyles();\n    const { open, setOpen, mangaId } = props;\n    const [categoryInfos, setCategoryInfos] = useState<ICategoryInfo[]>([]);\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        let tmpCategoryInfos: ICategoryInfo[] = [];\n        client.get('/api/v1/category/')\n            .then((response) => response.data)\n            .then((data: ICategory[]) => {\n                tmpCategoryInfos = data.map((category) => ({ category, selected: false }));\n            })\n            .then(() => {\n                client.get(`/api/v1/manga/${mangaId}/category/`)\n                    .then((response) => response.data)\n                    .then((data: ICategory[]) => {\n                        data.forEach((category) => {\n                            tmpCategoryInfos[category.order - 1].selected = true;\n                        });\n                        setCategoryInfos(tmpCategoryInfos);\n                    });\n            });\n    }, [updateTriggerHolder, open]);\n\n    const handleCancel = () => {\n        setOpen(false);\n    };\n\n    const handleOk = () => {\n        setOpen(false);\n    };\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>, categoryId: number) => {\n        const { checked } = event.target as HTMLInputElement;\n\n        const method = checked ? client.get : client.delete;\n        method(`/api/v1/manga/${mangaId}/category/${categoryId}`)\n            .then(() => triggerUpdate());\n    };\n\n    return (\n        <Dialog\n            classes={classes}\n            maxWidth=\"xs\"\n            open={open}\n        >\n            <DialogTitle>Set categories</DialogTitle>\n            <DialogContent dividers>\n                <FormGroup>\n                    {categoryInfos.length === 0\n                        && (\n                            <span>\n                                No categories found!\n                                <br />\n                                You should make some from settings.\n                            </span>\n                        )}\n                    {categoryInfos.map((categoryInfo) => (\n                        <FormControlLabel\n                            control={(\n                                <Checkbox\n                                    checked={categoryInfo.selected}\n                                    onChange={(e) => handleChange(e, categoryInfo.category.id)}\n                                    color=\"default\"\n                                />\n                            )}\n                            label={categoryInfo.category.name}\n                        />\n                    ))}\n                </FormGroup>\n\n            </DialogContent>\n            <DialogActions>\n                <Button autoFocus onClick={handleCancel} color=\"primary\">\n                    Cancel\n                </Button>\n                <Button onClick={handleOk} color=\"primary\">\n                    Ok\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Theme } from '@material-ui/core/styles';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport PublicIcon from '@material-ui/icons/Public';\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport CategorySelect from './CategorySelect';\n\nconst useStyles = (inLibrary: string) => makeStyles((theme: Theme) => ({\n    root: {\n        width: '100%',\n        [theme.breakpoints.up('md')]: {\n            position: 'sticky',\n            top: '64px',\n            left: '0px',\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            alignSelf: 'flex-start',\n            overflowY: 'auto',\n        },\n    },\n    top: {\n        padding: '10px',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '50%',\n        // },\n    },\n    leftRight: {\n        display: 'flex',\n    },\n    leftSide: {\n        '& img': {\n            borderRadius: 4,\n            maxWidth: '100%',\n            minWidth: '100%',\n            height: 'auto',\n        },\n        maxWidth: '50%',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '100px',\n        // },\n    },\n    rightSide: {\n        marginLeft: 15,\n        maxWidth: '100%',\n        '& span': {\n            fontWeight: '400',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    buttons: {\n        display: 'flex',\n        justifyContent: 'space-around',\n        '& button': {\n            color: inLibrary === 'In Library' ? '#2196f3' : 'inherit',\n        },\n        '& span': {\n            display: 'block',\n            fontSize: '0.85em',\n        },\n        '& a': {\n            textDecoration: 'none',\n            color: '#858585',\n            '& button': {\n                color: 'inherit',\n            },\n        },\n    },\n    bottom: {\n        paddingLeft: '10px',\n        paddingRight: '10px',\n        [theme.breakpoints.up('md')]: {\n            fontSize: '1.2em',\n            // maxWidth: '50%',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    description: {\n        '& h4': {\n            marginTop: '1em',\n            marginBottom: 0,\n        },\n        '& p': {\n            textAlign: 'justify',\n            textJustify: 'inter-word',\n        },\n    },\n    genre: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        '& h5': {\n            border: '2px solid #2196f3',\n            borderRadius: '1.13em',\n            marginRight: '1em',\n            marginTop: 0,\n            marginBottom: '10px',\n            padding: '0.3em',\n            color: '#2196f3',\n        },\n    },\n}));\n\ninterface IProps{\n    manga: IManga\n}\n\nfunction getSourceName(source: ISource) {\n    if (source.name !== null) {\n        return `${source.name} (${source.lang.toLocaleUpperCase()})`;\n    }\n    return source.id;\n}\n\nfunction getValueOrUnknown(val: string) {\n    return val || 'UNKNOWN';\n}\n\nexport default function MangaDetails(props: IProps) {\n    const { setAction } = useContext(NavbarContext);\n\n    const { manga } = props;\n    if (manga.genre == null) {\n        manga.genre = '';\n    }\n    const [inLibrary, setInLibrary] = useState<string>(\n        manga.inLibrary ? 'In Library' : 'Add To Library',\n    );\n\n    const [categoryDialogOpen, setCategoryDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (inLibrary === 'In Library') {\n            setAction(\n                <>\n                    <IconButton\n                        onClick={() => setCategoryDialogOpen(true)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                    >\n                        <FilterListIcon />\n                    </IconButton>\n                    <CategorySelect\n                        open={categoryDialogOpen}\n                        setOpen={setCategoryDialogOpen}\n                        mangaId={manga.id}\n                    />\n                </>,\n\n            );\n        } else { setAction(<></>); }\n    }, [inLibrary, categoryDialogOpen]);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles(inLibrary)();\n\n    function addToLibrary() {\n        // setInLibrary('adding');\n        client.get(`/api/v1/manga/${manga.id}/library/`).then(() => {\n            setInLibrary('In Library');\n        });\n    }\n\n    function removeFromLibrary() {\n        // setInLibrary('removing');\n        client.delete(`/api/v1/manga/${manga.id}/library/`).then(() => {\n            setInLibrary('Add To Library');\n        });\n    }\n\n    function handleButtonClick() {\n        if (inLibrary === 'Add To Library') {\n            addToLibrary();\n        } else {\n            removeFromLibrary();\n        }\n    }\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.top}>\n                <div className={classes.leftRight}>\n                    <div className={classes.leftSide}>\n                        <img src={`${serverAddress}${manga.thumbnailUrl}`} alt=\"Manga Thumbnail\" />\n                    </div>\n                    <div className={classes.rightSide}>\n                        <h1>\n                            {manga.title}\n                        </h1>\n                        <h3>\n                            Author:\n                            {' '}\n                            <span>{getValueOrUnknown(manga.author)}</span>\n                        </h3>\n                        <h3>\n                            Artist:\n                            {' '}\n                            <span>{getValueOrUnknown(manga.artist)}</span>\n                        </h3>\n                        <h3>\n                            Status:\n                            {' '}\n                            {manga.status}\n                        </h3>\n                        <h3>\n                            Source:\n                            {' '}\n                            {getSourceName(manga.source)}\n                        </h3>\n                    </div>\n                </div>\n                <div className={classes.buttons}>\n                    <div>\n                        <IconButton onClick={() => handleButtonClick()}>\n                            {inLibrary === 'In Library' && <FavoriteIcon />}\n                            {inLibrary !== 'In Library' && <FavoriteBorderIcon />}\n                            <span>{inLibrary}</span>\n                        </IconButton>\n                    </div>\n                    { /* eslint-disable-next-line react/jsx-no-target-blank */ }\n                    <a href={manga.url} target=\"_blank\">\n                        <IconButton>\n                            <PublicIcon />\n                            <span>Open Site</span>\n                        </IconButton>\n                    </a>\n                </div>\n            </div>\n            <div className={classes.bottom}>\n                <div className={classes.description}>\n                    <h4>About</h4>\n                    <p>{manga.description}</p>\n                </div>\n                <div className={classes.genre}>\n                    {manga.genre.split(', ').map((g) => <h5 key={g}>{g}</h5>)}\n                </div>\n            </div>\n        </div>\n    );\n}\n","/* eslint-disable react/jsx-props-no-spreading */\n/* eslint-disable react/require-default-props */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nconst useStyles = makeStyles({\n    loading: {\n        margin: '10px auto',\n        display: 'flex',\n        justifyContent: 'center',\n    },\n});\n\ninterface IProps {\n    shouldRender: boolean | (() => boolean)\n    children?: React.ReactNode\n    component?: string | React.FunctionComponent<any> | React.ComponentClass<any, any>\n    componentProps?: any\n}\n\nexport default function LoadingPlaceholder(props: IProps) {\n    const {\n        children, shouldRender, component, componentProps,\n    } = props;\n    const classes = useStyles();\n\n    const condition = shouldRender instanceof Function ? shouldRender() : shouldRender;\n\n    if (condition) {\n        if (component) {\n            return React.createElement(component, componentProps);\n        }\n\n        if (children) {\n            return (\n                <>\n                    {children}\n                </>\n            );\n        }\n    }\n\n    return (\n        <div className={classes.loading}>\n            <CircularProgress thickness={5} />\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport ReactDOM from 'react-dom';\nimport React from 'react';\nimport Slide, { SlideProps } from '@material-ui/core/Slide';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport MuiAlert, { Color as Severity } from '@material-ui/lab/Alert';\n\nfunction removeToast(id: string) {\n    const container = document.querySelector(`#${id}`)!!;\n    ReactDOM.unmountComponentAtNode(container);\n    document.body.removeChild(container);\n}\n\nfunction Transition(props: SlideProps) {\n    // eslint-disable-next-line react/jsx-props-no-spreading\n    return <Slide {...props} direction=\"up\" />;\n}\n\ninterface IToastProps{\n    message: string\n    severity: Severity\n}\n\nfunction Toast(props: IToastProps) {\n    const { message, severity } = props;\n    const [open, setOpen] = React.useState(true);\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    return (\n        <Snackbar\n            open={open}\n            onClose={handleClose}\n            autoHideDuration={3000}\n            TransitionComponent={Transition}\n            message=\"I love snacks\"\n        >\n            <MuiAlert elevation={6} variant=\"filled\" onClose={handleClose} severity={severity}>\n                {message}\n            </MuiAlert>\n        </Snackbar>\n    );\n}\n\nexport default function makeToast(message: string, severity: Severity) {\n    const id = Math.floor(Math.random() * 1000);\n    const container = document.createElement('div');\n    container.id = `alert-${id}`;\n\n    document.body.appendChild(container);\n\n    ReactDOM.render(<Toast message={message} severity={severity} />, container);\n\n    setTimeout(() => removeToast(container.id), 3500);\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport { useParams } from 'react-router-dom';\nimport { Virtuoso } from 'react-virtuoso';\nimport ChapterCard from 'components/manga/ChapterCard';\nimport MangaDetails from 'components/manga/MangaDetails';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport LoadingPlaceholder from 'components/LoadingPlaceholder';\nimport makeToast from 'components/Toast';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n    root: {\n        [theme.breakpoints.up('md')]: {\n            display: 'flex',\n        },\n    },\n\n    chapters: {\n        listStyle: 'none',\n        padding: 0,\n        minHeight: '200px',\n        [theme.breakpoints.up('md')]: {\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            margin: 0,\n        },\n    },\n\n    loading: {\n        margin: '10px 0',\n        display: 'flex',\n        justifyContent: 'center',\n    },\n}));\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function Manga() {\n    const classes = useStyles();\n\n    const { setTitle } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Manga'); }, []); // delegate setting topbar action to MangaDetails\n\n    const { id } = useParams<{ id: string }>();\n\n    const [manga, setManga] = useState<IManga>();\n    const [chapters, setChapters] = useState<IChapter[]>([]);\n    const [fetchedChapters, setFetchedChapters] = useState(false);\n    const [noChaptersFound, setNoChaptersFound] = useState(false);\n    const [chapterUpdateTriggerer, setChapterUpdateTriggerer] = useState(0);\n\n    const [, setWsClient] = useState<WebSocket>();\n    const [{ queue }, setQueueState] = useState<IQueue>(initialQueue);\n\n    function triggerChaptersUpdate() {\n        setChapterUpdateTriggerer(chapterUpdateTriggerer + 1);\n    }\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            const data = JSON.parse(e.data) as IQueue;\n            setQueueState(data);\n\n            let shouldUpdate = false;\n            data.queue.forEach((q) => {\n                if (q.mangaId === manga?.id && q.state === 'Finished') {\n                    shouldUpdate = true;\n                }\n            });\n            if (shouldUpdate) {\n                triggerChaptersUpdate();\n            }\n        };\n\n        setWsClient(wsc);\n\n        return () => wsc.close();\n    }, [queue.length]);\n\n    const downloadingStringFor = (chapter: IChapter) => {\n        let rtn = '';\n        if (chapter.downloaded) {\n            rtn = ' • Downloaded';\n        }\n        queue.forEach((q) => {\n            if (chapter.index === q.chapterIndex && chapter.mangaId === q.mangaId) {\n                rtn = ` • Downloading (${q.progress * 100}%)`;\n            }\n        });\n        return rtn;\n    };\n\n    useEffect(() => {\n        if (manga === undefined || !manga.freshData) {\n            client.get(`/api/v1/manga/${id}/?onlineFetch=${manga !== undefined}`)\n                .then((response) => response.data)\n                .then((data: IManga) => {\n                    setManga(data);\n                    setTitle(data.title);\n                });\n        }\n    }, [manga]);\n\n    useEffect(() => {\n        const shouldFetchOnline = fetchedChapters && chapterUpdateTriggerer === 0;\n        client.get(`/api/v1/manga/${id}/chapters?onlineFetch=${shouldFetchOnline}`)\n            .then((response) => response.data)\n            .then((data) => {\n                if (data.length === 0 && fetchedChapters) {\n                    makeToast('No chapters found', 'warning');\n                    setNoChaptersFound(true);\n                }\n                setChapters(data);\n            })\n            .then(() => setFetchedChapters(true));\n    }, [chapters.length, fetchedChapters, chapterUpdateTriggerer]);\n\n    return (\n        <div className={classes.root}>\n            <LoadingPlaceholder\n                shouldRender={manga !== undefined}\n                component={MangaDetails}\n                componentProps={{ manga }}\n            />\n\n            <LoadingPlaceholder\n                shouldRender={chapters.length > 0 || noChaptersFound}\n            >\n                <Virtuoso\n                    style={{ // override Virtuoso default values and set them with class\n                        height: 'undefined',\n                        overflowY: window.innerWidth < 960 ? 'visible' : 'auto',\n                    }}\n                    className={classes.chapters}\n                    totalCount={chapters.length}\n                    itemContent={(index:number) => (\n                        <ChapterCard\n                            chapter={chapters[index]}\n                            downloadingString={downloadingStringFor(chapters[index])}\n                            triggerChaptersUpdate={triggerChaptersUpdate}\n                        />\n                    )}\n                    useWindowScroll={window.innerWidth < 960}\n                    overscan={window.innerHeight * 0.5}\n                />\n            </LoadingPlaceholder>\n\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport IconButton from '@material-ui/core/IconButton';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport BookmarkIcon from '@material-ui/icons/Bookmark';\nimport client from 'util/client';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps{\n    episode: IEpisode\n    triggerEpisodesUpdate: () => void\n}\n\nexport default function EpisodeCard(props: IProps) {\n    const classes = useStyles();\n    const theme = useTheme();\n    const { episode, triggerEpisodesUpdate } = props;\n\n    const dateStr = episode.uploadDate && new Date(episode.uploadDate).toISOString().slice(0, 10);\n\n    const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n\n    const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n        setAnchorEl(event.currentTarget);\n    };\n\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const sendChange = (key: string, value: any) => {\n        handleClose();\n\n        const formData = new FormData();\n        formData.append(key, value);\n        client.patch(`/api/v1/anime/anime/${episode.animeId}/episode/${episode.index}`, formData)\n            .then(() => triggerEpisodesUpdate());\n    };\n\n    const readChapterColor = theme.palette.type === 'dark' ? '#acacac' : '#b0b0b0';\n    return (\n        <>\n            <li>\n                <Card>\n                    <CardContent className={classes.root}>\n                        <Link\n                            to={`/anime/${episode.animeId}/episode/${episode.index}`}\n                            style={{\n                                textDecoration: 'none',\n                                color: episode.read ? readChapterColor : theme.palette.text.primary,\n                            }}\n                        >\n                            <div style={{ display: 'flex' }}>\n                                <div style={{ display: 'flex', flexDirection: 'column' }}>\n                                    <Typography variant=\"h5\" component=\"h2\">\n                                        <span style={{ color: theme.palette.primary.dark }}>\n                                            {episode.bookmarked && <BookmarkIcon />}\n                                        </span>\n                                        {episode.name}\n                                        {episode.episodeNumber > 0 && ` : ${episode.episodeNumber}`}\n                                    </Typography>\n                                    <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                                        {episode.scanlator}\n                                        {episode.scanlator && ' '}\n                                        {dateStr}\n                                    </Typography>\n                                </div>\n                            </div>\n                        </Link>\n\n                        <IconButton aria-label=\"more\" onClick={handleClick}>\n                            <MoreVertIcon />\n                        </IconButton>\n                        <Menu\n                            anchorEl={anchorEl}\n                            keepMounted\n                            open={Boolean(anchorEl)}\n                            onClose={handleClose}\n                        >\n                            {/* <MenuItem onClick={handleClose}>Download</MenuItem> */}\n                            <MenuItem onClick={() => sendChange('bookmarked', !episode.bookmarked)}>\n                                {episode.bookmarked && 'Remove bookmark'}\n                                {!episode.bookmarked && 'Bookmark'}\n                            </MenuItem>\n                            <MenuItem onClick={() => sendChange('read', !episode.read)}>\n                                Mark as\n                                {' '}\n                                {episode.read && 'unread'}\n                                {!episode.read && 'read'}\n                            </MenuItem>\n                            <MenuItem onClick={() => sendChange('markPrevRead', true)}>\n                                Mark previous as Read\n                            </MenuItem>\n                        </Menu>\n                    </CardContent>\n                </Card>\n            </li>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core';\nimport IconButton from '@material-ui/core/IconButton';\nimport { Theme } from '@material-ui/core/styles';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\nimport FavoriteBorderIcon from '@material-ui/icons/FavoriteBorder';\nimport FilterListIcon from '@material-ui/icons/FilterList';\nimport PublicIcon from '@material-ui/icons/Public';\nimport React, { useContext, useEffect, useState } from 'react';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport CategorySelect from 'components/manga/CategorySelect';\n\nconst useStyles = (inLibrary: string) => makeStyles((theme: Theme) => ({\n    root: {\n        width: '100%',\n        [theme.breakpoints.up('md')]: {\n            position: 'sticky',\n            top: '64px',\n            left: '0px',\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            alignSelf: 'flex-start',\n            overflowY: 'auto',\n        },\n    },\n    top: {\n        padding: '10px',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '50%',\n        // },\n    },\n    leftRight: {\n        display: 'flex',\n    },\n    leftSide: {\n        '& img': {\n            borderRadius: 4,\n            maxWidth: '100%',\n            minWidth: '100%',\n            height: 'auto',\n        },\n        maxWidth: '50%',\n        // [theme.breakpoints.up('md')]: {\n        //     minWidth: '100px',\n        // },\n    },\n    rightSide: {\n        marginLeft: 15,\n        maxWidth: '100%',\n        '& span': {\n            fontWeight: '400',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    buttons: {\n        display: 'flex',\n        justifyContent: 'space-around',\n        '& button': {\n            color: inLibrary === 'In Library' ? '#2196f3' : 'inherit',\n        },\n        '& span': {\n            display: 'block',\n            fontSize: '0.85em',\n        },\n        '& a': {\n            textDecoration: 'none',\n            color: '#858585',\n            '& button': {\n                color: 'inherit',\n            },\n        },\n    },\n    bottom: {\n        paddingLeft: '10px',\n        paddingRight: '10px',\n        [theme.breakpoints.up('md')]: {\n            fontSize: '1.2em',\n            // maxWidth: '50%',\n        },\n        [theme.breakpoints.up('lg')]: {\n            fontSize: '1.3em',\n        },\n    },\n    description: {\n        '& h4': {\n            marginTop: '1em',\n            marginBottom: 0,\n        },\n        '& p': {\n            textAlign: 'justify',\n            textJustify: 'inter-word',\n        },\n    },\n    genre: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        '& h5': {\n            border: '2px solid #2196f3',\n            borderRadius: '1.13em',\n            marginRight: '1em',\n            marginTop: 0,\n            marginBottom: '10px',\n            padding: '0.3em',\n            color: '#2196f3',\n        },\n    },\n}));\n\ninterface IProps{\n    manga: IManga\n}\n\nfunction getSourceName(source: ISource) {\n    if (source.name !== null) {\n        return `${source.name} (${source.lang.toLocaleUpperCase()})`;\n    }\n    return source.id;\n}\n\nfunction getValueOrUnknown(val: string) {\n    return val || 'UNKNOWN';\n}\n\nexport default function AnimeDetails(props: IProps) {\n    const { setAction } = useContext(NavbarContext);\n\n    const { manga } = props;\n    if (manga.genre == null) {\n        manga.genre = '';\n    }\n    const [inLibrary, setInLibrary] = useState<string>(\n        manga.inLibrary ? 'In Library' : 'Add To Library',\n    );\n\n    const [categoryDialogOpen, setCategoryDialogOpen] = useState<boolean>(false);\n\n    useEffect(() => {\n        if (inLibrary === 'In Library') {\n            setAction(\n                <>\n                    <IconButton\n                        onClick={() => setCategoryDialogOpen(true)}\n                        aria-label=\"display more actions\"\n                        edge=\"end\"\n                        color=\"inherit\"\n                    >\n                        <FilterListIcon />\n                    </IconButton>\n                    <CategorySelect\n                        open={categoryDialogOpen}\n                        setOpen={setCategoryDialogOpen}\n                        mangaId={manga.id}\n                    />\n                </>,\n\n            );\n        } else { setAction(<></>); }\n    }, [inLibrary, categoryDialogOpen]);\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles(inLibrary)();\n\n    function addToLibrary() {\n        // setInLibrary('adding');\n        client.get(`/api/v1/anime/anime/${manga.id}/library/`).then(() => {\n            setInLibrary('In Library');\n        });\n    }\n\n    function removeFromLibrary() {\n        // setInLibrary('removing');\n        client.delete(`/api/v1/anime/anime/${manga.id}/library/`).then(() => {\n            setInLibrary('Add To Library');\n        });\n    }\n\n    function handleButtonClick() {\n        if (inLibrary === 'Add To Library') {\n            addToLibrary();\n        } else {\n            removeFromLibrary();\n        }\n    }\n\n    return (\n        <div className={classes.root}>\n            <div className={classes.top}>\n                <div className={classes.leftRight}>\n                    <div className={classes.leftSide}>\n                        <img src={`${serverAddress}${manga.thumbnailUrl}?x=${Math.random()}`} alt=\"Manga Thumbnail\" />\n                    </div>\n                    <div className={classes.rightSide}>\n                        <h1>\n                            {manga.title}\n                        </h1>\n                        <h3>\n                            Author:\n                            {' '}\n                            <span>{getValueOrUnknown(manga.author)}</span>\n                        </h3>\n                        <h3>\n                            Artist:\n                            {' '}\n                            <span>{getValueOrUnknown(manga.artist)}</span>\n                        </h3>\n                        <h3>\n                            Status:\n                            {' '}\n                            {manga.status}\n                        </h3>\n                        <h3>\n                            Source:\n                            {' '}\n                            {getSourceName(manga.source)}\n                        </h3>\n                    </div>\n                </div>\n                <div className={classes.buttons}>\n                    <div>\n                        <IconButton onClick={() => handleButtonClick()}>\n                            {inLibrary === 'In Library' && <FavoriteIcon />}\n                            {inLibrary !== 'In Library' && <FavoriteBorderIcon />}\n                            <span>{inLibrary}</span>\n                        </IconButton>\n                    </div>\n                    { /* eslint-disable-next-line react/jsx-no-target-blank */ }\n                    <a href={manga.url} target=\"_blank\">\n                        <IconButton>\n                            <PublicIcon />\n                            <span>Open Site</span>\n                        </IconButton>\n                    </a>\n                </div>\n            </div>\n            <div className={classes.bottom}>\n                <div className={classes.description}>\n                    <h4>About</h4>\n                    <p>{manga.description}</p>\n                </div>\n                <div className={classes.genre}>\n                    {manga.genre.split(', ').map((g) => <h5 key={g}>{g}</h5>)}\n                </div>\n            </div>\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useState, useContext } from 'react';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport { useParams } from 'react-router-dom';\nimport { Virtuoso } from 'react-virtuoso';\nimport EpisodeCard from 'components/anime/EpisodeCard';\nimport AnimeDetails from 'components/anime/AnimeDetails';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport LoadingPlaceholder from 'components/LoadingPlaceholder';\nimport makeToast from 'components/Toast';\n\nconst useStyles = makeStyles((theme: Theme) => ({\n    root: {\n        [theme.breakpoints.up('md')]: {\n            display: 'flex',\n        },\n    },\n\n    chapters: {\n        listStyle: 'none',\n        padding: 0,\n        minHeight: '200px',\n        [theme.breakpoints.up('md')]: {\n            width: '50vw',\n            height: 'calc(100vh - 64px)',\n            margin: 0,\n        },\n    },\n\n    loading: {\n        margin: '10px 0',\n        display: 'flex',\n        justifyContent: 'center',\n    },\n}));\n\nexport default function Anime() {\n    const classes = useStyles();\n\n    const { setTitle } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Anime'); }, []); // delegate setting topbar action to MangaDetails\n\n    const { id } = useParams<{ id: string }>();\n\n    const [manga, setManga] = useState<IManga>();\n    const [episodes, setEpisodes] = useState<IEpisode[]>([]);\n    const [fetchedEpisodes, setFetchedEpisodes] = useState(false);\n    const [noEpisodesFound, setNoEpisodesFound] = useState(false);\n    const [episodeUpdateTriggerer, setEpisodeUpdateTriggerer] = useState(0);\n\n    function triggerEpisodesUpdate() {\n        setEpisodeUpdateTriggerer(episodeUpdateTriggerer + 1);\n    }\n\n    useEffect(() => {\n        if (manga === undefined || !manga.freshData) {\n            client.get(`/api/v1/anime/anime/${id}/?onlineFetch=${manga !== undefined}`)\n                .then((response) => response.data)\n                .then((data: IManga) => {\n                    setManga(data);\n                    setTitle(data.title);\n                });\n        }\n    }, [manga]);\n\n    useEffect(() => {\n        const shouldFetchOnline = fetchedEpisodes && episodeUpdateTriggerer === 0;\n        client.get(`/api/v1/anime/anime/${id}/episodes?onlineFetch=${shouldFetchOnline}`)\n            .then((response) => response.data)\n            .then((data) => {\n                if (data.length === 0 && fetchedEpisodes) {\n                    makeToast('No episodes found', 'warning');\n                    setNoEpisodesFound(true);\n                }\n                setEpisodes(data);\n            })\n            .then(() => setFetchedEpisodes(true));\n    }, [episodes.length, fetchedEpisodes, episodeUpdateTriggerer]);\n\n    return (\n        <div className={classes.root}>\n            <LoadingPlaceholder\n                shouldRender={manga !== undefined}\n                component={AnimeDetails}\n                componentProps={{ manga }}\n            />\n\n            <LoadingPlaceholder\n                shouldRender={episodes.length > 0 || noEpisodesFound}\n            >\n                <Virtuoso\n                    style={{ // override Virtuoso default values and set them with class\n                        height: 'undefined',\n                        overflowY: window.innerWidth < 960 ? 'visible' : 'auto',\n                    }}\n                    className={classes.chapters}\n                    totalCount={episodes.length}\n                    itemContent={(index:number) => (\n                        <EpisodeCard\n                            episode={episodes[index]}\n                            triggerEpisodesUpdate={triggerEpisodesUpdate}\n                        />\n                    )}\n                    useWindowScroll={window.innerWidth < 960}\n                    overscan={window.innerHeight * 0.5}\n                />\n            </LoadingPlaceholder>\n\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps {\n    extension: IExtension\n    notifyInstall: () => void\n}\n\nexport default function ExtensionCard(props: IProps) {\n    const {\n        extension: {\n            name, lang, versionName, installed, hasUpdate, obsolete, pkgName, iconUrl,\n        },\n        notifyInstall,\n    } = props;\n    const [installedState, setInstalledState] = useState<string>(\n        () => {\n            if (obsolete) { return 'obsolete'; }\n            if (hasUpdate) { return 'update'; }\n            return (installed ? 'uninstall' : 'install');\n        },\n    );\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles();\n    const langPress = lang === 'all' ? 'All' : lang.toUpperCase();\n\n    function install() {\n        setInstalledState('installing');\n        client.get(`/api/v1/extension/install/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function update() {\n        setInstalledState('updating');\n        client.get(`/api/v1/extension/update/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function uninstall() {\n        setInstalledState('uninstalling');\n        client.get(`/api/v1/extension/uninstall/${pkgName}`)\n            .then(() => {\n                // setInstalledState('install');\n                notifyInstall();\n            });\n    }\n\n    function handleButtonClick() {\n        switch (installedState) {\n            case 'install':\n                install();\n                break;\n            case 'update':\n                update();\n                break;\n            case 'obsolete':\n                uninstall();\n                setTimeout(() => window.location.reload(), 3000);\n                break;\n            case 'uninstall':\n                uninstall();\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Card>\n            <CardContent className={classes.root}>\n                <div style={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        className={classes.icon}\n                        alt={name}\n                        src={serverAddress + iconUrl}\n                    />\n                    <div style={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langPress}\n                            {' '}\n                            {versionName}\n                        </Typography>\n                    </div>\n                </div>\n\n                <Button\n                    variant=\"outlined\"\n                    style={{ color: installedState === 'obsolete' ? 'red' : 'inherit' }}\n                    onClick={() => handleButtonClick()}\n                >\n                    {installedState}\n\n                </Button>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport ExtensionCard from 'components/manga/ExtensionCard';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport ExtensionLangSelect from 'components/manga/ExtensionLangSelect';\nimport { defualtLangs, langCodeToName, langSortCmp } from 'util/language';\n\nconst allLangs: string[] = [];\n\nfunction groupExtensions(extensions: IExtension[]) {\n    allLangs.length = 0; // empty the array\n    const result = { installed: [], 'updates pending': [] } as any;\n    extensions.sort((a, b) => ((a.apkName > b.apkName) ? 1 : -1));\n\n    extensions.forEach((extension) => {\n        if (result[extension.lang] === undefined) {\n            result[extension.lang] = [];\n            if (extension.lang !== 'all') { allLangs.push(extension.lang); }\n        }\n        if (extension.installed) {\n            if (extension.hasUpdate) {\n                result['updates pending'].push(extension);\n            } else {\n                result.installed.push(extension);\n            }\n        } else {\n            result[extension.lang].push(extension);\n        }\n    });\n\n    // put english first for convience\n    allLangs.sort(langSortCmp);\n\n    return result;\n}\n\nfunction extensionDefaultLangs() {\n    return [...defualtLangs(), 'all'];\n}\n\nexport default function MangaExtensions() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownExtensionLangs', extensionDefaultLangs());\n\n    useEffect(() => {\n        setTitle('Extensions');\n        setAction(\n            <ExtensionLangSelect\n                shownLangs={shownLangs}\n                setShownLangs={setShownLangs}\n                allLangs={allLangs}\n            />,\n        );\n    }, [shownLangs]);\n\n    const [extensionsRaw, setExtensionsRaw] = useState<IExtension[]>([]);\n    const [extensions, setExtensions] = useState<any>({});\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        client.get('/api/v1/extension/list')\n            .then((response) => response.data)\n            .then((data) => setExtensionsRaw(data));\n    }, [updateTriggerHolder]);\n\n    useEffect(() => {\n        if (extensionsRaw.length > 0) {\n            const groupedExtension = groupExtensions(extensionsRaw);\n            setExtensions(groupedExtension);\n        }\n    }, [extensionsRaw]);\n\n    if (Object.entries(extensions).length === 0) {\n        return <h3>loading...</h3>;\n    }\n    const groupsToShow = ['updates pending', 'installed', ...shownLangs];\n    return (\n        <>\n            {\n                Object.entries(extensions).map(([lang, list]) => (\n                    ((groupsToShow.indexOf(lang) !== -1 && (list as []).length > 0)\n                        && (\n                            <React.Fragment key={lang}>\n                                <h1 key={lang} style={{ marginLeft: 25 }}>\n                                    {langCodeToName(lang)}\n                                </h1>\n                                {(list as IExtension[]).map((it) => (\n                                    <ExtensionCard\n                                        key={it.apkName}\n                                        extension={it}\n                                        notifyInstall={() => {\n                                            triggerUpdate();\n                                        }}\n                                    />\n                                ))}\n                            </React.Fragment>\n                        ))\n                ))\n            }\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport MangaGrid from 'components/manga/MangaGrid';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\n\nexport default function SourceMangas(props: { popular: boolean }) {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Source'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    useEffect(() => {\n        client.get(`/api/v1/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: { name: string }) => setTitle(data.name));\n    }, []);\n\n    useEffect(() => {\n        const sourceType = props.popular ? 'popular' : 'latest';\n        client.get(`/api/v1/source/${sourceId}/${sourceType}/${lastPageNum}`)\n            .then((response) => response.data)\n            .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                setMangas([\n                    ...mangas,\n                    ...data.mangaList.map((it) => ({\n                        title: it.title, thumbnailUrl: it.thumbnailUrl, id: it.id,\n                    }))]);\n                setHasNextPage(data.hasNextPage);\n            });\n    }, [lastPageNum]);\n\n    return (\n        <MangaGrid\n            mangas={mangas}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActionArea from '@material-ui/core/CardActionArea';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport Typography from '@material-ui/core/Typography';\nimport { Link } from 'react-router-dom';\nimport { Grid } from '@material-ui/core';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst useStyles = makeStyles({\n    root: {\n        height: '100%',\n        width: '100%',\n        display: 'flex',\n    },\n    wrapper: {\n        position: 'relative',\n        height: '100%',\n    },\n    gradient: {\n        position: 'absolute',\n        top: 0,\n        width: '100%',\n        height: '100%',\n        background: 'linear-gradient(to bottom, transparent, #000000)',\n        opacity: 0.5,\n    },\n    title: {\n        position: 'absolute',\n        bottom: 0,\n        padding: '0.5em',\n        color: 'white',\n    },\n    image: {\n        height: '100%',\n        width: '100%',\n    },\n});\n\ninterface IProps {\n    manga: IMangaCard\n}\nconst AnimeCard = React.forwardRef((props: IProps, ref) => {\n    const {\n        manga: {\n            id, title, thumbnailUrl,\n        },\n    } = props;\n    const classes = useStyles();\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    return (\n        <Grid item xs={6} sm={4} md={3} lg={2}>\n            <Link to={`/anime/${id}/`}>\n                <Card className={classes.root} ref={ref}>\n                    <CardActionArea>\n                        <div className={classes.wrapper}>\n                            <CardMedia\n                                className={classes.image}\n                                component=\"img\"\n                                alt={title}\n                                image={serverAddress + thumbnailUrl}\n                                title={title}\n                            />\n                            <div className={classes.gradient} />\n                            <Typography className={classes.title} variant=\"h5\" component=\"h2\">{title}</Typography>\n                        </div>\n                    </CardActionArea>\n                </Card>\n            </Link>\n        </Grid>\n    );\n});\n\nexport default AnimeCard;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useEffect, useRef } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport AnimeCard from './AnimeCard';\n\ninterface IProps{\n    mangas: IMangaCard[]\n    message?: string\n    hasNextPage: boolean\n    lastPageNum: number\n    setLastPageNum: (lastPageNum: number) => void\n}\n\nexport default function AnimeGrid(props: IProps) {\n    const {\n        mangas, message, hasNextPage, lastPageNum, setLastPageNum,\n    } = props;\n    let mapped;\n    const lastManga = useRef<HTMLInputElement>();\n\n    const scrollHandler = () => {\n        if (lastManga.current) {\n            const rect = lastManga.current.getBoundingClientRect();\n            if (((rect.y + rect.height) / window.innerHeight < 2) && hasNextPage) {\n                setLastPageNum(lastPageNum + 1);\n            }\n        }\n    };\n    useEffect(() => {\n        window.addEventListener('scroll', scrollHandler, true);\n        return () => {\n            window.removeEventListener('scroll', scrollHandler, true);\n        };\n    }, [hasNextPage, mangas]);\n\n    if (mangas.length === 0) {\n        mapped = <h3>{message}</h3>;\n    } else {\n        mapped = mangas.map((it, idx) => {\n            if (idx === mangas.length - 1) {\n                return <AnimeCard manga={it} ref={lastManga} />;\n            }\n            return <AnimeCard manga={it} />;\n        });\n    }\n\n    return (\n        <Grid container spacing={1} style={{ margin: 0, width: '100%', padding: '5px' }}>\n            {mapped}\n        </Grid>\n    );\n}\n\nAnimeGrid.defaultProps = {\n    message: 'loading...',\n};\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport AnimeGrid from 'components/anime/AnimeGrid';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\n\nexport default function SourceAnimes(props: { popular: boolean }) {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    useEffect(() => { setTitle('Source'); setAction(<></>); }, []);\n\n    const { sourceId } = useParams<{ sourceId: string }>();\n    const [mangas, setMangas] = useState<IMangaCard[]>([]);\n    const [hasNextPage, setHasNextPage] = useState<boolean>(false);\n    const [lastPageNum, setLastPageNum] = useState<number>(1);\n\n    useEffect(() => {\n        client.get(`/api/v1/anime/source/${sourceId}`)\n            .then((response) => response.data)\n            .then((data: { name: string }) => setTitle(data.name));\n    }, []);\n\n    useEffect(() => {\n        const sourceType = props.popular ? 'popular' : 'latest';\n        client.get(`/api/v1/anime/source/${sourceId}/${sourceType}/${lastPageNum}`)\n            .then((response) => response.data)\n            .then((data: { mangaList: IManga[], hasNextPage: boolean }) => {\n                setMangas([\n                    ...mangas,\n                    ...data.mangaList.map((it) => ({\n                        title: it.title, thumbnailUrl: it.thumbnailUrl, id: it.id,\n                    }))]);\n                setHasNextPage(data.hasNextPage);\n            });\n    }, [lastPageNum]);\n\n    return (\n        <AnimeGrid\n            mangas={mangas}\n            hasNextPage={hasNextPage}\n            lastPageNum={lastPageNum}\n            setLastPageNum={setLastPageNum}\n        />\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport { CSSProperties } from '@material-ui/core/styles/withStyles';\nimport React, { useEffect, useRef } from 'react';\nimport SpinnerImage from 'components/SpinnerImage';\n\nfunction imageStyle(settings: IReaderSettings): CSSProperties {\n    if (settings.readerType === 'DoubleLTR'\n    || settings.readerType === 'DoubleRTL'\n    || settings.readerType === 'ContinuesHorizontalLTR'\n    || settings.readerType === 'ContinuesHorizontalRTL') {\n        return {\n            display: 'block',\n            marginLeft: '7px',\n            marginRight: '7px',\n            width: 'auto',\n            minHeight: '99vh',\n            height: 'auto',\n            maxHeight: '99vh',\n            objectFit: 'contain',\n            pointerEvents: 'none',\n        };\n    }\n\n    return {\n        display: 'block',\n        marginBottom: settings.readerType === 'ContinuesVertical' ? '15px' : 0,\n        minWidth: '50vw',\n        width: '100%',\n        maxWidth: '100%',\n    };\n}\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    loading: {\n        margin: '100px auto',\n        height: '100vh',\n        width: '100vw',\n    },\n    loadingImage: {\n        height: '100vh',\n        width: '70vw',\n        padding: '50px calc(50% - 20px)',\n        backgroundColor: '#525252',\n        marginBottom: 10,\n    },\n    image: imageStyle(settings),\n});\n\ninterface IProps {\n    src: string\n    index: number\n    onImageLoad: () => void\n    setCurPage: React.Dispatch<React.SetStateAction<number>>\n    settings: IReaderSettings\n}\n\nconst Page = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        src, index, onImageLoad, setCurPage, settings,\n    } = props;\n\n    const classes = useStyles(settings)();\n    const imgRef = useRef<HTMLImageElement>(null);\n\n    const handleVerticalScroll = () => {\n        if (imgRef.current) {\n            const rect = imgRef.current.getBoundingClientRect();\n            if (rect.y < 0 && rect.y + rect.height > 0) {\n                setCurPage(index);\n            }\n        }\n    };\n\n    const handleHorizontalScroll = () => {\n        if (imgRef.current) {\n            const rect = imgRef.current.getBoundingClientRect();\n            if (rect.left <= window.innerWidth / 2 && rect.right > window.innerWidth / 2) {\n                setCurPage(index);\n            }\n        }\n    };\n\n    useEffect(() => {\n        switch (settings.readerType) {\n            case 'Webtoon':\n            case 'ContinuesVertical':\n                window.addEventListener('scroll', handleVerticalScroll);\n                return () => window.removeEventListener('scroll', handleVerticalScroll);\n            case 'ContinuesHorizontalLTR':\n            case 'ContinuesHorizontalRTL':\n                window.addEventListener('scroll', handleHorizontalScroll);\n                return () => window.removeEventListener('scroll', handleHorizontalScroll);\n            default:\n                return () => {};\n        }\n    }, [handleVerticalScroll]);\n\n    return (\n        <div ref={ref} style={{ margin: '0 auto' }}>\n            <SpinnerImage\n                src={src}\n                onImageLoad={onImageLoad}\n                alt={`Page #${index}`}\n                imgRef={imgRef}\n                spinnerClassName={`${classes.image} ${classes.loadingImage}`}\n                imgClassName={classes.image}\n            />\n        </div>\n    );\n});\n\nexport default Page;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useRef } from 'react';\nimport Page from '../Page';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    reader: {\n        display: 'flex',\n        flexDirection: (settings.readerType === 'ContinuesHorizontalLTR') ? 'row' : 'row-reverse',\n        justifyContent: (settings.readerType === 'ContinuesHorizontalLTR') ? 'flex-start' : 'flex-end',\n        margin: '0 auto',\n        width: 'auto',\n        height: 'auto',\n        overflowX: 'visible',\n        userSelect: 'none',\n    },\n});\n\nexport default function HorizontalPager(props: IReaderProps) {\n    const {\n        pages, curPage, settings, setCurPage, prevChapter, nextChapter,\n    } = props;\n\n    const classes = useStyles(settings)();\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            pagesRef.current[curPage - 1]?.scrollIntoView({ inline: 'center' });\n            setCurPage(curPage - 1);\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const mouseXPos = useRef<number>(0);\n\n    function dragScreen(e: MouseEvent) {\n        window.scrollBy(mouseXPos.current - e.pageX, 0);\n    }\n\n    function dragControl(e:MouseEvent) {\n        mouseXPos.current = e.pageX;\n        selfRef.current?.addEventListener('mousemove', dragScreen);\n    }\n\n    function removeDragControl() {\n        selfRef.current?.removeEventListener('mousemove', dragScreen);\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX >= window.innerWidth * 0.85) {\n            goRight();\n        } else if (e.clientX <= window.innerWidth * 0.15) {\n            goLeft();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if (settings.readerType === 'ContinuesHorizontalLTR') {\n            if (window.scrollX + window.innerWidth >= document.body.scrollWidth) {\n                nextChapter();\n            }\n        } else if (settings.readerType === 'ContinuesHorizontalRTL') {\n            if (window.scrollX <= window.innerWidth) {\n                nextChapter();\n            }\n        }\n    };\n\n    useEffect(() => {\n        pagesRef.current[curPage]?.scrollIntoView({ inline: 'center' });\n    }, [settings.readerType]);\n\n    useEffect(() => {\n        selfRef.current?.addEventListener('mousedown', dragControl);\n        selfRef.current?.addEventListener('mouseup', removeDragControl);\n\n        return () => {\n            selfRef.current?.removeEventListener('mousedown', dragControl);\n            selfRef.current?.removeEventListener('mouseup', removeDragControl);\n        };\n    }, [selfRef]);\n\n    useEffect(() => {\n        if (settings.loadNextonEnding) {\n            document.addEventListener('scroll', handleLoadNextonEnding);\n        }\n        selfRef.current?.addEventListener('mousedown', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            selfRef.current?.removeEventListener('mousedown', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    return (\n        <div ref={selfRef} className={classes.reader}>\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        setCurPage={setCurPage}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    pageNumber: {\n        display: settings.showPageNumber ? 'block' : 'none',\n        position: 'fixed',\n        bottom: '50px',\n        right: settings.staticNav ? 'calc((100vw - 325px)/2)' : 'calc((100vw - 25px)/2)',\n        width: '50px',\n        textAlign: 'center',\n        backgroundColor: 'rgba(0, 0, 0, 0.3)',\n        borderRadius: '10px',\n    },\n});\n\ninterface IProps {\n    settings: IReaderSettings\n    curPage: number\n    pageCount: number\n}\n\nexport default function PageNumber(props: IProps) {\n    const { settings, curPage, pageCount } = props;\n    const classes = useStyles(settings)();\n\n    return (\n        <div className={classes.pageNumber}>\n            {`${curPage + 1} / ${pageCount}`}\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useRef } from 'react';\nimport Page from '../Page';\n\nconst useStyles = makeStyles({\n    reader: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        margin: '0 auto',\n        width: '100%',\n        height: '100vh',\n    },\n});\n\nexport default function PagedReader(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const classes = useStyles();\n\n    const selfRef = useRef<HTMLDivElement>(null);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            setCurPage(curPage + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            setCurPage(curPage - 1);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'SingleLTR') {\n            prevPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'SingleLTR') {\n            nextPage();\n        } else if (settings.readerType === 'SingleRTL') {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    useEffect(() => {\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <div ref={selfRef} className={classes.reader}>\n            <Page\n                key={curPage}\n                index={curPage}\n                onImageLoad={() => {}}\n                src={pages[curPage].src}\n                setCurPage={setCurPage}\n                settings={settings}\n            />\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    image: {\n        display: 'block',\n        marginBottom: 0,\n        width: 'auto',\n        minHeight: '99vh',\n        height: 'auto',\n        maxHeight: '99vh',\n        objectFit: 'contain',\n    },\n    page: {\n        display: 'flex',\n        flexDirection: settings.readerType === 'DoubleLTR' ? 'row' : 'row-reverse',\n        justifyContent: 'center',\n        margin: '0 auto',\n        width: 'auto',\n        height: 'auto',\n        overflowX: 'scroll',\n    },\n});\n\ninterface IProps {\n    index: number\n    image1src: string\n    image2src: string\n    settings: IReaderSettings\n}\n\nconst DoublePage = React.forwardRef((props: IProps, ref: any) => {\n    const {\n        image1src, image2src, index, settings,\n    } = props;\n\n    const classes = useStyles(settings)();\n\n    return (\n        <div ref={ref} className={classes.page}>\n            <img\n                className={classes.image}\n                src={image1src}\n                alt={`Page #${index}`}\n            />\n            <img\n                className={classes.image}\n                src={image2src}\n                alt={`Page #${index + 1}`}\n            />\n        </div>\n    );\n});\n\nexport default DoublePage;\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useRef } from 'react';\nimport ReactDOM from 'react-dom';\nimport Page from '../Page';\nimport DoublePage from '../DoublePage';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    preload: {\n        display: 'none',\n    },\n    reader: {\n        display: 'flex',\n        flexDirection: (settings.readerType === 'DoubleLTR') ? 'row' : 'row-reverse',\n        justifyContent: 'center',\n        margin: '0 auto',\n        width: 'auto',\n        height: 'auto',\n        overflowX: 'scroll',\n    },\n});\n\nexport default function DoublePagedPager(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, nextChapter, prevChapter,\n    } = props;\n\n    const classes = useStyles(settings)();\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLImageElement[]>([]);\n\n    const pagesDisplayed = useRef<number>(0);\n    const pageLoaded = useRef<boolean[]>(Array(pages.length).fill(false));\n\n    function setPagesToDisplay() {\n        pagesDisplayed.current = 0;\n        if (curPage < pages.length && pagesRef.current[curPage]) {\n            if (pageLoaded.current[curPage]) {\n                pagesDisplayed.current = 1;\n                const imgElem = pagesRef.current[curPage];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n            }\n        }\n        if (curPage + 1 < pages.length && pagesRef.current[curPage + 1]) {\n            if (pageLoaded.current[curPage + 1]) {\n                const imgElem = pagesRef.current[curPage + 1];\n                const aspectRatio = imgElem.height / imgElem.width;\n                if (aspectRatio < 1) {\n                    return;\n                }\n                pagesDisplayed.current = 2;\n            }\n        }\n    }\n\n    function displayPages() {\n        if (pagesDisplayed.current === 2) {\n            ReactDOM.render(\n                <DoublePage\n                    key={curPage}\n                    index={curPage}\n                    image1src={pages[curPage].src}\n                    image2src={pages[curPage + 1].src}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        } else {\n            ReactDOM.render(\n                <Page\n                    key={curPage}\n                    index={curPage}\n                    src={(pagesDisplayed.current === 1) ? pages[curPage].src : ''}\n                    onImageLoad={() => {}}\n                    setCurPage={setCurPage}\n                    settings={settings}\n                />,\n                document.getElementById('display'),\n            );\n        }\n    }\n\n    function pagesToGoBack() {\n        for (let i = 1; i <= 2; i++) {\n            if (curPage - i > 0 && pagesRef.current[curPage - i]) {\n                if (pageLoaded.current[curPage - i]) {\n                    const imgElem = pagesRef.current[curPage - i];\n                    const aspectRatio = imgElem.height / imgElem.width;\n                    if (aspectRatio < 1) {\n                        return 1;\n                    }\n                }\n            }\n        }\n        return 2;\n    }\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            const nextCurPage = curPage + pagesDisplayed.current;\n            setCurPage((nextCurPage >= pages.length) ? pages.length - 1 : nextCurPage);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const nextCurPage = curPage - pagesToGoBack();\n            setCurPage((nextCurPage < 0) ? 0 : nextCurPage);\n        } else {\n            prevChapter();\n        }\n    }\n\n    function goLeft() {\n        if (settings.readerType === 'DoubleLTR') {\n            prevPage();\n        } else {\n            nextPage();\n        }\n    }\n\n    function goRight() {\n        if (settings.readerType === 'DoubleLTR') {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                goRight();\n                break;\n            case 'ArrowLeft':\n                goLeft();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            goRight();\n        } else {\n            goLeft();\n        }\n    }\n\n    function handleImageLoad(index: number) {\n        return () => {\n            pageLoaded.current[index] = true;\n        };\n    }\n\n    useEffect(() => {\n        const retryDisplay = setInterval(() => {\n            const isLastPage = (curPage === pages.length - 1);\n            if ((!isLastPage && pageLoaded.current[curPage] && pageLoaded.current[curPage + 1])\n                || pageLoaded.current[curPage]) {\n                setPagesToDisplay();\n                displayPages();\n                clearInterval(retryDisplay);\n            }\n        }, 50);\n\n        document.addEventListener('keydown', keyboardControl);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            clearInterval(retryDisplay);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage, settings.readerType]);\n\n    return (\n        <div ref={selfRef}>\n            <div id=\"preload\" className={classes.preload}>\n                {\n                    pages.map((page) => (\n                        <img\n                            ref={(e:HTMLImageElement) => { pagesRef.current[page.index] = e; }}\n                            key={`${page.index}`}\n                            src={page.src}\n                            onLoad={handleImageLoad(page.index)}\n                            alt={`${page.index}`}\n                        />\n                    ))\n                }\n            </div>\n            <div id=\"display\" className={classes.reader} />\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useEffect, useRef } from 'react';\nimport Page from '../Page';\n\nconst useStyles = makeStyles({\n    reader: {\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        margin: '0 auto',\n        width: '100%',\n    },\n});\n\nexport default function VerticalReader(props: IReaderProps) {\n    const {\n        pages, settings, setCurPage, curPage, chapter, nextChapter, prevChapter,\n    } = props;\n\n    const classes = useStyles();\n\n    const selfRef = useRef<HTMLDivElement>(null);\n    const pagesRef = useRef<HTMLDivElement[]>([]);\n\n    useEffect(() => {\n        pagesRef.current = pagesRef.current.slice(0, pages.length);\n    }, [pages.length]);\n\n    function nextPage() {\n        if (curPage < pages.length - 1) {\n            pagesRef.current[curPage + 1]?.scrollIntoView();\n            setCurPage((page) => page + 1);\n        } else if (settings.loadNextonEnding) {\n            nextChapter();\n        }\n    }\n\n    function prevPage() {\n        if (curPage > 0) {\n            const rect = pagesRef.current[curPage].getBoundingClientRect();\n            if (rect.y < 0 && rect.y + rect.height > 0) {\n                pagesRef.current[curPage]?.scrollIntoView();\n            } else {\n                pagesRef.current[curPage - 1]?.scrollIntoView();\n                setCurPage(curPage - 1);\n            }\n        } else if (curPage === 0) {\n            prevChapter();\n        }\n    }\n\n    function keyboardControl(e:KeyboardEvent) {\n        switch (e.code) {\n            case 'Space':\n                e.preventDefault();\n                nextPage();\n                break;\n            case 'ArrowRight':\n                nextPage();\n                break;\n            case 'ArrowLeft':\n                prevPage();\n                break;\n            default:\n                break;\n        }\n    }\n\n    function clickControl(e:MouseEvent) {\n        if (e.clientX > window.innerWidth / 2) {\n            nextPage();\n        } else {\n            prevPage();\n        }\n    }\n\n    const handleLoadNextonEnding = () => {\n        if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {\n            nextChapter();\n        }\n    };\n\n    useEffect(() => {\n        if (settings.loadNextonEnding) { document.addEventListener('scroll', handleLoadNextonEnding); }\n        document.addEventListener('keydown', keyboardControl, false);\n        selfRef.current?.addEventListener('click', clickControl);\n\n        return () => {\n            document.removeEventListener('scroll', handleLoadNextonEnding);\n            document.removeEventListener('keydown', keyboardControl);\n            selfRef.current?.removeEventListener('click', clickControl);\n        };\n    }, [selfRef, curPage]);\n\n    useEffect(() => {\n        // scroll last read page into view\n        let initialPage = (chapter as IChapter).lastPageRead;\n        if (initialPage > pages.length - 1) {\n            initialPage = pages.length - 1;\n        }\n        if (initialPage > -1) {\n            pagesRef.current[initialPage].scrollIntoView();\n        }\n    }, [pagesRef.current.length]);\n\n    return (\n        <div ref={selfRef} className={classes.reader}>\n            {\n                pages.map((page) => (\n                    <Page\n                        key={page.index}\n                        index={page.index}\n                        src={page.src}\n                        onImageLoad={() => {}}\n                        setCurPage={setCurPage}\n                        settings={settings}\n                        ref={(e:HTMLDivElement) => { pagesRef.current[page.index] = e; }}\n                    />\n                ))\n            }\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport KeyboardArrowLeftIcon from '@material-ui/icons/KeyboardArrowLeft';\nimport KeyboardArrowRightIcon from '@material-ui/icons/KeyboardArrowRight';\nimport KeyboardArrowDownIcon from '@material-ui/icons/KeyboardArrowDown';\nimport KeyboardArrowUpIcon from '@material-ui/icons/KeyboardArrowUp';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useContext, useEffect, useState } from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { useHistory, Link } from 'react-router-dom';\nimport Slide from '@material-ui/core/Slide';\nimport Fade from '@material-ui/core/Fade';\nimport Zoom from '@material-ui/core/Zoom';\nimport { Switch } from '@material-ui/core';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Select from '@material-ui/core/Select';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Collapse from '@material-ui/core/Collapse';\nimport Button from '@material-ui/core/Button';\nimport NavBarContext from '../../context/NavbarContext';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    // main container and root div need to change classes...\n    AppMainContainer: {\n        display: 'none',\n    },\n    AppRootElment: {\n        display: 'flex',\n    },\n\n    root: {\n        position: settings.staticNav ? 'sticky' : 'fixed',\n        top: 0,\n        left: 0,\n        width: '300px',\n        height: '100vh',\n        overflowY: 'auto',\n        backgroundColor: '#0a0b0b',\n\n        '& header': {\n            backgroundColor: '#363b3d',\n            display: 'flex',\n            alignItems: 'center',\n            minHeight: '64px',\n            paddingLeft: '24px',\n            paddingRight: '24px',\n\n            transition: 'left 2s ease',\n\n            '& button': {\n                flexGrow: 0,\n                flexShrink: 0,\n            },\n\n            '& button:nth-child(1)': {\n                marginRight: '16px',\n            },\n\n            '& button:nth-child(3)': {\n                marginRight: '-12px',\n            },\n\n            '& h1': {\n                fontSize: '1.25rem',\n                flexGrow: 1,\n            },\n        },\n        '& hr': {\n            margin: '0 16px',\n            height: '1px',\n            border: '0',\n            backgroundColor: 'rgb(38, 41, 43)',\n        },\n    },\n\n    navigation: {\n        margin: '0 16px',\n\n        '& > span:nth-child(1)': {\n            textAlign: 'center',\n            display: 'block',\n            marginTop: '16px',\n        },\n\n        '& $navigationChapters': {\n            display: 'grid',\n            gridTemplateColumns: '1fr 1fr',\n            gridTemplateAreas: '\"prev next\"',\n            gridColumnGap: '5px',\n            margin: '10px 0',\n\n            '& a': {\n                flexGrow: 1,\n                textDecoration: 'none',\n\n                '& button': {\n                    width: '100%',\n                    padding: '5px 8px',\n                    textTransform: 'none',\n                },\n            },\n        },\n\n    },\n    navigationChapters: {}, // dummy rule\n\n    settingsCollapsseHeader: {\n        '& span': {\n            fontWeight: 'bold',\n        },\n    },\n\n    openDrawerButton: {\n        position: 'fixed',\n        top: 0 + 20,\n        left: 10 + 20,\n        height: '40px',\n        width: '40px',\n        borderRadius: 5,\n        backgroundColor: 'black',\n\n        '&:hover': {\n            backgroundColor: 'black',\n        },\n    },\n});\n\nexport const defaultReaderSettings = () => ({\n    staticNav: false,\n    showPageNumber: true,\n    continuesPageGap: false,\n    loadNextonEnding: false,\n    readerType: 'ContinuesVertical',\n} as IReaderSettings);\n\ninterface IProps {\n    settings: IReaderSettings\n    setSettings: React.Dispatch<React.SetStateAction<IReaderSettings>>\n    manga: IManga | IMangaCard\n    chapter: IChapter | IPartialChpter\n    curPage: number\n}\n\nexport default function ReaderNavBar(props: IProps) {\n    const { title } = useContext(NavBarContext);\n\n    const history = useHistory();\n\n    const {\n        settings, setSettings, manga, chapter, curPage,\n    } = props;\n\n    const [drawerOpen, setDrawerOpen] = useState(false || settings.staticNav);\n    const [hideOpenButton, setHideOpenButton] = useState(false);\n    const [prevScrollPos, setPrevScrollPos] = useState(0);\n    const [settingsCollapseOpen, setSettingsCollapseOpen] = useState(true);\n\n    const classes = useStyles(settings)();\n\n    const setSettingValue = (key: string, value: any) => setSettings({ ...settings, [key]: value });\n\n    const handleScroll = () => {\n        const currentScrollPos = window.pageYOffset;\n\n        if (Math.abs(currentScrollPos - prevScrollPos) > 20) {\n            setHideOpenButton(currentScrollPos > prevScrollPos);\n            setPrevScrollPos(currentScrollPos);\n        }\n    };\n\n    useEffect(() => {\n        window.addEventListener('scroll', handleScroll);\n\n        const rootEl = document.querySelector('#root')!;\n        const mainContainer = document.querySelector('#appMainContainer')!;\n\n        rootEl.classList.add(classes.AppRootElment);\n        mainContainer.classList.add(classes.AppMainContainer);\n\n        return () => {\n            rootEl.classList.remove(classes.AppRootElment);\n            mainContainer.classList.remove(classes.AppMainContainer);\n            window.removeEventListener('scroll', handleScroll);\n        };\n    }, [handleScroll]);// handleScroll changes on every render\n\n    return (\n        <>\n            <Slide\n                direction=\"right\"\n                in={drawerOpen}\n                timeout={200}\n                appear={false}\n                mountOnEnter\n                unmountOnExit\n            >\n                <div className={classes.root}>\n                    <header>\n                        <IconButton\n                            edge=\"start\"\n                            color=\"inherit\"\n                            aria-label=\"menu\"\n                            disableRipple\n                            onClick={() => history.push(`/manga/${manga.id}`)}\n                        >\n                            <CloseIcon />\n                        </IconButton>\n                        <Typography variant=\"h1\">\n                            {title}\n                        </Typography>\n                        {!settings.staticNav\n                        && (\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                onClick={() => setDrawerOpen(false)}\n                            >\n                                <KeyboardArrowLeftIcon />\n                            </IconButton>\n                        ) }\n                    </header>\n                    <ListItem ContainerComponent=\"div\" className={classes.settingsCollapsseHeader}>\n                        <ListItemText primary=\"Reader Settings\" />\n                        <ListItemSecondaryAction>\n                            <IconButton\n                                edge=\"start\"\n                                color=\"inherit\"\n                                aria-label=\"menu\"\n                                disableRipple\n                                disableFocusRipple\n                                onClick={() => setSettingsCollapseOpen(!settingsCollapseOpen)}\n                            >\n                                {settingsCollapseOpen && <KeyboardArrowUpIcon />}\n                                {!settingsCollapseOpen && <KeyboardArrowDownIcon />}\n                            </IconButton>\n                        </ListItemSecondaryAction>\n                    </ListItem>\n                    <Collapse in={settingsCollapseOpen} timeout=\"auto\" unmountOnExit>\n                        <List>\n                            <ListItem>\n                                <ListItemText primary=\"Static Navigation\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.staticNav}\n                                        onChange={(e) => setSettingValue('staticNav', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Show page number\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.showPageNumber}\n                                        onChange={(e) => setSettingValue('showPageNumber', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Load next chapter at ending\" />\n                                <ListItemSecondaryAction>\n                                    <Switch\n                                        edge=\"end\"\n                                        checked={settings.loadNextonEnding}\n                                        onChange={(e) => setSettingValue('loadNextonEnding', e.target.checked)}\n                                    />\n                                </ListItemSecondaryAction>\n                            </ListItem>\n                            <ListItem>\n                                <ListItemText primary=\"Reader Type\" />\n                                <Select\n                                    value={settings.readerType}\n                                    onChange={(e) => setSettingValue('readerType', e.target.value)}\n                                >\n                                    <MenuItem value=\"SingleLTR\">\n                                        Single Page (LTR)\n\n                                    </MenuItem>\n                                    <MenuItem value=\"SingleRTL\">\n                                        Single Page (RTL)\n\n                                    </MenuItem>\n                                    {/* <MenuItem value=\"SingleVertical\">\n                                        Vertical(WIP)\n\n                                    </MenuItem> */}\n                                    <MenuItem value=\"DoubleLTR\">\n                                        Double Page (LTR)\n\n                                    </MenuItem>\n                                    <MenuItem value=\"DoubleRTL\">\n                                        Double Page (RTL)\n\n                                    </MenuItem>\n                                    <MenuItem value=\"Webtoon\">\n                                        Webtoon\n\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesVertical\">\n                                        Continues Vertical\n\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalLTR\">\n                                        Horizontal (LTR)\n\n                                    </MenuItem>\n                                    <MenuItem value=\"ContinuesHorizontalRTL\">\n                                        Horizontal (RTL)\n\n                                    </MenuItem>\n                                </Select>\n                            </ListItem>\n                        </List>\n                    </Collapse>\n                    <hr />\n                    <div className={classes.navigation}>\n                        <span>\n                            Currently on page\n                            {' '}\n                            {curPage + 1}\n                            {' '}\n                            of\n                            {' '}\n                            {chapter.pageCount}\n                        </span>\n                        <div className={classes.navigationChapters}>\n                            {chapter.index > 1\n                            && (\n                                <Link\n                                    style={{ gridArea: 'prev' }}\n                                    to={`/manga/${manga.id}/chapter/${chapter.index - 1}`}\n                                >\n                                    <Button\n                                        variant=\"outlined\"\n                                        startIcon={<KeyboardArrowLeftIcon />}\n                                    >\n                                        Chapter\n                                        {' '}\n                                        {chapter.index - 1}\n                                    </Button>\n                                </Link>\n                            )}\n                            {chapter.index < chapter.chapterCount\n                            && (\n                                <Link\n                                    style={{ gridArea: 'next' }}\n                                    to={`/manga/${manga.id}/chapter/${chapter.index + 1}`}\n                                >\n                                    <Button\n                                        variant=\"outlined\"\n                                        endIcon={<KeyboardArrowRightIcon />}\n                                    >\n                                        Chapter\n                                        {' '}\n                                        {chapter.index + 1}\n                                    </Button>\n                                </Link>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </Slide>\n            <Zoom in={!drawerOpen}>\n                <Fade in={!hideOpenButton}>\n                    <IconButton\n                        className={classes.openDrawerButton}\n                        edge=\"start\"\n                        color=\"inherit\"\n                        aria-label=\"menu\"\n                        disableRipple\n                        disableFocusRipple\n                        onClick={() => setDrawerOpen(true)}\n                    >\n                        <KeyboardArrowRightIcon />\n                    </IconButton>\n                </Fade>\n            </Zoom>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useHistory, useParams } from 'react-router-dom';\nimport HorizontalPager from 'components/manga/reader/pager/HorizontalPager';\nimport PageNumber from 'components/manga/reader/PageNumber';\nimport PagedPager from 'components/manga/reader/pager/PagedPager';\nimport DoublePagedPager from 'components/manga/reader/pager/DoublePagedPager';\nimport VerticalPager from 'components/manga/reader/pager/VerticalPager';\nimport ReaderNavBar, { defaultReaderSettings } from 'components/navbar/ReaderNavBar';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport cloneObject from 'util/cloneObject';\n\nconst useStyles = (settings: IReaderSettings) => makeStyles({\n    root: {\n        width: settings.staticNav ? 'calc(100vw - 300px)' : '100vw',\n    },\n\n    loading: {\n        margin: '50px auto',\n    },\n});\n\nconst getReaderComponent = (readerType: ReaderType) => {\n    switch (readerType) {\n        case 'ContinuesVertical':\n        case 'Webtoon':\n            return VerticalPager;\n            break;\n        case 'SingleVertical':\n        case 'SingleRTL':\n        case 'SingleLTR':\n            return PagedPager;\n            break;\n        case 'DoubleVertical':\n        case 'DoubleRTL':\n        case 'DoubleLTR':\n            return DoublePagedPager;\n            break;\n        case 'ContinuesHorizontalLTR':\n        case 'ContinuesHorizontalRTL':\n            return HorizontalPager;\n        default:\n            return VerticalPager;\n            break;\n    }\n};\n\nconst range = (n:number) => Array.from({ length: n }, (value, key) => key);\nconst initialChapter = () => ({ pageCount: -1, index: -1, chapterCount: 0 });\n\nexport default function Reader() {\n    const [settings, setSettings] = useLocalStorage<IReaderSettings>('readerSettings', defaultReaderSettings);\n\n    const classes = useStyles(settings)();\n    const history = useHistory();\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const { chapterIndex, mangaId } = useParams<{ chapterIndex: string, mangaId: string }>();\n    const [manga, setManga] = useState<IMangaCard | IManga>({ id: +mangaId, title: '', thumbnailUrl: '' });\n    const [chapter, setChapter] = useState<IChapter | IPartialChpter>(initialChapter());\n    const [curPage, setCurPage] = useState<number>(0);\n    const { setOverride, setTitle } = useContext(NavbarContext);\n\n    useEffect(() => {\n        // make sure settings has all the keys\n        const settingsClone = cloneObject(settings) as any;\n        const defualtSettings = defaultReaderSettings();\n        let shouldUpdateSettings = false;\n        Object.keys(defualtSettings).forEach((key) => {\n            const keyOf = key as keyof IReaderSettings;\n            if (settings[keyOf] === undefined) {\n                settingsClone[keyOf] = defualtSettings[keyOf];\n                shouldUpdateSettings = true;\n            }\n        });\n        if (shouldUpdateSettings) { setSettings(settingsClone); }\n\n        // set the custom navbar\n        setOverride(\n            {\n                status: true,\n                value: (\n                    <ReaderNavBar\n                        settings={settings}\n                        setSettings={setSettings}\n                        manga={manga}\n                        chapter={chapter}\n                        curPage={curPage}\n                    />\n                ),\n            },\n        );\n\n        // clean up for when we leave the reader\n        return () => setOverride({ status: false, value: <div /> });\n    }, [manga, chapter, settings, curPage, chapterIndex]);\n\n    useEffect(() => {\n        setTitle('Reader');\n        client.get(`/api/v1/manga/${mangaId}/`)\n            .then((response) => response.data)\n            .then((data: IManga) => {\n                setManga(data);\n                setTitle(data.title);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        setChapter(initialChapter);\n        client.get(`/api/v1/manga/${mangaId}/chapter/${chapterIndex}`)\n            .then((response) => response.data)\n            .then((data:IChapter) => {\n                setChapter(data);\n                setCurPage(data.lastPageRead);\n            });\n    }, [chapterIndex]);\n\n    useEffect(() => {\n        if (curPage !== -1) {\n            const formData = new FormData();\n            formData.append('lastPageRead', curPage.toString());\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n        }\n\n        if (curPage === chapter.pageCount - 1) {\n            const formDataRead = new FormData();\n            formDataRead.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formDataRead);\n        }\n    }, [curPage]);\n\n    // return spinner while chpater data is loading\n    if (chapter.pageCount === -1) {\n        return (\n            <div className={classes.loading}>\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    const nextChapter = () => {\n        if (chapter.index < chapter.chapterCount) {\n            const formData = new FormData();\n            formData.append('lastPageRead', `${chapter.pageCount - 1}`);\n            formData.append('read', 'true');\n            client.patch(`/api/v1/manga/${manga.id}/chapter/${chapter.index}`, formData);\n\n            history.push(`/manga/${manga.id}/chapter/${chapter.index + 1}`);\n        }\n    };\n\n    const prevChapter = () => {\n        if (chapter.index > 1) {\n            history.push(`/manga/${manga.id}/chapter/${chapter.index - 1}`);\n        }\n    };\n\n    const pages = range(chapter.pageCount).map((index) => ({\n        index,\n        src: `${serverAddress}/api/v1/manga/${mangaId}/chapter/${chapterIndex}/page/${index}`,\n    }));\n\n    const ReaderComponent = getReaderComponent(settings.readerType);\n\n    return (\n        <div className={classes.root}>\n            <PageNumber\n                settings={settings}\n                curPage={curPage}\n                pageCount={chapter.pageCount}\n            />\n            <ReaderComponent\n                pages={pages}\n                pageCount={chapter.pageCount}\n                setCurPage={setCurPage}\n                curPage={curPage}\n                settings={settings}\n                manga={manga}\n                chapter={chapter}\n                nextChapter={nextChapter}\n                prevChapter={prevChapter}\n            />\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { useContext, useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\n\nconst useStyles = makeStyles({\n    root: {\n        width: 'calc(100vw - 10px)',\n        height: 'calc(100vh - 64px)',\n    },\n\n    loading: {\n        margin: '50px auto',\n    },\n\n    video: {\n        maxWidth: '100%',\n        maxHeight: '100%',\n    },\n});\n\nconst initialEpisode = () => ({ linkUrl: '', index: -1, episodeCount: 0 });\n\nexport default function Player() {\n    const classes = useStyles();\n\n    const { episodeIndex, animeId } = useParams<{ episodeIndex: string, animeId: string }>();\n    const [episode, setEpisode] = useState<IEpisode | IPartialEpisode>(initialEpisode());\n    const [episodeLink, setEpisodeLink] = useState<string>();\n    const { setTitle } = useContext(NavbarContext);\n\n    useEffect(() => {\n        setTitle('Reader');\n        client.get(`/api/v1/anime/anime/${animeId}/`)\n            .then((response) => response.data)\n            .then((data: IManga) => {\n                setTitle(data.title);\n            });\n    }, [episodeIndex]);\n\n    useEffect(() => {\n        setEpisode(initialEpisode);\n        client.get(`/api/v1/anime/anime/${animeId}/episode/${episodeIndex}`)\n            .then((response) => response.data)\n            .then((data:IEpisode) => {\n                setEpisode(data);\n                setEpisodeLink(data.linkUrl);\n            });\n    }, [episodeIndex]);\n\n    // return spinner while chpater data is loading\n    if (episode.linkUrl === '') {\n        return (\n            <div className={classes.loading}>\n                <CircularProgress thickness={5} />\n            </div>\n        );\n    }\n\n    return (\n        <div className={classes.root}>\n            {/* eslint-disable-next-line jsx-a11y/media-has-caption */}\n            <video className={classes.video} controls>\n                <source src={episodeLink} />\n            </video>\n        </div>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        display: 'flex',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        padding: 16,\n    },\n    bullet: {\n        display: 'inline-block',\n        margin: '0 2px',\n        transform: 'scale(0.8)',\n    },\n    title: {\n        fontSize: 14,\n    },\n    pos: {\n        marginBottom: 12,\n    },\n    icon: {\n        width: theme.spacing(7),\n        height: theme.spacing(7),\n        flex: '0 0 auto',\n        marginRight: 16,\n    },\n}));\n\ninterface IProps {\n    extension: IExtension\n    notifyInstall: () => void\n}\n\nexport default function ExtensionCard(props: IProps) {\n    const {\n        extension: {\n            name, lang, versionName, installed, hasUpdate, obsolete, pkgName, iconUrl,\n        },\n        notifyInstall,\n    } = props;\n    const [installedState, setInstalledState] = useState<string>(\n        () => {\n            if (obsolete) { return 'obsolete'; }\n            if (hasUpdate) { return 'update'; }\n            return (installed ? 'uninstall' : 'install');\n        },\n    );\n\n    const [serverAddress] = useLocalStorage<String>('serverBaseURL', '');\n\n    const classes = useStyles();\n    const langPress = lang === 'all' ? 'All' : lang.toUpperCase();\n\n    function install() {\n        setInstalledState('installing');\n        client.get(`/api/v1/anime/extension/install/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function update() {\n        setInstalledState('updating');\n        client.get(`/api/v1/anime/extension/update/${pkgName}`)\n            .then(() => {\n                setInstalledState('uninstall');\n                notifyInstall();\n            });\n    }\n\n    function uninstall() {\n        setInstalledState('uninstalling');\n        client.get(`/api/v1/anime/extension/uninstall/${pkgName}`)\n            .then(() => {\n                // setInstalledState('install');\n                notifyInstall();\n            });\n    }\n\n    function handleButtonClick() {\n        switch (installedState) {\n            case 'install':\n                install();\n                break;\n            case 'update':\n                update();\n                break;\n            case 'obsolete':\n                uninstall();\n                setTimeout(() => window.location.reload(), 3000);\n                break;\n            case 'uninstall':\n                uninstall();\n                break;\n            default:\n                break;\n        }\n    }\n\n    return (\n        <Card>\n            <CardContent className={classes.root}>\n                <div style={{ display: 'flex' }}>\n                    <Avatar\n                        variant=\"rounded\"\n                        className={classes.icon}\n                        alt={name}\n                        src={serverAddress + iconUrl}\n                    />\n                    <div style={{ display: 'flex', flexDirection: 'column' }}>\n                        <Typography variant=\"h5\" component=\"h2\">\n                            {name}\n                        </Typography>\n                        <Typography variant=\"caption\" display=\"block\" gutterBottom>\n                            {langPress}\n                            {' '}\n                            {versionName}\n                        </Typography>\n                    </div>\n                </div>\n\n                <Button\n                    variant=\"outlined\"\n                    style={{ color: installedState === 'obsolete' ? 'red' : 'inherit' }}\n                    onClick={() => handleButtonClick()}\n                >\n                    {installedState}\n\n                </Button>\n            </CardContent>\n        </Card>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport ExtensionCard from 'components/anime/ExtensionCard';\nimport NavbarContext from 'context/NavbarContext';\nimport client from 'util/client';\nimport useLocalStorage from 'util/useLocalStorage';\nimport ExtensionLangSelect from 'components/manga/ExtensionLangSelect';\nimport { defualtLangs, langCodeToName, langSortCmp } from 'util/language';\n\nconst allLangs: string[] = [];\n\nfunction groupExtensions(extensions: IExtension[]) {\n    allLangs.length = 0; // empty the array\n    const result = { installed: [], 'updates pending': [] } as any;\n    extensions.sort((a, b) => ((a.apkName > b.apkName) ? 1 : -1));\n\n    extensions.forEach((extension) => {\n        if (result[extension.lang] === undefined) {\n            result[extension.lang] = [];\n            if (extension.lang !== 'all') { allLangs.push(extension.lang); }\n        }\n        if (extension.installed) {\n            if (extension.hasUpdate) {\n                result['updates pending'].push(extension);\n            } else {\n                result.installed.push(extension);\n            }\n        } else {\n            result[extension.lang].push(extension);\n        }\n    });\n\n    // put english first for convience\n    allLangs.sort(langSortCmp);\n\n    return result;\n}\n\nfunction extensionDefaultLangs() {\n    return [...defualtLangs(), 'all'];\n}\n\nexport default function AnimeExtensions() {\n    const { setTitle, setAction } = useContext(NavbarContext);\n    const [shownLangs, setShownLangs] = useLocalStorage<string[]>('shownExtensionLangs', extensionDefaultLangs());\n\n    useEffect(() => {\n        setTitle('Extensions');\n        setAction(\n            <ExtensionLangSelect\n                shownLangs={shownLangs}\n                setShownLangs={setShownLangs}\n                allLangs={allLangs}\n            />,\n        );\n    }, [shownLangs]);\n\n    const [extensionsRaw, setExtensionsRaw] = useState<IExtension[]>([]);\n    const [extensions, setExtensions] = useState<any>({});\n\n    const [updateTriggerHolder, setUpdateTriggerHolder] = useState(0); // just a hack\n    const triggerUpdate = () => setUpdateTriggerHolder(updateTriggerHolder + 1); // just a hack\n\n    useEffect(() => {\n        client.get('/api/v1/anime/extension/list')\n            .then((response) => response.data)\n            .then((data) => setExtensionsRaw(data));\n    }, [updateTriggerHolder]);\n\n    useEffect(() => {\n        if (extensionsRaw.length > 0) {\n            const groupedExtension = groupExtensions(extensionsRaw);\n            setExtensions(groupedExtension);\n        }\n    }, [extensionsRaw]);\n\n    if (Object.entries(extensions).length === 0) {\n        return <h3>loading...</h3>;\n    }\n    const groupsToShow = ['updates pending', 'installed', ...shownLangs];\n    return (\n        <>\n            {\n                Object.entries(extensions).map(([lang, list]) => (\n                    ((groupsToShow.indexOf(lang) !== -1 && (list as []).length > 0)\n                        && (\n                            <React.Fragment key={lang}>\n                                <h1 key={lang} style={{ marginLeft: 25 }}>\n                                    {langCodeToName(lang)}\n                                </h1>\n                                {(list as IExtension[]).map((it) => (\n                                    <ExtensionCard\n                                        key={it.apkName}\n                                        extension={it}\n                                        notifyInstall={() => {\n                                            triggerUpdate();\n                                        }}\n                                    />\n                                ))}\n                            </React.Fragment>\n                        ))\n                ))\n            }\n        </>\n    );\n}\n","/* eslint-disable @typescript-eslint/no-shadow */\n/* eslint-disable react/destructuring-assignment */\n/* eslint-disable react/jsx-props-no-spreading */\n/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport NavbarContext from 'context/NavbarContext';\nimport React, { useContext, useEffect, useState } from 'react';\nimport PlayArrowIcon from '@material-ui/icons/PlayArrow';\nimport PauseIcon from '@material-ui/icons/Pause';\nimport IconButton from '@material-ui/core/IconButton';\nimport client from 'util/client';\nimport {\n    DragDropContext, Draggable, DraggingStyle, Droppable, DropResult, NotDraggingStyle,\n} from 'react-beautiful-dnd';\nimport { useTheme } from '@material-ui/core/styles';\nimport { Palette } from '@material-ui/core/styles/createPalette';\nimport List from '@material-ui/core/List';\nimport DragHandleIcon from '@material-ui/icons/DragHandle';\nimport ListItem from '@material-ui/core/ListItem';\nimport { ListItemIcon } from '@material-ui/core';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nconst baseWebsocketUrl = JSON.parse(window.localStorage.getItem('serverBaseURL')!).replace('http', 'ws');\n\nconst getItemStyle = (isDragging: boolean,\n    draggableStyle: DraggingStyle | NotDraggingStyle | undefined, palette: Palette) => ({\n    // styles we need to apply on draggables\n    ...draggableStyle,\n\n    ...(isDragging && {\n        background: palette.type === 'dark' ? '#424242' : 'rgb(235,235,235)',\n    }),\n});\n\nconst initialQueue = {\n    status: 'Stopped',\n    queue: [],\n} as IQueue;\n\nexport default function DownloadQueue() {\n    const [, setWsClient] = useState<WebSocket>();\n    const [queueState, setQueueState] = useState<IQueue>(initialQueue);\n    const { queue, status } = queueState;\n\n    const theme = useTheme();\n\n    const { setTitle, setAction } = useContext(NavbarContext);\n\n    const toggleQueueStatus = () => {\n        if (status === 'Stopped') {\n            client.get('/api/v1/downloads/start');\n        } else {\n            client.get('/api/v1/downloads/stop');\n        }\n    };\n\n    useEffect(() => {\n        setTitle('Download Queue');\n\n        setAction(() => {\n            if (status === 'Stopped') {\n                return (\n                    <IconButton onClick={toggleQueueStatus}>\n                        <PlayArrowIcon />\n                    </IconButton>\n                );\n            }\n            return (\n                <IconButton onClick={toggleQueueStatus}>\n                    <PauseIcon />\n                </IconButton>\n            );\n        });\n    }, [status]);\n\n    useEffect(() => {\n        const wsc = new WebSocket(`${baseWebsocketUrl}/api/v1/downloads`);\n        wsc.onmessage = (e) => {\n            setQueueState(JSON.parse(e.data));\n        };\n\n        setWsClient(wsc);\n    }, []);\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const onDragEnd = (result: DropResult) => {\n    };\n\n    return (\n        <>\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <List ref={provided.innerRef}>\n                            {queue.map((item, index) => (\n                                <Draggable\n                                    key={`${item.mangaId}-${item.chapterIndex}`}\n                                    draggableId={`${item.mangaId}-${item.chapterIndex}`}\n                                    index={index}\n                                >\n                                    {(provided, snapshot) => (\n                                        <ListItem\n                                            ContainerProps={{ ref: provided.innerRef } as any}\n                                            {...provided.draggableProps}\n                                            {...provided.dragHandleProps}\n                                            style={getItemStyle(\n                                                snapshot.isDragging,\n                                                provided.draggableProps.style,\n                                                theme.palette,\n                                            )}\n                                            ref={provided.innerRef}\n                                        >\n                                            <ListItemIcon>\n                                                <DragHandleIcon />\n                                            </ListItemIcon>\n                                            <ListItemText\n                                                primary={\n                                                    `${item.chapter.name} | `\n                                                    + ` (${item.progress * 100}%)`\n                                                    + ` => state: ${item.state}`\n                                                }\n                                            />\n                                            {/* <IconButton\n                                                onClick={() => {\n                                                    handleEditDialogOpen(index);\n                                                }}\n                                            >\n                                                <EditIcon />\n                                            </IconButton>\n                                            <IconButton\n                                                onClick={() => {\n                                                    deleteCategory(index);\n                                                }}\n                                            >\n                                                <DeleteIcon />\n                                            </IconButton> */}\n                                        </ListItem>\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </List>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        </>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React, { useState } from 'react';\nimport {\n    BrowserRouter as Router, Switch,\n    Route,\n    Redirect,\n} from 'react-router-dom';\nimport { Container } from '@material-ui/core';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport NavBar from 'components/navbar/NavBar';\nimport NavbarContext from 'context/NavbarContext';\nimport DarkTheme from 'context/DarkTheme';\nimport useLocalStorage from 'util/useLocalStorage';\nimport MangaSources from 'screens/manga/MangaSources';\nimport AnimeSources from 'screens/anime/AnimeSources';\nimport Settings from 'screens/Settings';\nimport About from 'screens/settings/About';\nimport Categories from 'screens/settings/Categories';\nimport Backup from 'screens/settings/Backup';\nimport Library from 'screens/manga/Library';\nimport SearchSingle from 'screens/manga/SearchSingle';\nimport Manga from 'screens/manga/Manga';\nimport Anime from 'screens/anime/Anime';\nimport MangaExtensions from 'screens/manga/MangaExtensions';\nimport SourceMangas from 'screens/manga/SourceMangas';\nimport SourceAnimes from 'screens/anime/SourceAnimes';\nimport Reader from 'screens/manga/Reader';\nimport Player from 'screens/anime/Player';\nimport AnimeExtensions from 'screens/anime/AnimeExtensions';\nimport DownloadQueue from 'screens/manga/DownloadQueue';\n\nexport default function App() {\n    const [title, setTitle] = useState<string>('Tachidesk');\n    const [action, setAction] = useState<any>(<div />);\n    const [override, setOverride] = useState<INavbarOverride>({ status: false, value: <div /> });\n\n    const [darkTheme, setDarkTheme] = useLocalStorage<boolean>('darkTheme', true);\n\n    const navBarContext = {\n        title, setTitle, action, setAction, override, setOverride,\n    };\n    const darkThemeContext = { darkTheme, setDarkTheme };\n\n    const theme = React.useMemo(\n        () => createMuiTheme({\n            palette: {\n                type: darkTheme ? 'dark' : 'light',\n            },\n            overrides: {\n                MuiCssBaseline: {\n                    '@global': {\n                        '*::-webkit-scrollbar': {\n                            width: '10px',\n                            background: darkTheme ? '#222' : '#e1e1e1',\n\n                        },\n                        '*::-webkit-scrollbar-thumb': {\n                            background: darkTheme ? '#111' : '#aaa',\n                            borderRadius: '5px',\n                        },\n                    },\n                },\n            },\n        }),\n        [darkTheme],\n    );\n\n    return (\n        <Router>\n            <ThemeProvider theme={theme}>\n                <NavbarContext.Provider value={navBarContext}>\n                    <CssBaseline />\n                    <NavBar />\n                    <Container\n                        id=\"appMainContainer\"\n                        maxWidth={false}\n                        disableGutters\n                        style={{ paddingTop: '64px' }}\n                    >\n                        <Switch>\n                            {/* general routes */}\n                            <Route\n                                exact\n                                path=\"/\"\n                                render={() => (\n                                    <Redirect to=\"/library\" />\n                                )}\n                            />\n\n                            <Route path=\"/settings/about\">\n                                <About />\n                            </Route>\n                            <Route path=\"/settings/categories\">\n                                <Categories />\n                            </Route>\n                            <Route path=\"/settings/backup\">\n                                <Backup />\n                            </Route>\n                            <Route path=\"/settings\">\n                                <DarkTheme.Provider value={darkThemeContext}>\n                                    <Settings />\n                                </DarkTheme.Provider>\n                            </Route>\n\n                            {/* Manga Routes */}\n\n                            <Route path=\"/sources/:sourceId/search/\">\n                                <SearchSingle />\n                            </Route>\n                            <Route path=\"/manga/extensions\">\n                                <MangaExtensions />\n                            </Route>\n                            <Route path=\"/sources/:sourceId/popular/\">\n                                <SourceMangas popular />\n                            </Route>\n                            <Route path=\"/sources/:sourceId/latest/\">\n                                <SourceMangas popular={false} />\n                            </Route>\n                            <Route path=\"/manga/sources\">\n                                <MangaSources />\n                            </Route>\n                            <Route path=\"/manga/downloads\">\n                                <DownloadQueue />\n                            </Route>\n                            <Route path=\"/manga/:mangaId/chapter/:chapterNum\">\n                                <></>\n                            </Route>\n                            <Route path=\"/manga/:id\">\n                                <Manga />\n                            </Route>\n                            <Route path=\"/library\">\n                                <Library />\n                            </Route>\n\n                            {/* Anime Routes */}\n                            <Route path=\"/anime/extensions\">\n                                <AnimeExtensions />\n                            </Route>\n                            <Route path=\"/anime/sources/:sourceId/popular/\">\n                                <SourceAnimes popular />\n                            </Route>\n                            <Route path=\"/anime/sources/:sourceId/latest/\">\n                                <SourceMangas popular={false} />\n                            </Route>\n                            <Route path=\"/anime/sources\">\n                                <AnimeSources />\n                            </Route>\n                            <Route path=\"/anime/:animeId/episode/:episodeIndex\">\n                                <Player />\n                            </Route>\n                            <Route path=\"/anime/:id\">\n                                <Anime />\n                            </Route>\n                        </Switch>\n                    </Container>\n                    <Switch>\n                        <Route\n                            path=\"/manga/:mangaId/chapter/:chapterIndex\"\n                            // passing a key re-mounts the reader when changing chapters\n                            render={(props:any) => <Reader key={props.match.params.chapterIndex} />}\n                        />\n                    </Switch>\n                </NavbarContext.Provider>\n            </ThemeProvider>\n        </Router>\n    );\n}\n","/*\n * Copyright (C) Contributors to the Suwayomi project\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/. */\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css';\n// roboto font\nimport '@fontsource/roboto';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n"],"sourceRoot":""}